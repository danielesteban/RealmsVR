{"version":3,"sources":["webpack:///./src/actions/types.js","webpack:///./src/services/api.js","webpack:///./src/locales/index.js","webpack:///./src/locales/en.js","webpack:///./src/locales/es.js","webpack:///./src/reducers/lobby.js","webpack:///./src/reducers/realm.js","webpack:///./src/reducers/user.js","webpack:///./src/reducers/index.js","webpack:///./src/components/github.jsx","webpack:///./src/components/music.jsx","webpack:///./src/components/hands.js","webpack:///./src/components/renderer.jsx","webpack:///./src/components/session.jsx","webpack:///./src/actions/user.js","webpack:///./src/services/mesher.js","webpack:///./src/actions/realm.js","webpack:///./src/components/lobby/ground.js","webpack:///./src/components/panel.js","webpack:///./src/services/fonts.js","webpack:///./src/components/lobby/menu.js","webpack:///./src/components/lobby/starfield.js","webpack:///./src/components/lobby/title.js","webpack:///./src/scenes/lobby.js","webpack:///./src/actions/lobby.js","webpack:///./src/components/realm/picker.js","webpack:///./src/components/realm/voxels.js","webpack:///./src/scenes/realm.js","webpack:///./src/scenes/index.jsx","webpack:///./src/layout/index.jsx","webpack:///./src/index.jsx","webpack:///./src/services/mesher.worker.js"],"names":["LOBBY_FETCH_REALMS_FULFILLED","LOBBY_SET_FILTER","LOBBY_SET_PAGE","REALM_FETCH_FULFILLED","REALM_UPDATE_GEOMETRY","REALM_UPDATE_VOXELS","REALM_RESET","USER_HIDE_SESSION_POPUP","USER_REFRESH_SESSION_FULFILLED","USER_REFRESH_SESSION_REJECTED","USER_SHOW_SESSION_POPUP","USER_LOGIN_FULFILLED","USER_REGISTER_FULFILLED","USER_SIGNOUT","api","API","_classCallCheck","this","baseURL","__API__","body","_ref","endpoint","_ref$headers","headers","_ref$method","method","authorization","Authorization","FormData","JSON","stringify","fetch","concat","then","res","status","Error","get","split","arrayBuffer","json","token","locales","en","User","confirmPassword","email","name","signIn","signInWithGoogle","signOut","password","register","es","availableLocales","Object","keys","translations","forEach","locale","merge","lobbyReducer","combineReducers","filter","state","arguments","length","undefined","action","type","types","payload","value","hasLoaded","pagination","page","pages","_objectSpread","realms","realmReducer","geometry","id","_id","isCreator","size","voxels","Uint32Array","sessionKey","storedSession","parse","localStorage","getItem","setAuthorization","userReducer","isAuth","isSigningIn","profile","user_objectSpread","firstName","setItem","removeItem","rootReducer","i18n","loadingBar","lobby","realm","user","Link","styled","a","withConfig","displayName","componentId","GitHub","react_default","createElement","href","rel","target","xmlns","width","height","viewBox","fill","d","className","Wrapper","div","Music","props","_this","music_classCallCheck","_possibleConstructorReturn","_getPrototypeOf","call","tracks","music_toConsumableArray","index","random","Math","floor","temp","player","document","onended","next","bind","_assertThisInitialized","volume","track","PureComponent","waitForFirstInteraction","_this2","first","window","removeEventListener","play","addEventListener","paused","pause","src","_this3","clientId","stream_url","setState","catch","title","artwork","artwork_url","link","permalink_url","_track$user","username","userlink","waveform","waveform_url","alt","Hands","hands_classCallCheck","mesh","pointerMesh","setup","hands_possibleConstructorReturn","hands_getPrototypeOf","_loop","i","hand","clone","buttons","menu","menuDown","menuUp","grip","gripDown","gripUp","pad","padDown","padUp","trigger","triggerDown","triggerUp","pointer","visible","add","matrixAutoUpdate","setupRaycaster","raycaster","Object3D","children","gamepads","navigator","getGamepads","gamepad","startsWith","pose","updateHand","standingMatrix","position","fromArray","orientation","quaternion","matrix","compose","scale","premultiply","matrixWorldNeedsUpdate","pressed","_ref2","auxMatrix","Matrix4","matrixWorld","identity","extractRotation","ray","origin","setFromMatrixPosition","direction","set","applyMatrix4","addScaledVector","BoxGeometry","translate","faces","face","color","offsetHSL","BufferGeometry","fromGeometry","material","MeshBasicMaterial","Mesh","pointerGeometry","setFromPoints","Vector3","pointerMaterial","LineBasicMaterial","Line","Renderer","renderer_classCallCheck","renderer_possibleConstructorReturn","renderer_getPrototypeOf","canvas","React","createRef","onAnimationTick","renderer_assertThisInitialized","onResize","Component","current","camera","PerspectiveCamera","clock","Clock","Raycaster","room","hands","resetCamera","resetScene","renderer","WebGLRenderer","antialias","powerPreference","stencil","setPixelRatio","devicePixelRatio","setClearColor","scene","fog","setAnimationLoop","setupVR","stats","begin","animation","delta","getDelta","time","oldTime","update","render","end","_canvas$parentNode$ge","parentNode","getBoundingClientRect","vr","isPresenting","setSize","aspect","updateProjectionMatrix","capabilities","getMaxAnisotropy","hasWebXR","hasWebVR","enterVR","display","getDevice","requestSession","immersive","exclusive","session","setSession","frameOfReferenceType","xr","requestDevice","enabled","setDevice","requestPresent","source","domElement","getVRDisplays","displays","_slicedToArray","getStandingMatrix","rotation","child","dispose","Scene","FogExp2","setRGB","ref","ShaderChunk","fog_pars_vertex","replace","fog_vertex","fog_pars_fragment","fog_fragment","join","Popup","Heading","Content","Form","form","Session","session_classCallCheck","session_possibleConstructorReturn","session_getPrototypeOf","onLoginSubmit","session_assertThisInitialized","onRegisterSubmit","tab","e","preventDefault","login","_this$props","hide","loginWithGoogle","session_Wrapper","onClick","react_redux_i18n_build","ti","onSubmit","required","propTypes","PropTypes","bool","isRequired","func","connect","dispatch","left","screen","w","top","h","win","open","watcher","setInterval","postMessage","clearInterval","onMessage","_ref3","data","indexOf","mesher","Mesher","mesher_classCallCheck","promiseId","promises","worker","Worker","onmessage","Promise","resolve","_ref2$data","generateGeometry","generate","Ground","ground_classCallCheck","ground_possibleConstructorReturn","ground_getPrototypeOf","PlaneGeometry","rotateX","PI","Color","copy","setHex","vertexColors","VertexColors","Panel","anisotropy","_ref$width","_ref$height","panel_classCallCheck","backplate","texture","CanvasTexture","panel_possibleConstructorReturn","panel_getPrototypeOf","map","context","getContext","ctx","fillStyle","fillRect","needsUpdate","point","worldToLocal","x","y","splice","side","DoubleSide","PlaneBufferGeometry","fonts","Fonts","fonts_classCallCheck","loaded","Array","isArray","all","font","check","setTimeout","Pillar","menu_classCallCheck","menu_possibleConstructorReturn","menu_getPrototypeOf","CylinderGeometry","Realm","creator","onPointer","screenshot","_this$renderer","vignette","createRadialGradient","addColorStop","hasLoadedFont","waitUntilLoaded","draw","image","Image","crossOrigin","onload","isHover","_get","prototype","drawImage","textAlign","textBaseline","fillText","ButtonsPanel","label","isActive","isDisabled","save","beginPath","rect","strokeStyle","stroke","restore","isDown","_ref4","_ref5","_ref6","CreateRealm","_ref7","history","createRealm","_this3$renderer","_ref8","slug","push","Pagination","_ref9","_this4","_this4$renderer","_ref10","_this5","signin","signout","updateSession","_this6","_ref11","userPhoto","Filter","_ref12","_this7","_this7$renderer","_ref13","button","Menu","_ref14","_this8","setFilter","setPage","hover","intersects","addPanel","menu_objectSpread","updateRealms","z","panel","lookAt","pillar","_ref15","_ref16","_this9","remove","showCreateRealm","offset","_ref17","setHover","_ref18","Starfield","starfield_classCallCheck","starfield_possibleConstructorReturn","starfield_getPrototypeOf","Points","Float32Array","count","aux","normalize","multiplyScalar","c","addAttribute","BufferAttribute","PointsMaterial","Title","title_classCallCheck","title_possibleConstructorReturn","title_getPrototypeOf","transparent","grd","createLinearGradient","shadowColor","shadowBlur","__VERSION__","Lobby","fetchRealms","onBeforeRender","touches","Touches","filtered","on","onPointerDown","previousFilter","wasSigningIn","previousPagination","previousRealms","previousUser","_this$props2","filterHasUpdated","updateFilter","updatePagination","disable","hit","intersectObjects","distance","object","lobby_slicedToArray","_this$renderer2","setFromCamera","min","max","defaultProps","string","shape","number","arrayOf","instanceOf","_ref4$lobby","_ref4$user","getState","_getState$lobby","Picker","picker_classCallCheck","picker_assertThisInitialized","picker_possibleConstructorReturn","picker_getPrototypeOf","block","strip","blockColor","picker_get","getHexString","grdWhite","grdBlack","imageData","getImageData","goBack","Voxels","_ref$instanced","instanced","voxels_classCallCheck","voxels_possibleConstructorReturn","voxels_getPrototypeOf","shader","InstancedBufferGeometry","ShaderMaterial","vertexShader","vertex","fragmentShader","fragment","uniforms","frustum","Frustum","instances","distanceTo","round","instance","chunk","updateMatrix","updateMatrixWorld","sort","_instance$chunk","frustumCulled","attributes","setArray","InstancedBufferAttribute","setDynamic","maxInstancedCount","_this$aux","multiplyMatrices","projectionMatrix","matrixWorldInverse","setFromMatrix","offsets","worldSphere","intersectsSphere","reduce","array","normal","setIndex","computeBoundingSphere","boundingSphere","ShaderLib","basic","UniformsUtils","match","params","picker","extensions","head","previousGeometry","previousSize","resize","realm_toConsumableArray","reset","_this$props3","updateVoxels","updateFrustum","_map2","scenes_realm_slicedToArray","axis","sin","rotateY","translateZ","_ref2$realm","realm_objectSpread","_getState$realm","realm_slicedToArray","randomized","r","g","b","append","Blob","buffer","Scenes","react_router","path","exact","key","_extends","to","store","storedLocale","browserLocale","loadingBarStyle","backgroundColor","zIndex","Layout","layout_classCallCheck","layout_possibleConstructorReturn","layout_getPrototypeOf","build_default","style","layout_Wrapper","components_renderer","scenes","music","github","components_session","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","productionCompose","createStore","applyMiddleware","thunkMiddleware","promiseMiddleware","loadingBarMiddleware","languages","language","browserLanguage","userLanguage","substr","toLowerCase","syncTranslationWithStore","loadTranslations","setLocale","createBrowserHistory","basename","__BASENAME__","location","hash","mount","getElementById","react_redux_es","layout","module","exports","__webpack_require__","p"],"mappings":"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","file":"code/main.f1605be4491599a3429f.js","sourcesContent":["// LOBBY\nexport const LOBBY_FETCH_REALMS = 'LOBBY/FETCH_REALMS';\nexport const LOBBY_FETCH_REALMS_FULFILLED = 'LOBBY/FETCH_REALMS_FULFILLED';\nexport const LOBBY_SET_FILTER = 'LOBBY/SET_FILTER';\nexport const LOBBY_SET_PAGE = 'LOBBY/SET_PAGE';\n\n// REALM\nexport const REALM_CREATE = 'REALM/CREATE';\nexport const REALM_CREATE_FULFILLED = 'REALM/CREATE_FULFILLED';\nexport const REALM_FETCH = 'REALM/FETCH';\nexport const REALM_FETCH_FULFILLED = 'REALM/FETCH_FULFILLED';\nexport const REALM_UPDATE_GEOMETRY = 'REALM/UPDATE_GEOMETRY';\nexport const REALM_UPDATE_GEOMETRY_FULFILLED = 'REALM/UPDATE_GEOMETRY_FULFILLED';\nexport const REALM_UPDATE_VOXELS = 'REALM/UPDATE_VOXELS';\nexport const REALM_RESET = 'REALM/RESET';\n\n// USER\nexport const USER_HIDE_SESSION_POPUP = 'USER/HIDE_SESSION_POPUP';\nexport const USER_REFRESH_SESSION = 'USER/REFRESH_SESSION';\nexport const USER_REFRESH_SESSION_FULFILLED = 'USER/REFRESH_SESSION_FULFILLED';\nexport const USER_REFRESH_SESSION_REJECTED = 'USER/REFRESH_SESSION_REJECTED';\nexport const USER_SHOW_SESSION_POPUP = 'USER/SHOW_SESSION_POPUP';\nexport const USER_LOGIN = 'USER/LOGIN';\nexport const USER_LOGIN_FULFILLED = 'USER/LOGIN_FULFILLED';\nexport const USER_LOGIN_REJECTED = 'USER/LOGIN_REJECTED';\nexport const USER_REGISTER = 'USER/REGISTER';\nexport const USER_REGISTER_FULFILLED = 'USER/REGISTER_FULFILLED';\nexport const USER_REGISTER_REJECTED = 'USER/REGISTER_REJECTED';\nexport const USER_SIGNOUT = 'USER/SIGNOUT';\n","class API {\n  constructor() {\n    this.baseURL = __API__;\n  }\n\n  fetch({\n    body,\n    endpoint,\n    headers = {},\n    method = 'GET',\n  }) {\n    const {\n      authorization,\n      baseURL,\n    } = this;\n    if (authorization) {\n      headers.Authorization = authorization;\n    }\n    if (body && !(body instanceof FormData)) {\n      body = JSON.stringify(body);\n      headers['Content-Type'] = 'application/json';\n    }\n    return fetch(\n      `${baseURL}${endpoint}`,\n      {\n        body,\n        headers,\n        method,\n      }\n    )\n      .then((res) => {\n        const { headers, status } = res;\n        if (status < 200 || status >= 400) {\n          throw new Error(status);\n        }\n        const type = (headers.get('Content-Type') || '').split(';')[0];\n        switch (type) {\n          case 'text/plain':\n            return res.arrayBuffer();\n          case 'application/json':\n            return res.json();\n          default:\n            return res;\n        }\n      });\n  }\n\n  setAuthorization(token) {\n    if (token) {\n      this.authorization = `Bearer ${token}`;\n    } else {\n      delete this.authorization;\n    }\n    this.token = token;\n  }\n}\n\nexport default new API();\n","import diff from 'deep-diff';\nimport { recursive as merge } from 'merge';\nimport { loadTranslations, setLocale, syncTranslationWithStore } from 'react-redux-i18n';\nimport en from './en';\nimport es from './es';\n\nconst locales = {\n  en,\n  es,\n};\nconst availableLocales = Object.keys(locales);\nconst defaultLocale = 'en';\n\n// Populate locales with default literals\nconst translations = {};\navailableLocales.forEach((locale) => {\n  translations[locale] = merge(true, locales[defaultLocale], locales[locale]);\n});\n\n// Translations loader handler (for hot-reloading)\nexport const load = (store) => {\n  store.dispatch(loadTranslations(translations));\n};\n\nexport default (store) => {\n  // Locale Autodetection\n  const storedLocale = localStorage.getItem('REALMSVR::LOCALE');\n  const browserLocale = (\n    (window.navigator.languages ? window.navigator.languages[0] : null)\n    || window.navigator.language\n    || window.navigator.browserLanguage\n    || window.navigator.userLanguage\n    || defaultLocale\n  ).substr(0, 2).toLowerCase();\n\n  let locale = defaultLocale;\n  if (~availableLocales.indexOf(storedLocale)) locale = storedLocale;\n  else if (~availableLocales.indexOf(browserLocale)) locale = browserLocale;\n\n  // Setup react-i18nify\n  syncTranslationWithStore(store);\n  load(store);\n  store.dispatch(setLocale(locale));\n\n  if (!__PRODUCTION__) {\n    // Warn about missing translations\n    const missing = availableLocales\n      .reduce((missing, locale) => {\n        if (locale === defaultLocale) {\n          return missing;\n        }\n        const keys = diff(locales[defaultLocale], locales[locale])\n          .reduce((missing, { kind, path }) => {\n            if (kind === 'E') {\n              return missing;\n            }\n            return [\n              ...missing,\n              path.join('.'),\n            ];\n          }, []);\n        if (!keys.length) {\n          return missing;\n        }\n        return [\n          ...missing,\n          `\\nMissing translations for \"${locale.toUpperCase()}\" locale:`,\n          ...keys,\n        ];\n      }, []);\n    if (missing.length) {\n      console.warn(missing.join('\\n'));\n    }\n  }\n};\n","export default {\n  User: {\n    confirmPassword: 'Confirm password',\n    email: 'Email',\n    name: 'Name',\n    signIn: 'Sign-In',\n    signInWithGoogle: 'Sign-In with Google',\n    signOut: 'Sign-Out',\n    password: 'Password',\n    register: 'Create an account',\n  },\n};\n","export default {\n  User: {\n    confirmPassword: 'Confirmar contrasea',\n    email: 'Email',\n    name: 'Nombre',\n    signIn: 'Iniciar sesin',\n    signInWithGoogle: 'Iniciar sesin con Google',\n    signOut: 'Cerrar sesin',\n    password: 'Contrasea',\n    register: 'Crear una cuenta',\n  },\n};\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\n\nconst filter = (\n  state = 'all',\n  action\n) => {\n  switch (action.type) {\n    case types.LOBBY_SET_FILTER:\n      return action.payload.value;\n    default:\n      return state;\n  }\n};\n\nconst hasLoaded = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.LOBBY_FETCH_REALMS_FULFILLED:\n      return true;\n    case types.REALM_CREATE_FULFILLED:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst pagination = (\n  state = {\n    page: 0,\n    pages: 0,\n  },\n  action\n) => {\n  switch (action.type) {\n    case types.LOBBY_FETCH_REALMS_FULFILLED:\n      return {\n        ...state,\n        pages: action.payload.pages,\n      };\n    case types.LOBBY_SET_FILTER:\n      return {\n        ...state,\n        page: 0,\n      };\n    case types.LOBBY_SET_PAGE:\n      return {\n        ...state,\n        page: action.payload.value,\n      };\n    default:\n      return state;\n  }\n};\n\nconst realms = (\n  state = [],\n  action\n) => {\n  switch (action.type) {\n    case types.LOBBY_FETCH_REALMS_FULFILLED:\n      return action.payload.realms;\n    default:\n      return state;\n  }\n};\n\nconst lobbyReducer = combineReducers({\n  filter,\n  hasLoaded,\n  pagination,\n  realms,\n});\n\nexport default lobbyReducer;\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\n\nconst geometry = (\n  state = {},\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_UPDATE_GEOMETRY_FULFILLED:\n      return action.payload;\n    case types.REALM_RESET:\n      return {};\n    default:\n      return state;\n  }\n};\n\nconst id = (\n  state = '',\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n      return action.payload._id;\n    case types.REALM_RESET:\n      return '';\n    default:\n      return state;\n  }\n};\n\nconst isCreator = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n      return !!action.payload.isCreator;\n    case types.REALM_RESET:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst name = (\n  state = '',\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n      return action.payload.name;\n    case types.REALM_RESET:\n      return '';\n    default:\n      return state;\n  }\n};\n\nconst size = (\n  state = 0,\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n      return action.payload.size;\n    case types.REALM_RESET:\n      return 0;\n    default:\n      return state;\n  }\n};\n\nconst voxels = (\n  state = new Uint32Array(),\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n    case types.REALM_UPDATE_VOXELS:\n      return action.payload.voxels;\n    case types.REALM_RESET:\n      return new Uint32Array();\n    default:\n      return state;\n  }\n};\n\nconst realmReducer = combineReducers({\n  geometry,\n  id,\n  isCreator,\n  name,\n  size,\n  voxels,\n});\n\nexport default realmReducer;\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\nimport API from '@/services/api';\n\nconst sessionKey = 'REALMSVR::SESSION';\nconst storedSession = JSON.parse(\n  localStorage.getItem(sessionKey) || 'false'\n);\nif (storedSession) {\n  API.setAuthorization(storedSession.token);\n}\n\nconst isAuth = (\n  state = !!storedSession,\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n    case types.USER_LOGIN_FULFILLED:\n    case types.USER_REGISTER_FULFILLED:\n      return true;\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst isSigningIn = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.USER_SHOW_SESSION_POPUP:\n      return true;\n    case types.USER_LOGIN_FULFILLED:\n    case types.USER_HIDE_SESSION_POPUP:\n    case types.USER_REGISTER_FULFILLED:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst profile = (\n  state = storedSession ? storedSession.profile : {},\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n    case types.USER_LOGIN_FULFILLED:\n    case types.USER_REGISTER_FULFILLED: {\n      const { profile } = action.payload;\n      const { name } = profile;\n      return {\n        ...profile,\n        firstName: name.split(' ')[0],\n      };\n    }\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      return {};\n    default:\n      return state;\n  }\n};\n\nconst token = (\n  state = storedSession ? storedSession.token : {},\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n    case types.USER_LOGIN_FULFILLED:\n    case types.USER_REGISTER_FULFILLED:\n      API.setAuthorization(action.payload.token);\n      localStorage.setItem(sessionKey, JSON.stringify(action.payload));\n      return action.payload.token;\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      API.setAuthorization(false);\n      localStorage.removeItem(sessionKey);\n      return '';\n    default:\n      return state;\n  }\n};\n\nconst userReducer = combineReducers({\n  isAuth,\n  isSigningIn,\n  profile,\n  token,\n});\n\nexport default userReducer;\n","import { combineReducers } from 'redux';\nimport { i18nReducer as i18n } from 'react-redux-i18n';\nimport { loadingBarReducer as loadingBar } from 'react-redux-loading-bar';\nimport lobby from './lobby';\nimport realm from './realm';\nimport user from './user';\n\nconst rootReducer = combineReducers({\n  i18n,\n  loadingBar,\n  lobby,\n  realm,\n  user,\n});\n\nexport default rootReducer;\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst Link = styled.a`\n  position: absolute;\n  top: 0;\n  right: 0;\n  .octo-arm {\n    transform-origin: 130px 106px;\n  }\n  &:hover .octo-arm {\n    animation: octocat-wave 560ms ease-in-out;\n  }\n  @keyframes octocat-wave {\n    0% {\n      transform: rotate(0deg);\n    }\n    20% {\n      transform: rotate(-25deg);\n    }\n    40% {\n      transform: rotate(10deg);\n    }\n    60% {\n      transform: rotate(-25deg);\n    }\n    80% {\n      transform: rotate(10deg);\n    }\n    100% {\n      transform: rotate(0deg);\n    }\n  }\n`;\n\nconst GitHub = () => (\n  <Link\n    href=\"https://github.com/danielesteban/RealmsVR#readme\"\n    rel=\"noopener noreferrer\"\n    target=\"_blank\"\n  >\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"80\"\n      height=\"80\"\n      viewBox=\"0 0 250 250\"\n      fill=\"#fff\"\n    >\n      <path\n        d=\"M0 0l115 115h15l12 27 108 108V0z\"\n        fill=\"#000\"\n      />\n      <path\n        className=\"octo-arm\"\n        d=\"M128 109c-15-9-9-19-9-19 3-7 2-11 2-11-1-7 3-2 3-2 4 5 2 11 2 11-3 10 5 15 9 16\"\n      />\n      <path\n        className=\"octo-body\"\n        d=\"M115 115s4 2 5 0l14-14c3-2 6-3 8-3-8-11-15-24 2-41 5-5 10-7 16-7 1-2 3-7 12-11 0 0 5 3 7 16 4 2 8 5 12 9s7 8 9 12c14 3 17 7 17 7-4 8-9 11-11 11 0 6-2 11-7 16-16 16-30 10-41 2 0 3-1 7-5 11l-12 11c-1 1 1 5 1 5z\"\n      />\n    </svg>\n  </Link>\n);\n\nexport default GitHub;\n","import React, { PureComponent } from 'react';\nimport styled from 'styled-components';\n\nconst Wrapper = styled.div`\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  display: flex;\n  align-items: flex-end;\n  > a > img {\n    width: 100px;\n    height: 100px;\n    background: #000;\n    border: 0;\n    outline: none;\n    vertical-align: middle;\n  }\n  > div {\n    background: rgba(0, 0, 0, .5);\n    font-size: 1.4em;\n    line-height: 1.5em;\n    padding: 0.5rem 1rem;\n    border-radius: 0 4px 0 0;\n    > a {\n      display: block;\n      text-decoration: none;\n      outline: none;\n      &:hover {\n        text-decoration: underline;\n      }\n    }\n    > a:nth-child(1) {\n      color: #eee;\n    }\n    > a:nth-child(2) {\n      color: #aaa;\n    }\n  }\n`;\n\nclass Music extends PureComponent {\n  constructor(props) {\n    super(props);\n    // Shuffle tracks\n    const tracks = [...Music.tracks];\n    for (let index = tracks.length - 1; index >= 0; index -= 1) {\n      const random = Math.floor(Math.random() * tracks.length);\n      const temp = tracks[index];\n      tracks[index] = tracks[random];\n      tracks[random] = temp;\n    }\n    // Initialize state\n    this.player = document.createElement('audio');\n    this.player.onended = this.next.bind(this);\n    this.player.volume = 0.5;\n    this.state = { track: undefined };\n    this.tracks = tracks;\n    this.track = 0;\n  }\n\n  componentDidMount() {\n    this.waitForFirstInteraction();\n  }\n\n  waitForFirstInteraction() {\n    const first = () => {\n      window.removeEventListener('mousedown', first);\n      window.removeEventListener('touchstart', first);\n      window.removeEventListener('vrdisplayactivate', first);\n      this.play();\n    };\n    window.addEventListener('mousedown', first, false);\n    window.addEventListener('touchstart', first, false);\n    window.addEventListener('vrdisplayactivate', first, false);\n  }\n\n  next() {\n    const { player } = this;\n    // Stop current player\n    if (!player.paused) {\n      player.pause();\n    }\n    player.src = '';\n    // Loop through the track list\n    this.track = (this.track + 1) % this.tracks.length;\n    this.play();\n  }\n\n  play() {\n    const {\n      player,\n      track,\n      tracks,\n    } = this;\n    // Fetch the current track\n    const clientId = 'client_id=eb5fcff9e107aab508431b4c3c416415';\n    const id = tracks[track];\n    if (!__PRODUCTION__) {\n      console.log(`playing: ${id}`);\n    }\n    fetch(`https://api.soundcloud.com/tracks/${id}?format=json&${clientId}`)\n      .then(res => res.json())\n      .then((track) => {\n        if (!track) {\n          throw new Error(`Couldn't fetch track: ${id}`);\n        }\n        // Play the track\n        player.src = `${track.stream_url}?${clientId}`;\n        player.play();\n        this.setState({ track });\n      })\n      .catch(() => (\n        this.next()\n      ));\n  }\n\n  render() {\n    const { track } = this.state;\n    if (!track) {\n      return null;\n    }\n    const {\n      title,\n      artwork_url: artwork,\n      permalink_url: link,\n      user: { username, permalink_url: userlink },\n      waveform_url: waveform,\n    } = track;\n    return (\n      <Wrapper>\n        <a\n          href={link}\n          rel=\"noopener noreferrer\"\n          target=\"_blank\"\n        >\n          <img alt={title} src={artwork || waveform} />\n        </a>\n        <div>\n          <a\n            href={link}\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            {title}\n          </a>\n          <a\n            href={userlink}\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            {username}\n          </a>\n        </div>\n      </Wrapper>\n    );\n  }\n}\n\n// eslint-disable-next-line\nMusic.tracks = [334831124,3654595,3654647,62965282,55529274,40801532,28921242,58102473,65194517,44049414,584470,348172961,348172759,118227213,58103033,58102746,255599053,29062473,73664676,217254339,26016069,143994169,34751566,22899851,19645145,14604316,14604145,9747273,290203217,290202627,290203029,290203125,230280393,230280565,230280839,290202890,230280665,230280740,174033188,238809205,219872323,85441920,85442027,85442324,85442658,295429557,31232642,118720768,66345578,64979755,9747680,3654444,354826097,174209343,374346584,374346578,374346566,374346536,374346518,374346506,374346440,272272960,82537981,272272962,331110005,253646536,69972925,297108748,95089740,264157290,3654394,51204969,28460870,270165801,93513660,107137565,200476847,241036508,345846433,13728685,3193491,235796705,74366070,293115267,65027631,226460783,132730188,267647225,331743020,348075711,328602395,232135696,13385987,303726380];\n\nexport default Music;\n","import {\n  BoxGeometry,\n  BufferGeometry,\n  Line,\n  LineBasicMaterial,\n  Matrix4,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  Vector3,\n} from 'three';\n\nclass Hands extends Object3D {\n  constructor() {\n    if (\n      !Hands.mesh\n      || !Hands.pointerMesh\n    ) Hands.setup();\n\n    super();\n    const { mesh, pointerMesh } = Hands;\n    for (let i = 0; i < 2; i += 1) {\n      const hand = mesh.clone();\n      hand.buttons = {\n        menu: false,\n        menuDown: false,\n        menuUp: false,\n        grip: false,\n        gripDown: false,\n        gripUp: false,\n        pad: false,\n        padDown: false,\n        padUp: false,\n        trigger: false,\n        triggerDown: false,\n        triggerUp: false,\n      };\n      hand.pointer = pointerMesh.clone();\n      hand.pointer.visible = false;\n      hand.add(hand.pointer);\n      hand.matrixAutoUpdate = false;\n      hand.setupRaycaster = raycaster => Hands.setupRaycaster({ hand, raycaster });\n      hand.visible = false;\n      this.add(hand);\n    }\n  }\n\n  update() {\n    const { children } = this;\n    const gamepads = ('getGamepads' in navigator ? navigator.getGamepads() : []);\n    children.forEach((hand) => {\n      hand.visible = false;\n    });\n    let hand = 0;\n    for (let i = 0; i < gamepads.length; i += 1) {\n      const gamepad = gamepads[i];\n      if (\n        gamepad\n        && (\n          gamepad.id === 'OpenVR Gamepad'\n          || gamepad.id.startsWith('Oculus Touch')\n          || gamepad.id.startsWith('Spatial Controller')\n        )\n      ) {\n        if (gamepad.pose) {\n          this.updateHand({\n            hand: children[hand],\n            buttons: gamepad.buttons,\n            pose: gamepad.pose,\n          });\n        }\n        hand += 1;\n        if (hand > 1) break;\n      }\n    }\n  }\n\n  updateHand({\n    hand,\n    buttons,\n    pose,\n  }) {\n    const { standingMatrix } = this;\n    if (pose.position !== null) {\n      hand.position.fromArray(pose.position);\n    }\n    if (pose.orientation !== null) {\n      hand.quaternion.fromArray(pose.orientation);\n    }\n    hand.matrix.compose(hand.position, hand.quaternion, hand.scale);\n    hand.matrix.premultiply(standingMatrix);\n    hand.matrixWorldNeedsUpdate = true;\n    hand.visible = true;\n\n    const menu = buttons[3] && buttons[3].pressed;\n    hand.buttons.menuDown = menu && hand.buttons.menu !== menu;\n    hand.buttons.menuUp = !menu && hand.buttons.menu !== menu;\n    hand.buttons.menu = menu;\n    const grip = buttons[2] && buttons[2].pressed;\n    hand.buttons.gripDown = grip && hand.buttons.grip !== grip;\n    hand.buttons.gripUp = !grip && hand.buttons.grip !== grip;\n    hand.buttons.grip = grip;\n    const pad = buttons[0] && buttons[0].pressed;\n    hand.buttons.padDown = pad && hand.buttons.pad !== pad;\n    hand.buttons.padUp = !pad && hand.buttons.pad !== pad;\n    hand.buttons.pad = pad;\n    const trigger = buttons[1] && buttons[1].pressed;\n    hand.buttons.triggerDown = trigger && hand.buttons.trigger !== trigger;\n    hand.buttons.triggerUp = !trigger && hand.buttons.trigger !== trigger;\n    hand.buttons.trigger = trigger;\n  }\n\n  static setupRaycaster({ hand, raycaster }) {\n    if (!hand.auxMatrix) {\n      hand.auxMatrix = new Matrix4();\n    }\n    const { auxMatrix, matrixWorld } = hand;\n    auxMatrix.identity().extractRotation(matrixWorld);\n    raycaster.ray.origin.setFromMatrixPosition(matrixWorld);\n    raycaster.ray.direction.set(0, 0, -1).applyMatrix4(auxMatrix);\n    raycaster.ray.origin.addScaledVector(raycaster.ray.direction, -0.175);\n  }\n\n  static setup() {\n    if (!Hands.geometry) {\n      const geometry = new BoxGeometry(1, 1, 1);\n      geometry.scale(0.05, 0.03, 0.2);\n      geometry.translate(0, 0, 0.075);\n      geometry.faces.forEach((face, i) => {\n        face.color.set(0x777777);\n        if (i >= 10 && i <= 11) {\n          face.color.offsetHSL(0, 0, -0.1);\n        }\n      });\n      Hands.geometry = (new BufferGeometry()).fromGeometry(geometry);\n    }\n    if (!Hands.material) {\n      Hands.material = new MeshBasicMaterial({\n        color: 0xffe0bd,\n      });\n    }\n    if (!Hands.mesh) {\n      Hands.mesh = new Mesh(\n        Hands.geometry,\n        Hands.material\n      );\n    }\n    if (!Hands.pointerGeometry) {\n      Hands.pointerGeometry = (new BufferGeometry())\n        .setFromPoints([new Vector3(0, 0, 0), new Vector3(0, 0, -1)]);\n    }\n    if (!Hands.pointerMaterial) {\n      Hands.pointerMaterial = new LineBasicMaterial({\n        color: 0xffe0bd,\n      });\n    }\n    if (!Hands.pointerMesh) {\n      Hands.pointerMesh = new Line(\n        Hands.pointerGeometry,\n        Hands.pointerMaterial\n      );\n    }\n  }\n}\n\nexport default Hands;\n","import React, { Component } from 'react';\nimport Stats from 'stats.js';\nimport {\n  Clock,\n  FogExp2,\n  Object3D,\n  PerspectiveCamera,\n  Raycaster,\n  Scene,\n  ShaderChunk,\n  WebGLRenderer,\n} from 'three';\nimport Hands from './hands';\n\nclass Renderer extends Component {\n  constructor(props) {\n    super(props);\n    this.canvas = React.createRef();\n    this.onAnimationTick = this.onAnimationTick.bind(this);\n    this.onResize = this.onResize.bind(this);\n  }\n\n  componentDidMount() {\n    const { canvas: { current: canvas } } = this;\n    this.camera = new PerspectiveCamera(80, 1, 0.1, 1024);\n    this.clock = new Clock();\n    this.raycaster = new Raycaster();\n    this.room = new Object3D();\n    this.room.add(this.camera);\n    this.hands = new Hands();\n    this.room.add(this.hands);\n    this.resetCamera();\n    this.resetScene();\n    const renderer = new WebGLRenderer({\n      antialias: true,\n      canvas,\n      powerPreference: 'high-performance',\n      stencil: false,\n    });\n    renderer.setPixelRatio(window.devicePixelRatio || 1);\n    renderer.setClearColor(this.scene.fog.color);\n    renderer.setAnimationLoop(this.onAnimationTick);\n    window.addEventListener('resize', this.onResize, false);\n    this.renderer = renderer;\n    this.onResize();\n    this.setupVR();\n    if (!__PRODUCTION__) {\n      this.stats = new Stats();\n      this.stats.dom.style.top = 'auto';\n      this.stats.dom.style.left = 'auto';\n      this.stats.dom.style.bottom = '0';\n      this.stats.dom.style.right = '0';\n      document.body.appendChild(this.stats.dom);\n    }\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  onAnimationTick() {\n    const {\n      camera,\n      clock,\n      hands,\n      renderer,\n      scene,\n      stats,\n    } = this;\n    if (stats) stats.begin();\n    renderer.animation = {\n      delta: clock.getDelta(),\n      time: clock.oldTime / 1000,\n    };\n    hands.update();\n    renderer.render(scene, camera);\n    if (stats) stats.end();\n  }\n\n  onResize() {\n    const {\n      canvas: { current: canvas },\n      camera,\n      renderer,\n    } = this;\n    const { width, height } = canvas.parentNode.getBoundingClientRect();\n    this.width = width;\n    this.height = height;\n    if (!renderer.vr.isPresenting()) {\n      renderer.setSize(width, height);\n    }\n    camera.aspect = width / height;\n    camera.updateProjectionMatrix();\n  }\n\n  getMaxAnisotropy() {\n    const { renderer } = this;\n    return renderer.capabilities.getMaxAnisotropy();\n  }\n\n  setupVR() {\n    const { hands, renderer } = this;\n    const hasWebXR = 'xr' in navigator;\n    const hasWebVR = 'getVRDisplays' in navigator;\n    if (hasWebXR) {\n      // TODO:\n      // Verify that this actually works\n      const enterVR = () => {\n        if (renderer.vr.isPresenting()) return;\n        const display = renderer.vr.getDevice();\n        if (!display) {\n          navigator.xr.requestDevice().then((display) => {\n            renderer.vr.enabled = true;\n            renderer.vr.setDevice(display);\n          });\n          return;\n        }\n        display\n          .requestSession({ immersive: true, exclusive: true /* DEPRECATED */ })\n          .then((session) => {\n            renderer.vr.setSession(session, { frameOfReferenceType: 'stage' });\n          });\n      };\n      window.addEventListener('mousedown', enterVR, false);\n      enterVR();\n    } else if (hasWebVR) {\n      const enterVR = () => {\n        if (renderer.vr.isPresenting()) return;\n        const display = renderer.vr.getDevice();\n        if (!display) {\n          navigator.getVRDisplays().then((displays) => {\n            if (!displays.length) return;\n            const [display] = displays;\n            renderer.vr.enabled = true;\n            renderer.vr.setDevice(display);\n          });\n          return;\n        }\n        display.requestPresent([{ source: renderer.domElement }]);\n      };\n      window.addEventListener('mousedown', enterVR, false);\n      window.addEventListener('vrdisplayactivate', enterVR, false);\n      enterVR();\n    }\n    hands.standingMatrix = renderer.vr.getStandingMatrix();\n  }\n\n  resetCamera() {\n    const { camera } = this;\n    camera.position.set(0, 1.25, 0);\n    camera.rotation.set(0, 0, 0);\n  }\n\n  resetScene() {\n    if (this.scene) {\n      this.scene.children.forEach((child) => {\n        if (child.dispose) child.dispose();\n      });\n    }\n    this.room.position.set(0, 0, 0);\n    this.scene = new Scene();\n    this.scene.add(this.room);\n    this.scene.fog = new FogExp2(0, 0.0125);\n    this.scene.fog.color.setRGB(0.01, 0.01, 0.08);\n    return this.scene;\n  }\n\n  render() {\n    const { canvas } = this;\n    return (\n      <canvas ref={canvas} />\n    );\n  }\n}\n\n// Fix threeJS Fog\nShaderChunk.fog_pars_vertex = ShaderChunk.fog_pars_vertex.replace(\n  'varying float fogDepth;',\n  'varying vec4 fogDepth;'\n);\nShaderChunk.fog_vertex = ShaderChunk.fog_vertex.replace(\n  'fogDepth = -mvPosition.z;',\n  'fogDepth = mvPosition;'\n);\nShaderChunk.fog_pars_fragment = ShaderChunk.fog_pars_fragment.replace(\n  'varying float fogDepth;',\n  'varying vec4 fogDepth;'\n);\nShaderChunk.fog_fragment = ShaderChunk.fog_fragment.replace(\n  'float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );',\n  [\n    'float fogDist = length(fogDepth);',\n    'float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDist * fogDist * LOG2 ) );',\n  ].join('\\n')\n).replace(\n  'float fogFactor = smoothstep( fogNear, fogFar, fogDepth );',\n  'float fogFactor = smoothstep( fogNear, fogFar, length(fogDepth) );'\n);\n\nexport default Renderer;\n","import PropTypes from 'prop-types';\nimport React, { PureComponent } from 'react';\nimport {\n  TiKey,\n  TiSocialGooglePlusCircular,\n  TiTimes,\n} from 'react-icons/ti';\nimport { connect } from 'react-redux';\nimport { Translate } from 'react-redux-i18n';\nimport styled from 'styled-components';\nimport {\n  hideSessionPopup as hide,\n  login,\n  loginWithGoogle,\n  register,\n} from '@/actions/user';\n\nconst Wrapper = styled.div`\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  background: rgba(0, 0, 0, .5);\n`;\n\nconst Popup = styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 512px;\n  background: #444;\n  box-shadow: 0 0 32px rgba(0, 0, 0, .5);\n`;\n\nconst Heading = styled.div`\n  background: #111;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 56px;\n  .tabs {\n    display: flex;\n    height: 100%;\n    > a {\n      display: flex;\n      align-items: center;\n      background: #222;\n      padding: 0 1rem;\n      border-left: 1px solid #333;\n      cursor: pointer;\n      &:first-child {\n        border-left: none;\n      }\n      &.active {\n        background: #444;\n        cursor: default;\n      }\n    }\n  }\n  > a {\n    padding: 1rem;\n    > svg {\n      font-size: 1.5em;\n    }\n  }\n`;\n\nconst Content = styled.div`\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem 0;\n  button {\n    display: flex;\n    align-items: center;\n    border: 1px solid #555;\n    background: #222;\n    padding: 0.5rem 1rem;\n    margin: 0;\n    font-family: inherit;\n    font-weight: 700;\n    font-size: 1.2rem;\n    color: inherit;\n    cursor: pointer;\n    outline: 0;\n    > svg {\n      font-size: 1.5em;\n      margin-right: 0.5rem;\n    }\n  }\n  .or {\n    position: relative;\n    width: 100%;\n    border-top: 1px solid #222;\n    margin: 2rem 0;\n    > span {\n      position: absolute;\n      display: block;\n      left: 50%;\n      transform: translate(-50%, -50%);\n    }\n  }\n  .google {\n    display: flex;\n    justify-content: center;\n  }\n`;\n\nconst Form = styled.form`\n  display: none;\n  flex-direction: column;\n  align-items: center;\n  width: 80%;\n  &.active {\n    display: flex;\n  }\n  > label {\n    width: 100%;\n    padding: 0;\n  }\n  > input {\n    box-sizing: border-box;\n    border: 1px solid #333;\n    width: 100%;\n    background: #222;\n    color: inherit;\n    font-family: inherit;\n    font-weight: 400;\n    font-size: 2em;\n    padding: 0.5rem;\n    margin: 0 0 1rem;\n  }\n`;\n\nclass Session extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.onLoginSubmit = this.onLoginSubmit.bind(this);\n    this.onRegisterSubmit = this.onRegisterSubmit.bind(this);\n    this.state = { tab: 'login' };\n  }\n\n  onLoginSubmit(e) {\n    e.preventDefault();\n    const { target: form } = e;\n    const { login } = this.props;\n    login({\n      email: form.email.value,\n      password: form.password.value,\n    });\n  }\n\n  onRegisterSubmit(e) {\n    e.preventDefault();\n    const { target: form } = e;\n    const { register } = this.props;\n    if (form.password.value !== form.confirmPassword.value) {\n      return;\n    }\n    register({\n      email: form.email.value,\n      name: form.name.value,\n      password: form.password.value,\n    });\n  }\n\n  render() {\n    const {\n      isSigningIn,\n      hide,\n      loginWithGoogle,\n    } = this.props;\n    const { tab } = this.state;\n    if (!isSigningIn) {\n      return null;\n    }\n    return (\n      <Wrapper>\n        <Popup>\n          <Heading>\n            <div className=\"tabs\">\n              <a\n                className={tab === 'login' ? 'active' : null}\n                onClick={() => this.setState({ tab: 'login' })}\n              >\n                <Translate value=\"User.signIn\" />\n              </a>\n              <a\n                className={tab === 'register' ? 'active' : null}\n                onClick={() => this.setState({ tab: 'register' })}\n              >\n                <Translate value=\"User.register\" />\n              </a>\n            </div>\n            <a\n              onClick={hide}\n            >\n              <TiTimes />\n            </a>\n          </Heading>\n          <Content>\n            <Form\n              className={tab === 'login' ? 'active' : null}\n              onSubmit={this.onLoginSubmit}\n            >\n              <label><Translate value=\"User.email\" /></label>\n              <input type=\"email\" name=\"email\" required />\n              <label><Translate value=\"User.password\" /></label>\n              <input type=\"password\" name=\"password\" required />\n              <button\n                type=\"submit\"\n              >\n                <TiKey />\n                <Translate value=\"User.signIn\" />\n              </button>\n            </Form>\n            <Form\n              className={tab === 'register' ? 'active' : null}\n              onSubmit={this.onRegisterSubmit}\n            >\n              <label><Translate value=\"User.name\" /></label>\n              <input type=\"text\" name=\"name\" required />\n              <label><Translate value=\"User.email\" /></label>\n              <input type=\"email\" name=\"email\" required />\n              <label><Translate value=\"User.password\" /></label>\n              <input type=\"password\" name=\"password\" required />\n              <label><Translate value=\"User.confirmPassword\" /></label>\n              <input type=\"password\" name=\"confirmPassword\" required />\n              <button\n                type=\"submit\"\n              >\n                <TiKey />\n                <Translate value=\"User.register\" />\n              </button>\n            </Form>\n            <div className=\"or\">\n              <Translate value=\"User.or\" />\n            </div>\n            <div className=\"google\">\n              <button\n                onClick={loginWithGoogle}\n                type=\"button\"\n              >\n                <TiSocialGooglePlusCircular />\n                <Translate value=\"User.signInWithGoogle\" />\n              </button>\n            </div>\n          </Content>\n        </Popup>\n      </Wrapper>\n    );\n  }\n}\n\nSession.propTypes = {\n  isSigningIn: PropTypes.bool.isRequired,\n  hide: PropTypes.func.isRequired,\n  login: PropTypes.func.isRequired,\n  loginWithGoogle: PropTypes.func.isRequired,\n  register: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    user: {\n      isSigningIn,\n    },\n  }) => ({\n    isSigningIn,\n  }),\n  {\n    hide,\n    login,\n    loginWithGoogle,\n    register,\n  }\n)(Session);\n","import { setLocale as reduxSetLocale } from 'react-redux-i18n';\nimport * as types from './types';\nimport API from '@/services/api';\n\nexport function hideSessionPopup() {\n  return {\n    type: types.USER_HIDE_SESSION_POPUP,\n  };\n}\n\nexport function register({ email, name, password }) {\n  return dispatch => dispatch({\n    type: types.USER_REGISTER,\n    payload: API.fetch({\n      body: {\n        email,\n        name,\n        password,\n      },\n      endpoint: 'user',\n      method: 'PUT',\n    }),\n  }).catch(() => {});\n}\n\nexport function refreshSession() {\n  return dispatch => dispatch({\n    type: types.USER_REFRESH_SESSION,\n    payload: API.fetch({\n      endpoint: 'user',\n    }),\n  }).catch(() => {});\n}\n\nexport function setLocale(locale) {\n  return (dispatch) => {\n    localStorage.setItem('REALMSVR::LOCALE', locale);\n    dispatch(reduxSetLocale(locale));\n  };\n}\n\nexport function showSessionPopup() {\n  return {\n    type: types.USER_SHOW_SESSION_POPUP,\n  };\n}\n\nexport function login({ email, password }) {\n  return dispatch => dispatch({\n    type: types.USER_LOGIN,\n    payload: API.fetch({\n      body: {\n        email,\n        password,\n      },\n      endpoint: 'user',\n      method: 'POST',\n    }),\n  }).catch(() => {});\n}\n\nexport function loginWithGoogle() {\n  return (dispatch) => {\n    const w = 512;\n    const h = 512;\n    const left = (window.screen.width / 2) - w / 2;\n    const top = (window.screen.height / 2) - h / 2;\n    const win = window.open(\n      `${API.baseURL}user/google`,\n      'loginWithGoogle',\n      `width=${w},height=${h},top=${top},left=${left}`\n    );\n    const watcher = setInterval(() => {\n      if (!win.window) {\n        clearInterval(watcher);\n        return;\n      }\n      win.postMessage(true, API.baseURL);\n    }, 100);\n    const onMessage = ({ origin, data: { session } }) => {\n      if (API.baseURL.indexOf(origin) === 0) {\n        window.removeEventListener('message', onMessage);\n        clearInterval(watcher);\n        if (!session) {\n          return;\n        }\n        dispatch({\n          type: types.USER_LOGIN_FULFILLED,\n          payload: session,\n        });\n      }\n    };\n    window.addEventListener('message', onMessage, false);\n  };\n}\n\nexport function signout() {\n  return {\n    type: types.USER_SIGNOUT,\n  };\n}\n","import Worker from '@/services/mesher.worker';\n\nclass Mesher {\n  constructor() {\n    this.promiseId = 0;\n    this.promises = {};\n    this.worker = new Worker();\n    this.worker.onmessage = this.onMessage.bind(this);\n  }\n\n  generate({ size, voxels }) {\n    const { promiseId, promises, worker } = this;\n    return new Promise((resolve) => {\n      promises[promiseId] = resolve;\n      this.promiseId += 1;\n      worker.postMessage({\n        promiseId,\n        size,\n        voxels,\n      });\n    });\n  }\n\n  onMessage({ data: { geometry, promiseId } }) {\n    const { promises } = this;\n    promises[promiseId](geometry);\n    delete promises[promiseId];\n  }\n}\n\nexport default new Mesher();\n","import * as types from './types';\nimport API from '@/services/api';\nimport Mesher from '@/services/mesher';\n\nexport function create() {\n  return {\n    type: types.REALM_CREATE,\n    payload: API.fetch({\n      endpoint: 'realm',\n      method: 'PUT',\n    }),\n  };\n}\n\nexport function generateGeometry({ size, voxels }) {\n  return {\n    type: types.REALM_UPDATE_GEOMETRY,\n    payload: Mesher.generate({ size, voxels }),\n  };\n}\n\nexport function fetch(slug) {\n  return dispatch => dispatch({\n    type: types.REALM_FETCH,\n    payload: API.fetch({\n      endpoint: `realm/${slug}`,\n    })\n      .then(realm => (\n        API.fetch({\n          endpoint: `realm/${realm._id}/voxels`,\n        })\n          .then((voxels) => {\n            voxels = new Uint32Array(voxels);\n            dispatch(generateGeometry({ size: realm.size, voxels }));\n            return {\n              ...realm,\n              voxels,\n            };\n          })\n      )),\n  });\n}\n\nexport function reset() {\n  return {\n    type: types.REALM_RESET,\n  };\n}\n\nexport function updateVoxels({\n  color,\n  normal,\n  point,\n  remove,\n}) {\n  return (dispatch, getState) => {\n    const {\n      realm: {\n        id,\n        isCreator,\n        size,\n        voxels: current,\n      },\n    } = getState();\n    // Normalize & 3D wrap voxel position\n    const [x, y, z] = ['x', 'y', 'z'].map((axis) => {\n      let position = Math.floor(point[axis] + (normal[axis] * 0.5 * (remove ? -1 : 1)));\n      while (position < 0) position += size;\n      while (position >= size) position -= size;\n      return position;\n    });\n    // Randomize the color just a bit\n    const randomized = {\n      r: Math.min(Math.max(Math.round((color.r * 0xFF) + (Math.random() * 8) - 4), 0), 255),\n      g: Math.min(Math.max(Math.round((color.g * 0xFF) + (Math.random() * 8) - 4), 0), 255),\n      b: Math.min(Math.max(Math.round((color.b * 0xFF) + (Math.random() * 8) - 4), 0), 255),\n    };\n    const value = remove ? (\n      0x00\n    ) : (\n      (0x01 << 24) | (randomized.r << 16) | (randomized.g << 8) | randomized.b\n    );\n    // Update the voxels data\n    const voxels = new Uint32Array(current);\n    voxels[z * size * size + y * size + x] = value;\n    // Request a geometry generation\n    dispatch(generateGeometry({ size, voxels }));\n    if (isCreator) {\n      // Send update to server\n      const body = new FormData();\n      body.append('voxels', new Blob([voxels.buffer], { type: 'text/plain' }));\n      API.fetch({\n        body,\n        endpoint: `realm/${id}/voxels`,\n        method: 'PUT',\n      });\n    }\n    return dispatch({\n      type: types.REALM_UPDATE_VOXELS,\n      payload: { voxels },\n    });\n  };\n}\n","import {\n  BufferGeometry,\n  Color,\n  Mesh,\n  MeshBasicMaterial,\n  PlaneGeometry,\n  VertexColors,\n} from 'three';\n\nclass Ground extends Mesh {\n  constructor() {\n    if (\n      !Ground.geometry\n      || !Ground.material\n    ) {\n      Ground.setup();\n    }\n    super(\n      Ground.geometry,\n      Ground.material\n    );\n  }\n\n  static setup() {\n    if (!Ground.geometry) {\n      const size = 256;\n      const geometry = new PlaneGeometry(size, size, size, size);\n      geometry.rotateX(Math.PI * -0.5);\n      const color = new Color();\n      geometry.faces.forEach((face, i) => {\n        if (i % 2 === 1) {\n          face.color.copy(color);\n        } else {\n          face.color.setHex(0x666655);\n          face.color.offsetHSL(0, 0, Math.random() * -0.1);\n          color.copy(face.color);\n        }\n      });\n      Ground.geometry = (new BufferGeometry()).fromGeometry(geometry);\n    }\n    if (!Ground.material) {\n      Ground.material = new MeshBasicMaterial({\n        vertexColors: VertexColors,\n      });\n    }\n  }\n}\n\nexport default Ground;\n","import {\n  BoxGeometry,\n  BufferGeometry,\n  CanvasTexture,\n  DoubleSide,\n  Mesh,\n  MeshBasicMaterial,\n  PlaneBufferGeometry,\n  VertexColors,\n  Vector3,\n} from 'three';\n\nclass Panel extends Mesh {\n  constructor({\n    anisotropy,\n    width = 512,\n    height = 512,\n  }) {\n    if (\n      !Panel.backplate\n      || !Panel.geometry\n    ) {\n      Panel.setup();\n    }\n    const renderer = document.createElement('canvas');\n    renderer.width = width;\n    renderer.height = height;\n    const texture = new CanvasTexture(renderer);\n    texture.anisotropy = anisotropy;\n    super(\n      Panel.geometry,\n      new MeshBasicMaterial({\n        map: texture,\n      })\n    );\n    this.add(Panel.backplate.clone());\n    this.context = renderer.getContext('2d');\n    this.pointer = new Vector3();\n    this.renderer = renderer;\n    this.texture = texture;\n  }\n\n  dispose() {\n    const { material, texture } = this;\n    material.dispose();\n    texture.dispose();\n  }\n\n  draw() {\n    const {\n      context: ctx,\n      renderer,\n      texture,\n    } = this;\n    ctx.fillStyle = '#111';\n    ctx.fillRect(0, 0, renderer.width, renderer.height);\n    texture.needsUpdate = true;\n  }\n\n  onPointer(point) {\n    const { pointer, renderer } = this;\n    this.worldToLocal(pointer.copy(point));\n    pointer.set(\n      (pointer.x + 0.5) * renderer.width,\n      (1 - (pointer.y + 0.5)) * renderer.height,\n      0\n    );\n  }\n\n  static setup() {\n    if (!Panel.backplate) {\n      const geometry = new BoxGeometry(1, 1, 0.06);\n      geometry.faces.splice(8, 2);\n      geometry.faces.forEach((face, i) => (\n        face.color.setHex(\n          Math.floor(i / 2) === 4 ? 0x111111 : 0x222222\n        )\n      ));\n      geometry.translate(0, 0, -0.01);\n      const backplate = new Mesh(\n        (new BufferGeometry()).fromGeometry(geometry),\n        new MeshBasicMaterial({\n          side: DoubleSide,\n          vertexColors: VertexColors,\n        })\n      );\n      Panel.backplate = backplate;\n    }\n\n    if (!Panel.geometry) {\n      Panel.geometry = new PlaneBufferGeometry(1, 1);\n    }\n  }\n}\n\nexport default Panel;\n","class Fonts {\n  constructor() {\n    this.loaded = {};\n  }\n\n  waitUntilLoaded(fonts) {\n    const { loaded } = this;\n    if (!Array.isArray(fonts)) {\n      fonts = [fonts];\n    }\n    return Promise.all(\n      fonts\n        .map(font => (\n          new Promise((resolve) => {\n            if (loaded[font]) {\n              resolve();\n              return;\n            }\n            const check = () => {\n              if (document.fonts.check(`1rem ${font}`)) {\n                loaded[font] = true;\n                resolve();\n                return;\n              }\n              setTimeout(check, 10);\n            };\n            check();\n          })\n        ))\n    );\n  }\n}\n\nexport default new Fonts();\n","import {\n  BufferGeometry,\n  Color,\n  CylinderGeometry,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  VertexColors,\n} from 'three';\nimport Panel from '@/components/panel';\nimport API from '@/services/api';\nimport Fonts from '@/services/fonts';\n\nclass Pillar extends Mesh {\n  constructor() {\n    if (!Pillar.geometry || !Pillar.material) {\n      Pillar.setup();\n    }\n    super(\n      Pillar.geometry,\n      Pillar.material\n    );\n  }\n\n  static setup() {\n    if (!Pillar.geometry) {\n      const geometry = new CylinderGeometry(0.025, 0.025, 1, 8, 16);\n      geometry.translate(0, -0.575, 0);\n      const color = new Color();\n      geometry.faces.forEach((face, i) => {\n        if (i % 2 === 1) {\n          face.color.copy(color);\n        } else {\n          face.color.setHex(0x556655);\n          face.color.offsetHSL(0, 0, Math.random() * -0.1);\n          color.copy(face.color);\n        }\n      });\n      Pillar.geometry = (new BufferGeometry()).fromGeometry(geometry);\n    }\n    if (!Pillar.material) {\n      Pillar.material = new MeshBasicMaterial({\n        vertexColors: VertexColors,\n      });\n    }\n  }\n}\n\nclass Realm extends Panel {\n  constructor({\n    anisotropy,\n    name,\n    creator,\n    onPointer,\n    screenshot,\n  }) {\n    super({\n      anisotropy,\n    });\n    this.name = name;\n    this.onPointer = onPointer;\n    this.scale.set(0.3, 0.3, 1);\n    {\n      const { width, height } = this.renderer;\n      const vignette = this.context.createRadialGradient(\n        width * 0.5, height * 0.5, width * 0.2,\n        width * 0.5, height * 0.5, width * 0.5\n      );\n      vignette.addColorStop(0, 'rgba(0, 0, 0, 0)');\n      vignette.addColorStop(1, 'rgba(0, 0, 0, .5)');\n      this.vignette = vignette;\n    }\n    let hasLoadedFont = false;\n    Fonts\n      .waitUntilLoaded('Roboto')\n      .then(() => {\n        hasLoadedFont = true;\n        this.draw();\n      });\n    if (creator) {\n      const image = new Image();\n      image.crossOrigin = 'anonymous';\n      image.src = `${API.baseURL}user/${creator._id}/photo`;\n      image.onload = () => {\n        this.creator = image;\n        if (hasLoadedFont) {\n          this.draw();\n        }\n      };\n    }\n    if (screenshot) {\n      const image = new Image();\n      image.src = `data:image/jpeg;base64,${screenshot}`;\n      image.onload = () => {\n        this.screenshot = image;\n        if (hasLoadedFont) {\n          this.draw();\n        }\n      };\n    }\n  }\n\n  draw() {\n    const {\n      context: ctx,\n      creator,\n      isHover,\n      name,\n      renderer,\n      screenshot,\n      vignette,\n    } = this;\n    super.draw();\n    if (screenshot) {\n      ctx.drawImage(screenshot, 0, 0);\n    }\n    ctx.fillStyle = vignette;\n    ctx.fillRect(0, 0, renderer.width, renderer.height);\n    ctx.fillStyle = `rgba(${isHover ? '255, 255, 255' : '0, 0, 0'}, .5)`;\n    ctx.fillRect(0, renderer.height * 0.75, renderer.width, renderer.height * 0.25);\n    ctx.font = '40px Roboto';\n    ctx.textAlign = 'left';\n    ctx.textBaseline = 'middle';\n    ctx.fillStyle = isHover ? '#333' : '#fff';\n    if (creator) {\n      ctx.drawImage(\n        creator,\n        0, renderer.height * 0.75,\n        renderer.width * 0.25, renderer.height * 0.25\n      );\n    }\n    ctx.fillText(\n      name,\n      renderer.width * 0.05 + (renderer.width * (creator ? 0.25 : 0.05)),\n      renderer.height * 0.875\n    );\n  }\n}\n\nclass ButtonsPanel extends Panel {\n  constructor({\n    anisotropy,\n  }) {\n    super({\n      anisotropy,\n      width: 256,\n      height: 256,\n    });\n    this.scale.set(0.25, 0.25, 1);\n    this.hasLoadedFont = false;\n    Fonts\n      .waitUntilLoaded('Roboto')\n      .then(() => {\n        this.hasLoadedFont = true;\n        this.draw();\n      });\n  }\n\n  draw() {\n    const {\n      buttons,\n      context: ctx,\n    } = this;\n    super.draw();\n    ctx.font = '700 30px Roboto';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    buttons.forEach(({\n      label,\n      x,\n      y,\n      width,\n      height,\n      isActive,\n      isDisabled,\n    }) => {\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.beginPath();\n      ctx.rect(0, 0, width, height);\n      if (isDisabled) {\n        ctx.fillStyle = '#555';\n      } else if (isActive) {\n        ctx.fillStyle = '#fff';\n      } else {\n        ctx.fillStyle = '#222';\n      }\n      ctx.strokeStyle = '#333';\n      ctx.fill();\n      ctx.stroke();\n      if (isDisabled) {\n        ctx.fillStyle = '#777';\n      } else if (isActive) {\n        ctx.fillStyle = '#222';\n      } else {\n        ctx.fillStyle = '#fff';\n      }\n      ctx.fillText(\n        label,\n        width * 0.5,\n        height * 0.5\n      );\n      ctx.restore();\n    });\n  }\n\n  onPointer({ isDown, point }) {\n    const { buttons, pointer } = this;\n    if (!isDown) return;\n    super.onPointer(point);\n    buttons\n      .filter(({ isDisabled }) => (!isDisabled))\n      .forEach(({\n        x,\n        y,\n        width,\n        height,\n        onPointer,\n      }) => {\n        if (\n          pointer.x < x\n          || pointer.x > x + width\n          || pointer.y < y\n          || pointer.y > y + height\n        ) {\n          return;\n        }\n        onPointer();\n      });\n  }\n}\n\nclass CreateRealm extends ButtonsPanel {\n  constructor({\n    anisotropy,\n    history,\n    createRealm,\n  }) {\n    super({ anisotropy });\n    this.scale.set(0.3, 0.3, 1);\n    const { width, height } = this.renderer;\n    this.buttons = [\n      {\n        label: 'Create Realm',\n        x: width * 0.1,\n        y: height * 0.3,\n        width: width * 0.8,\n        height: height * 0.4,\n        onPointer: () => (\n          createRealm()\n            .then(({ value: slug }) => history.push(`/${slug}`))\n        ),\n      },\n    ];\n  }\n}\n\nclass Pagination extends ButtonsPanel {\n  constructor({\n    anisotropy,\n    page,\n    pages,\n    update,\n  }) {\n    super({ anisotropy });\n    const { width, height } = this.renderer;\n    this.buttons = [\n      {\n        label: '<',\n        x: width * 0.1,\n        y: height * 0.3,\n        width: width * 0.3,\n        height: height * 0.4,\n        onPointer: () => {\n          if (this.page > 0) update(this.page - 1);\n        },\n      },\n      {\n        label: '>',\n        x: width * 0.6,\n        y: height * 0.3,\n        width: width * 0.3,\n        height: height * 0.4,\n        onPointer: () => {\n          if (this.page < this.pages - 1) update(this.page + 1);\n        },\n      },\n    ];\n    this.page = page;\n    this.pages = pages;\n  }\n\n  draw() {\n    const {\n      context: ctx,\n      page,\n      pages,\n      renderer,\n    } = this;\n    super.draw();\n    ctx.fillStyle = '#fff';\n    ctx.fillText(\n      `${page + 1} / ${pages}`,\n      renderer.width * 0.5,\n      renderer.height * 0.85\n    );\n  }\n}\n\nclass Session extends ButtonsPanel {\n  constructor({\n    anisotropy,\n    isSigningIn,\n    user,\n    signin,\n    signout,\n  }) {\n    super({ anisotropy });\n    this.signin = signin;\n    this.signout = signout;\n    this.updateSession({\n      isSigningIn,\n      user,\n    });\n  }\n\n  updateSession({ isSigningIn, user }) {\n    const { renderer, signin, signout } = this;\n    const { width, height } = renderer;\n    if (isSigningIn) {\n      this.buttons = [];\n    } else if (!user) {\n      this.buttons = [{\n        label: 'Sign-In',\n        x: width * 0.1,\n        y: height * 0.4,\n        width: width * 0.8,\n        height: height * 0.4,\n        onPointer: signin,\n      }];\n    } else {\n      this.buttons = [{\n        label: 'Sign-Out',\n        x: width * 0.1,\n        y: height * 0.7,\n        width: width * 0.8,\n        height: height * 0.2,\n        onPointer: signout,\n      }];\n    }\n    this.isSigningIn = isSigningIn;\n    this.user = user;\n    delete this.userPhoto;\n    if (user) {\n      const image = new Image();\n      image.crossOrigin = 'anonymous';\n      image.src = `${API.baseURL}user/${user._id}/photo`;\n      image.onload = () => {\n        this.userPhoto = image;\n        if (this.hasLoadedFont) {\n          this.draw();\n        }\n      };\n    }\n  }\n\n  draw() {\n    const {\n      context: ctx,\n      isSigningIn,\n      renderer,\n      user,\n      userPhoto,\n    } = this;\n    super.draw();\n    ctx.fillStyle = '#fff';\n    if (isSigningIn) {\n      ctx.fillText(\n        'Remove your',\n        renderer.width * 0.5,\n        renderer.height * 0.25\n      );\n      ctx.fillText(\n        'headset',\n        renderer.width * 0.5,\n        renderer.height * 0.4\n      );\n      ctx.fillText(\n        'And Sign-In',\n        renderer.width * 0.5,\n        renderer.height * 0.6\n      );\n      ctx.fillText(\n        'in your browser',\n        renderer.width * 0.5,\n        renderer.height * 0.75\n      );\n    } else {\n      ctx.fillText(\n        user ? user.firstName : 'Guest',\n        renderer.width * 0.5,\n        renderer.height * 0.2\n      );\n    }\n    if (user && userPhoto) {\n      ctx.drawImage(\n        userPhoto,\n        renderer.width * 0.5 - 40, renderer.height * 0.5 - 50,\n        80, 80\n      );\n    }\n  }\n}\n\nclass Filter extends ButtonsPanel {\n  constructor({\n    anisotropy,\n    isAuth,\n    filter,\n    update,\n  }) {\n    super({ anisotropy });\n    const { width, height } = this.renderer;\n    this.buttons = [\n      {\n        id: 'all',\n        label: 'All Realms',\n        x: width * 0.1,\n        y: height * 0.2,\n        width: width * 0.8,\n        height: height * 0.2,\n        onPointer: () => update('all'),\n      },\n      {\n        id: 'user',\n        label: 'Your Realms',\n        x: width * 0.1,\n        y: height * 0.6,\n        width: width * 0.8,\n        height: height * 0.2,\n        isDisabled: !isAuth,\n        onPointer: () => update('user'),\n      },\n    ];\n    this.filter = filter;\n    this.update = update;\n  }\n\n  updateSession({ isAuth }) {\n    this.buttons[1].isDisabled = !isAuth;\n  }\n\n  draw() {\n    const { buttons, filter } = this;\n    buttons.forEach((button) => {\n      button.isActive = button.id === filter;\n    });\n    super.draw();\n  }\n}\n\nclass Menu extends Object3D {\n  constructor({\n    anisotropy,\n    filter,\n    history,\n    isSigningIn,\n    pagination,\n    realms,\n    user,\n    createRealm,\n    setFilter,\n    setPage,\n    signin,\n    signout,\n  }) {\n    super();\n    this.anisotropy = anisotropy;\n    this.history = history;\n    this.hover = {};\n    this.intersects = [];\n    this.position.set(0, 1, -1);\n    this.pagination = this.addPanel(\n      Pagination,\n      {\n        ...pagination,\n        update: setPage,\n      },\n      0, -0.3, 0.13\n    );\n    this.session = this.addPanel(\n      Session,\n      {\n        isSigningIn,\n        user,\n        signin,\n        signout,\n      },\n      -0.3, -0.3, 0.13\n    );\n    this.filter = this.addPanel(\n      Filter,\n      {\n        filter,\n        isAuth: !!user,\n        update: setFilter,\n      },\n      0.3, -0.3, 0.13\n    );\n    this.createRealm = createRealm;\n    this.updateRealms(realms);\n  }\n\n  addPanel(Panel, props, x, y, z) {\n    const { anisotropy, intersects } = this;\n    const panel = new Panel({ ...props, anisotropy });\n    panel.position.set(x, y, z);\n    panel.lookAt(0, 0.5, 1);\n    this.add(panel);\n    const pillar = new Pillar();\n    pillar.position.copy(panel.position);\n    this.add(pillar);\n    intersects.push(panel);\n    return panel;\n  }\n\n  dispose() {\n    const { children } = this;\n    children.forEach(child => child.dispose && child.dispose());\n  }\n\n  setHover({ hand, realm }) {\n    const { hover } = this;\n    if (hover[hand] === realm) {\n      return;\n    }\n    if (hover[hand]) {\n      hover[hand].isHover = false;\n      hover[hand].draw();\n    }\n    if (realm) {\n      realm.isHover = true;\n      realm.draw();\n    }\n    this.hover[hand] = realm;\n  }\n\n  updateFilter(value) {\n    const { filter } = this;\n    filter.filter = value;\n    filter.draw();\n  }\n\n  updatePagination({ page, pages }) {\n    const { pagination } = this;\n    pagination.page = page;\n    pagination.pages = pages;\n    pagination.draw();\n  }\n\n  updateRealms(realms) {\n    const {\n      anisotropy,\n      children,\n      createRealm,\n      filter: { filter },\n      history,\n      pagination,\n    } = this;\n    while (children.length > 6) {\n      this.remove(children[children.length - 1]);\n    }\n    this.intersects.length = 3;\n    const showCreateRealm = filter === 'user' && pagination.page === 0;\n    const count = realms.length + (showCreateRealm ? 1 : 0);\n    let offset = 0.25 + count * -0.25;\n    if (showCreateRealm) {\n      this.addPanel(\n        CreateRealm,\n        {\n          history,\n          createRealm,\n        },\n        offset, 0, 0\n      );\n      offset += 0.5;\n    }\n    realms.forEach((realm, i) => {\n      const panel = this.addPanel(\n        Realm,\n        {\n          ...realm,\n          anisotropy,\n          onPointer: ({ hand, isDown }) => {\n            this.setHover({ hand, realm: panel });\n            if (isDown) {\n              history.push(`/${realm.slug}`);\n            }\n          },\n        },\n        offset + (i * 0.5), 0, 0\n      );\n    });\n  }\n\n  updateSession({ isSigningIn, user }) {\n    const { filter, session } = this;\n    filter.updateSession({ isAuth: !!user });\n    filter.draw();\n    session.updateSession({ isSigningIn, user });\n    session.draw();\n  }\n}\n\nexport default Menu;\n","import {\n  BufferGeometry,\n  Points,\n  PointsMaterial,\n  VertexColors,\n  BufferAttribute,\n  Vector3,\n} from 'three';\n\nclass Starfield extends Points {\n  constructor() {\n    if (\n      !Starfield.geometry\n      || !Starfield.material\n    ) {\n      Starfield.setup();\n    }\n    super(\n      Starfield.geometry,\n      Starfield.material\n    );\n  }\n\n  static setup() {\n    if (!Starfield.geometry) {\n      const count = 2048;\n      const radius = 512;\n      const position = new Float32Array(count * 3);\n      const color = new Float32Array(count * 3);\n      const aux = new Vector3();\n      for (let i = 0; i < count * 3; i += 3) {\n        aux\n          .set(\n            Math.random() * 2 - 1,\n            Math.random(),\n            Math.random() * 2 - 1\n          )\n          .normalize()\n          .multiplyScalar(radius);\n        position[i] = aux.x;\n        position[i + 1] = aux.y;\n        position[i + 2] = aux.z;\n        const c = 0.2 + Math.random() * 0.5;\n        color[i] = c - Math.random() * 0.1;\n        color[i + 1] = c - Math.random() * 0.1;\n        color[i + 2] = c - Math.random() * 0.1;\n      }\n      Starfield.geometry = new BufferGeometry();\n      Starfield.geometry.addAttribute('position', new BufferAttribute(position, 3));\n      Starfield.geometry.addAttribute('color', new BufferAttribute(color, 3));\n    }\n    if (!Starfield.material) {\n      Starfield.material = new PointsMaterial({\n        fog: false,\n        vertexColors: VertexColors,\n      });\n    }\n  }\n}\n\nexport default Starfield;\n","import {\n  CanvasTexture,\n  Mesh,\n  MeshBasicMaterial,\n  PlaneBufferGeometry,\n} from 'three';\nimport Fonts from '@/services/fonts';\n\nclass Title extends Mesh {\n  constructor({ anisotropy }) {\n    const renderer = document.createElement('canvas');\n    renderer.width = 1024;\n    renderer.height = 1024;\n    const texture = new CanvasTexture(renderer);\n    texture.anisotropy = anisotropy;\n    super(\n      new PlaneBufferGeometry(2, 2),\n      new MeshBasicMaterial({\n        map: texture,\n        transparent: true,\n      })\n    );\n    this.lookAt(0, -0.2, 1);\n    this.position.set(0, 2, -3);\n    this.renderer = renderer;\n    this.texture = texture;\n    Fonts\n      .waitUntilLoaded('Roboto')\n      .then(() => (\n        this.draw()\n      ));\n  }\n\n  dispose() {\n    const { geometry, material, texture } = this;\n    geometry.dispose();\n    material.dispose();\n    texture.dispose();\n  }\n\n  draw() {\n    const { renderer, texture } = this;\n    const ctx = renderer.getContext('2d');\n    const grd = ctx.createLinearGradient(0, 0, 0, renderer.height);\n    grd.addColorStop(0, 'rgba(0, 0, 0, 0.3)');\n    grd.addColorStop(1, 'rgba(0, 0, 0, 0)');\n    ctx.fillStyle = grd;\n    ctx.fillRect(0, 0, renderer.width, renderer.height);\n    ctx.font = '700 200px Roboto';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillStyle = '#eee';\n    ctx.shadowColor = 'rgba(255, 255, 0, .5)';\n    ctx.shadowBlur = 50;\n    ctx.fillText(\n      'REALMS',\n      renderer.width * 0.5,\n      renderer.height * 0.2\n    );\n    ctx.font = '70px Roboto';\n    ctx.fillStyle = '#999';\n    ctx.shadowBlur = 0;\n    ctx.fillText(\n      'A recursive VR experience',\n      renderer.width * 0.5,\n      renderer.height * 0.5\n    );\n    ctx.font = '50px Roboto';\n    ctx.fillStyle = '#999';\n    ctx.fillText(\n      `v${__VERSION__} - dani@gatunes  2019`,\n      renderer.width * 0.5,\n      renderer.height * 0.8\n    );\n    texture.needsUpdate = true;\n  }\n}\n\nexport default Title;\n","import PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport Touches from 'touches';\nimport {\n  fetchRealms,\n  setFilter,\n  setPage,\n} from '@/actions/lobby';\nimport {\n  create as createRealm,\n} from '@/actions/realm';\nimport { showSessionPopup as signin, signout } from '@/actions/user';\nimport Ground from '@/components/lobby/ground';\nimport Menu from '@/components/lobby/menu';\nimport Starfield from '@/components/lobby/starfield';\nimport Title from '@/components/lobby/title';\nimport Renderer from '@/components/renderer';\n\nclass Lobby extends PureComponent {\n  componentDidMount() {\n    const {\n      filter,\n      hasLoaded,\n      history,\n      isSigningIn,\n      pagination,\n      realms,\n      user,\n      renderer: { current: renderer },\n      createRealm,\n      fetchRealms,\n      setFilter,\n      setPage,\n      signin,\n      signout,\n    } = this.props;\n    // Setup scene\n    const anisotropy = renderer.getMaxAnisotropy();\n    const scene = renderer.resetScene();\n    scene.add(new Ground());\n    scene.add(new Starfield());\n    scene.add(new Title({ anisotropy }));\n    this.menu = new Menu({\n      anisotropy,\n      filter,\n      history,\n      isSigningIn,\n      pagination,\n      realms,\n      user,\n      createRealm,\n      setFilter,\n      setPage,\n      signin,\n      signout,\n    });\n    scene.add(this.menu);\n    this.renderer = renderer;\n    this.scene = scene;\n    scene.onBeforeRender = this.onBeforeRender.bind(this);\n    // Input for non-vr browsers\n    if (!renderer.renderer.vr.enabled) {\n      this.touches = Touches(\n        window,\n        {\n          filtered: true,\n          target: renderer.canvas.current,\n        }\n      )\n        .on('start', this.onPointerDown.bind(this));\n    }\n    if (!hasLoaded) {\n      // Fetch realms\n      fetchRealms();\n    }\n  }\n\n  componentDidUpdate({\n    filter: previousFilter,\n    isSigningIn: wasSigningIn,\n    pagination: previousPagination,\n    realms: previousRealms,\n    user: previousUser,\n  }) {\n    const {\n      filter,\n      isSigningIn,\n      pagination,\n      realms,\n      user,\n      fetchRealms,\n      setFilter,\n    } = this.props;\n    const { menu } = this;\n    const filterHasUpdated = filter !== previousFilter;\n    if (\n      filterHasUpdated\n      || pagination.page !== previousPagination.page\n    ) {\n      // Fetch realms\n      fetchRealms();\n    }\n    if (filterHasUpdated) {\n      // Update filter\n      menu.updateFilter(filter);\n    }\n    if (isSigningIn !== wasSigningIn) {\n      // Update Session\n      menu.updateSession({ isSigningIn });\n    }\n    if (pagination !== previousPagination) {\n      // Update pagination\n      menu.updatePagination(pagination);\n    }\n    if (realms !== previousRealms) {\n      // Update realms\n      menu.updateRealms(realms);\n    }\n    if (user !== previousUser) {\n      // Update Session\n      menu.updateSession({ user });\n      if (!user && filter === 'user') {\n        setFilter('all');\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    const { scene, touches } = this;\n    delete scene.onBeforeRender;\n    if (touches) {\n      touches.disable();\n    }\n  }\n\n  onBeforeRender() {\n    const {\n      menu,\n      renderer: {\n        hands,\n        raycaster,\n      },\n    } = this;\n\n    // Handle controls\n    hands.children.forEach((hand, i) => {\n      const { buttons, pointer } = hand;\n      hand.setupRaycaster(raycaster);\n      const hit = raycaster.intersectObjects(menu.intersects)[0] || false;\n      if (!hit) {\n        pointer.visible = false;\n        menu.setHover({ hand: i });\n        return;\n      }\n      const {\n        distance,\n        object,\n        point,\n      } = hit;\n      // Pointer feedback\n      pointer.scale.z = distance - 0.175;\n      pointer.visible = true;\n      // Menu\n      object.onPointer({\n        hand: i,\n        isDown: buttons.triggerDown,\n        point,\n      });\n    });\n  }\n\n  onPointerDown(e, [x, y]) {\n    // Handle non-vr browsers input\n    const {\n      menu,\n      props: {\n        isSigningIn,\n      },\n      renderer: {\n        camera,\n        raycaster,\n        width,\n        height,\n      },\n    } = this;\n    if (isSigningIn) {\n      return;\n    }\n    raycaster.setFromCamera({\n      x: Math.min(Math.max(0.5 - (x / width), -0.5), 0.5) * -2,\n      y: Math.min(Math.max(0.5 - (y / height), -0.5), 0.5) * 2,\n    }, camera);\n    const hit = raycaster.intersectObjects(menu.intersects)[0] || false;\n    if (!hit) {\n      return;\n    }\n    hit.object.onPointer({\n      hand: 0,\n      isDown: true,\n      point: hit.point,\n    });\n  }\n\n  render() {\n    return null;\n  }\n}\n\nLobby.defaultProps = {\n  user: undefined,\n};\n\nLobby.propTypes = {\n  filter: PropTypes.string.isRequired,\n  hasLoaded: PropTypes.bool.isRequired,\n  // eslint-disable-next-line react/forbid-prop-types\n  history: PropTypes.object.isRequired,\n  isSigningIn: PropTypes.bool.isRequired,\n  pagination: PropTypes.shape({\n    page: PropTypes.number.isRequired,\n    pages: PropTypes.number.isRequired,\n  }).isRequired,\n  realms: PropTypes.arrayOf(PropTypes.shape({\n    name: PropTypes.string.isRequired,\n    slug: PropTypes.string.isRequired,\n  })).isRequired,\n  renderer: PropTypes.shape({\n    current: PropTypes.instanceOf(Renderer),\n  }).isRequired,\n  user: PropTypes.shape({\n    _id: PropTypes.string,\n    name: PropTypes.string,\n  }),\n  createRealm: PropTypes.func.isRequired,\n  fetchRealms: PropTypes.func.isRequired,\n  setFilter: PropTypes.func.isRequired,\n  setPage: PropTypes.func.isRequired,\n  signin: PropTypes.func.isRequired,\n  signout: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    lobby: {\n      filter,\n      hasLoaded,\n      pagination,\n      realms,\n    },\n    user: {\n      isAuth,\n      isSigningIn,\n      profile: user,\n    },\n  }) => ({\n    filter,\n    hasLoaded,\n    isSigningIn,\n    pagination,\n    realms,\n    user: isAuth ? user : undefined,\n  }),\n  {\n    createRealm,\n    fetchRealms,\n    setFilter,\n    setPage,\n    signin,\n    signout,\n  }\n)(Lobby);\n","import * as types from './types';\nimport API from '@/services/api';\n\nexport function fetchRealms() {\n  return (dispatch, getState) => {\n    const { lobby: { filter, pagination: { page } } } = getState();\n    return dispatch({\n      type: types.LOBBY_FETCH_REALMS,\n      payload: API.fetch({\n        endpoint: `realms/${filter === 'user' ? 'user/' : ''}${page}`,\n      }),\n    });\n  };\n}\n\nexport function setFilter(value) {\n  return {\n    type: types.LOBBY_SET_FILTER,\n    payload: { value },\n  };\n}\n\nexport function setPage(value) {\n  return {\n    type: types.LOBBY_SET_PAGE,\n    payload: { value },\n  };\n}\n","import { Color } from 'three';\nimport Panel from '@/components/panel';\nimport Fonts from '@/services/fonts';\n\nclass Picker extends Panel {\n  constructor({ anisotropy, history }) {\n    super({ anisotropy });\n    const { renderer } = this;\n    this.position.set(-0.15, 0.15, 0.075);\n    this.rotation.set(0, Math.PI * 0.5, Math.PI * 0.1, 'ZYX');\n    this.scale.set(0.3, 0.3, 1);\n    this.block = {\n      x: renderer.width * 0.05,\n      y: renderer.height * 0.05,\n      width: renderer.width * 0.75,\n      height: renderer.height * 0.75,\n    };\n    this.strip = {\n      x: renderer.width * 0.85,\n      y: renderer.height * 0.05,\n      width: renderer.width * 0.1,\n      height: renderer.height * 0.75,\n    };\n    this.menu = {\n      x: renderer.width * 0.05,\n      y: renderer.height * 0.85,\n      width: renderer.width * 0.25,\n      height: renderer.height * 0.1,\n    };\n    this.blockColor = new Color();\n    this.color = new Color();\n    this.blockColor.setRGB(1, 0, 0);\n    this.color.copy(this.blockColor);\n    this.history = history;\n    Fonts\n      .waitUntilLoaded('Roboto')\n      .then(() => (\n        this.draw()\n      ));\n  }\n\n  draw() {\n    const {\n      block,\n      blockColor,\n      color,\n      context: ctx,\n      menu,\n      renderer,\n      strip,\n    } = this;\n\n    super.draw();\n\n    {\n      const {\n        x,\n        y,\n        width,\n        height,\n      } = block;\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.fillStyle = `#${blockColor.getHexString()}`;\n      ctx.fillRect(0, 0, width, height);\n\n      const grdWhite = ctx.createLinearGradient(0, 0, width, 0);\n      grdWhite.addColorStop(0, 'rgba(255,255,255,1)');\n      grdWhite.addColorStop(1, 'rgba(255,255,255,0)');\n      ctx.fillStyle = grdWhite;\n      ctx.fillRect(0, 0, width, height);\n\n      const grdBlack = ctx.createLinearGradient(0, 0, 0, height);\n      grdBlack.addColorStop(0, 'rgba(0,0,0,0)');\n      grdBlack.addColorStop(1, 'rgba(0,0,0,1)');\n      ctx.fillStyle = grdBlack;\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n    }\n\n    {\n      const {\n        x,\n        y,\n        width,\n        height,\n      } = strip;\n      ctx.save();\n      ctx.translate(x, y);\n      const grd = ctx.createLinearGradient(0, 0, 0, height);\n      grd.addColorStop(0, 'rgba(255, 0, 0, 1)');\n      grd.addColorStop(0.17, 'rgba(255, 255, 0, 1)');\n      grd.addColorStop(0.34, 'rgba(0, 255, 0, 1)');\n      grd.addColorStop(0.51, 'rgba(0, 255, 255, 1)');\n      grd.addColorStop(0.68, 'rgba(0, 0, 255, 1)');\n      grd.addColorStop(0.85, 'rgba(255, 0, 255, 1)');\n      grd.addColorStop(1, 'rgba(255, 0, 0, 1)');\n      ctx.fillStyle = grd;\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n    }\n\n    ctx.save();\n    ctx.translate(menu.x, menu.y);\n    ctx.fillStyle = '#222';\n    ctx.strokeStyle = '#333';\n    ctx.beginPath();\n    ctx.rect(0, 0, menu.width, menu.height);\n    ctx.fill();\n    ctx.stroke();\n    ctx.fillStyle = '#fff';\n    ctx.font = '700 24px Roboto';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillText(' REALMS', menu.width * 0.5, menu.height * 0.5);\n    ctx.restore();\n\n    {\n      ctx.save();\n      const width = renderer.width * 0.25;\n      const height = renderer.width * 0.1;\n      ctx.translate(renderer.width * 0.375, renderer.height * 0.85);\n      ctx.fillStyle = `#${color.getHexString()}`;\n      ctx.strokeStyle = '#333';\n      ctx.beginPath();\n      ctx.rect(0, 0, width, height);\n      ctx.fill();\n      ctx.stroke();\n      ctx.restore();\n    }\n  }\n\n  onPointer(point) {\n    const {\n      block,\n      blockColor,\n      color,\n      context: ctx,\n      history,\n      menu,\n      pointer,\n      strip,\n    } = this;\n    super.onPointer(point);\n    [block, strip, menu].forEach((object) => {\n      const {\n        x,\n        y,\n        width,\n        height,\n      } = object;\n      if (\n        pointer.x < x\n        || pointer.x > x + width\n        || pointer.y < y\n        || pointer.y > y + height\n      ) {\n        return;\n      }\n      if (object === menu) {\n        history.goBack();\n        return;\n      }\n      const imageData = ctx.getImageData(pointer.x, pointer.y, 1, 1).data;\n      if (object === strip) {\n        blockColor.setRGB(\n          imageData[0] / 0xFF,\n          imageData[1] / 0xFF,\n          imageData[2] / 0xFF\n        );\n      }\n      color.setRGB(\n        imageData[0] / 0xFF,\n        imageData[1] / 0xFF,\n        imageData[2] / 0xFF\n      );\n      this.draw();\n    });\n  }\n}\n\nexport default Picker;\n","import {\n  BufferAttribute,\n  BufferGeometry,\n  Frustum,\n  InstancedBufferAttribute,\n  InstancedBufferGeometry,\n  Matrix4,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  ShaderMaterial,\n  UniformsUtils,\n  ShaderLib,\n  VertexColors,\n  Vector3,\n} from 'three';\n\nclass Voxels extends Object3D {\n  constructor({ instanced = false }) {\n    super();\n    if (instanced) {\n      const { shader } = Voxels;\n      this.geometry = new InstancedBufferGeometry();\n      this.material = new ShaderMaterial({\n        vertexShader: shader.vertex,\n        fragmentShader: shader.fragment,\n        uniforms: shader.uniforms,\n        vertexColors: VertexColors,\n        fog: true,\n      });\n    } else {\n      this.geometry = new BufferGeometry();\n      this.material = new MeshBasicMaterial({\n        vertexColors: VertexColors,\n      });\n    }\n    this.instanced = instanced;\n    this.visible = false;\n\n    this.aux = {\n      frustum: new Frustum(),\n      matrix: new Matrix4(),\n    };\n  }\n\n  dispose() {\n    const { geometry, material } = this;\n    geometry.dispose();\n    material.dispose();\n  }\n\n  resize(size) {\n    const {\n      children,\n      geometry,\n      instanced,\n      material,\n    } = this;\n    while (children.length) {\n      this.remove(children[0]);\n    }\n\n    const radius = 8;\n    this.instances = [];\n    const aux = new Vector3();\n    const origin = new Vector3();\n    for (let z = -radius; z <= radius; z += 1) {\n      for (let y = -radius; y <= radius; y += 1) {\n        for (let x = -radius; x <= radius; x += 1) {\n          const distance = aux.set(x, y, z).distanceTo(origin);\n          if (Math.round(distance) <= radius) {\n            const instance = new Mesh(\n              geometry,\n              material\n            );\n            instance.chunk = { x, y, z };\n            instance.distance = distance;\n            instance.matrixAutoUpdate = false;\n            instance.position.set(x * size, y * size, z * size);\n            instance.updateMatrix();\n            instance.updateMatrixWorld();\n            this.instances.push(instance);\n          }\n        }\n      }\n    }\n    this.instances.sort(({ distance: a }, { distance: b }) => (\n      a - b\n    ));\n    this.intersects = this.instances.filter((instance) => {\n      const { chunk: { x, y, z } } = instance;\n      return (\n        x >= -2 && x <= 2\n        && y >= -2 && y <= 2\n        && z >= -2 && z <= 2\n      );\n    });\n\n    if (instanced) {\n      const mesh = new Mesh(\n        geometry,\n        material\n      );\n      mesh.frustumCulled = false;\n      this.add(mesh);\n      const offset = new Float32Array(this.instances.length * 3);\n      if (geometry.attributes.offset) {\n        geometry.attributes.offset.setArray(offset);\n      } else {\n        geometry.addAttribute('offset', new InstancedBufferAttribute(offset, 3));\n        geometry.attributes.offset.setDynamic(true);\n      }\n      geometry.maxInstancedCount = 0;\n    } else {\n      this.instances.forEach(instance => this.add(instance));\n    }\n  }\n\n  updateFrustum(camera) {\n    const {\n      aux: { frustum, matrix },\n      geometry,\n      instanced,\n      instances,\n    } = this;\n    if (!instanced || !instances) return;\n    matrix.multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse);\n    frustum.setFromMatrix(matrix);\n    const offsets = instances\n      .filter(({ worldSphere }) => worldSphere && frustum.intersectsSphere(worldSphere))\n      .reduce((offsets, { position }) => {\n        offsets.push(\n          position.x,\n          position.y,\n          position.z\n        );\n        return offsets;\n      }, []);\n    geometry.attributes.offset.array.set(offsets);\n    geometry.attributes.offset.needsUpdate = true;\n    geometry.maxInstancedCount = offsets.length / 3;\n  }\n\n  update({\n    index,\n    position,\n    color,\n    normal,\n  }) {\n    const { geometry, instances } = this;\n    if (geometry.attributes.position) {\n      geometry.attributes.position.setArray(position);\n      geometry.attributes.position.needsUpdate = true;\n    } else {\n      geometry.addAttribute('position', new BufferAttribute(position, 3));\n    }\n    if (geometry.attributes.color) {\n      geometry.attributes.color.setArray(color);\n      geometry.attributes.color.needsUpdate = true;\n    } else {\n      geometry.addAttribute('color', new BufferAttribute(color, 3));\n    }\n    if (geometry.attributes.normal) {\n      geometry.attributes.normal.setArray(normal);\n      geometry.attributes.normal.needsUpdate = true;\n    } else {\n      geometry.addAttribute('normal', new BufferAttribute(normal, 3));\n    }\n    if (geometry.index) {\n      geometry.index.setArray(index);\n      geometry.index.needsUpdate = true;\n    } else {\n      geometry.setIndex(new BufferAttribute(index, 1));\n    }\n    geometry.computeBoundingSphere();\n    instances.forEach((instance) => {\n      instance.worldSphere = geometry.boundingSphere\n        .clone()\n        .applyMatrix4(instance.matrixWorld);\n    });\n    this.visible = true;\n  }\n}\n\nVoxels.shader = {\n  vertex: (\n    ShaderLib.basic.vertexShader\n      .replace(\n        '#include <clipping_planes_pars_vertex>',\n        [\n          '#include <clipping_planes_pars_vertex>',\n          'attribute vec3 offset;',\n        ].join('\\n')\n      )\n      .replace(\n        '#include <begin_vertex>',\n        [\n          'vec3 transformed = vec3( offset + position );',\n        ].join('\\n')\n      )\n  ),\n  fragment: ShaderLib.basic.fragmentShader,\n  uniforms: UniformsUtils.clone(ShaderLib.basic.uniforms),\n};\n\nexport default Voxels;\n","import PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { Vector3 } from 'three';\nimport { fetch, reset, updateVoxels } from '@/actions/realm';\nimport Renderer from '@/components/renderer';\nimport Picker from '@/components/realm/picker';\nimport Voxels from '@/components/realm/voxels';\n\nclass Realm extends PureComponent {\n  componentDidMount() {\n    const {\n      match: { params: { slug } },\n      history,\n      renderer: { current: renderer },\n      fetch,\n    } = this.props;\n    // Setup scene\n    const scene = renderer.resetScene();\n    this.picker = new Picker({\n      anisotropy: renderer.getMaxAnisotropy(),\n      history,\n    });\n    renderer.hands.children[1].add(this.picker);\n    this.voxels = new Voxels({\n      instanced: !!renderer.renderer.extensions.get('ANGLE_instanced_arrays'),\n    });\n    scene.add(this.voxels);\n    this.head = new Vector3();\n    this.intersects = [this.picker];\n    this.renderer = renderer;\n    this.scene = scene;\n    scene.onBeforeRender = this.onBeforeRender.bind(this);\n    // Fetch realm\n    fetch(slug);\n  }\n\n  componentDidUpdate({ geometry: previousGeometry, size: previousSize }) {\n    const { geometry, size } = this.props;\n    const {\n      renderer: { raycaster, room, renderer: { vr } },\n      picker,\n      voxels,\n    } = this;\n    if (size !== previousSize) {\n      // Resize voxels\n      room.position.set(\n        size * 0.5,\n        size * 0.5,\n        size * 0.5\n      );\n      voxels.resize(size);\n      this.intersects = [\n        picker,\n        ...voxels.intersects,\n      ];\n    }\n    if (geometry !== previousGeometry) {\n      // Update voxels\n      voxels.update(geometry);\n      if (!previousGeometry.index && vr.enabled) {\n        // Pull the player down to the nearest voxel\n        raycaster.ray.origin.copy(room.position);\n        raycaster.ray.direction.set(0, -1, 0);\n        const hit = raycaster.intersectObjects(voxels.intersects)[0];\n        if (hit) {\n          room.position.y = hit.point.y;\n        }\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    const { picker, renderer, scene } = this;\n    const { reset } = this.props;\n    renderer.hands.children[1].remove(picker);\n    picker.dispose();\n    delete scene.onBeforeRender;\n    reset();\n    if (!renderer.renderer.vr.enabled) {\n      renderer.resetCamera();\n    }\n  }\n\n  onBeforeRender(renderer, scene, camera) {\n    const {\n      head,\n      intersects,\n      picker,\n      props: {\n        size,\n        updateVoxels,\n      },\n      renderer: {\n        hands,\n        raycaster,\n        room,\n      },\n      voxels,\n    } = this;\n\n    voxels.updateFrustum(camera);\n\n    // Handle controls\n    hands.children.forEach((hand) => {\n      const { buttons, pointer } = hand;\n      hand.setupRaycaster(raycaster);\n      const hit = raycaster.intersectObjects(intersects)[0] || false;\n      if (!hit) {\n        pointer.visible = false;\n        return;\n      }\n      const {\n        distance,\n        face: { normal },\n        object,\n        point,\n      } = hit;\n      // Pointer feedback\n      pointer.scale.z = distance - 0.175;\n      pointer.visible = true;\n      // Color picker\n      if (object === picker) {\n        if (buttons.triggerDown) {\n          picker.onPointer(point);\n        }\n        return;\n      }\n      // Translocation\n      if (\n        buttons.padDown\n        && normal.x === 0\n        && normal.y === 1\n        && normal.z === 0\n      ) {\n        head.setFromMatrixPosition(camera.matrixWorld);\n        const offset = {\n          x: head.x - room.position.x,\n          y: 0,\n          z: head.z - room.position.z,\n        };\n        const [x, y, z] = ['x', 'y', 'z'].map((axis) => {\n          let position = point[axis] - offset[axis];\n          while (position < 0) position += size;\n          while (position >= size) position -= size;\n          return position;\n        });\n        room.position.set(x, y, z);\n      }\n      // Voxel update\n      if (\n        buttons.triggerDown\n        || buttons.gripDown\n      ) {\n        updateVoxels({\n          color: picker.color,\n          point,\n          normal,\n          remove: buttons.gripDown,\n        });\n      }\n    });\n\n    // Animation for non-vr browsers\n    const { animation, vr } = renderer;\n    if (!vr.enabled && size && animation.time > 1) {\n      const { delta, time } = animation;\n      const rotation = Math.sin(time * 0.1) * 0.001;\n      camera.rotateY(rotation);\n      camera.rotateX(rotation);\n      camera.translateZ(delta * 0.5);\n      camera.updateMatrixWorld();\n      ['x', 'y', 'z'].forEach((axis) => {\n        if (camera.position[axis] < 0) {\n          camera.position[axis] += size;\n        }\n        if (camera.position[axis] >= size) {\n          camera.position[axis] -= size;\n        }\n      });\n    }\n  }\n\n  render() {\n    return null;\n  }\n}\n\nRealm.propTypes = {\n  match: PropTypes.shape({\n    params: PropTypes.shape({\n      slug: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n  geometry: PropTypes.shape({\n    index: PropTypes.instanceOf(Uint32Array),\n    position: PropTypes.instanceOf(Float32Array),\n    color: PropTypes.instanceOf(Float32Array),\n    normal: PropTypes.instanceOf(Float32Array),\n  }).isRequired,\n  // eslint-disable-next-line react/forbid-prop-types\n  history: PropTypes.object.isRequired,\n  size: PropTypes.number.isRequired,\n  renderer: PropTypes.shape({\n    current: PropTypes.instanceOf(Renderer),\n  }).isRequired,\n  fetch: PropTypes.func.isRequired,\n  reset: PropTypes.func.isRequired,\n  updateVoxels: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    realm: {\n      geometry,\n      size,\n    },\n  }) => ({\n    geometry,\n    size,\n  }),\n  {\n    fetch,\n    reset,\n    updateVoxels,\n  }\n)(Realm);\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { Route, Redirect, Switch } from 'react-router-dom';\nimport Renderer from '@/components/renderer';\nimport Lobby from './lobby';\nimport Realm from './realm';\n\nconst Scenes = ({ renderer }) => (\n  <Switch>\n    {[\n      { path: '/', Component: Lobby },\n      { path: '/:slug', Component: Realm },\n    ].map(({ path, Component }) => (\n      <Route\n        exact\n        key={path}\n        path={path}\n        render={props => (\n          <Component {...props} renderer={renderer} />\n        )}\n      />\n    ))}\n    <Redirect to=\"/\" />\n  </Switch>\n);\n\nScenes.propTypes = {\n  renderer: PropTypes.shape({\n    current: PropTypes.instanceOf(Renderer),\n  }).isRequired,\n};\n\nexport default Scenes;\n","import React, { PureComponent } from 'react';\nimport { hot } from 'react-hot-loader';\nimport LoadingBar from 'react-redux-loading-bar';\nimport styled from 'styled-components';\nimport Github from '@/components/github';\nimport Music from '@/components/music';\nimport Renderer from '@/components/renderer';\nimport Session from '@/components/session';\nimport Scenes from '@/scenes';\n\nconst Wrapper = styled.div`\n  width: 100vw;\n  height: 100vh;\n`;\n\nconst loadingBarStyle = {\n  backgroundColor: '#393',\n  zIndex: 1,\n};\n\nclass Layout extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.renderer = React.createRef();\n  }\n\n  render() {\n    const { renderer } = this;\n    return (\n      <div>\n        <LoadingBar style={loadingBarStyle} />\n        <Wrapper>\n          <Renderer ref={renderer} />\n        </Wrapper>\n        <Scenes renderer={renderer} />\n        <Music />\n        <Github />\n        <Session />\n      </div>\n    );\n  }\n}\n\nexport default hot(module)(Layout);\n","import { createBrowserHistory } from 'history';\nimport React from 'react';\nimport { render } from 'react-dom';\nimport { applyMiddleware, createStore, compose as productionCompose } from 'redux';\nimport promiseMiddleware from 'redux-promise-middleware';\nimport { Provider } from 'react-redux';\nimport { loadingBarMiddleware } from 'react-redux-loading-bar';\nimport { Router } from 'react-router-dom';\nimport thunkMiddleware from 'redux-thunk';\nimport { refreshSession } from '@/actions/user';\nimport syncTranslationWithStore, { load as reloadLocales } from '@/locales';\nimport rootReducer from '@/reducers';\nimport Layout from '@/layout';\n\n// Create Redux Store\nconst devCompose = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__;\nconst compose = !__PRODUCTION__ && devCompose ? devCompose : productionCompose;\nconst store = createStore(\n  rootReducer,\n  {},\n  compose(\n    applyMiddleware(thunkMiddleware, promiseMiddleware, loadingBarMiddleware())\n  )\n);\nsyncTranslationWithStore(store);\n\n// Revive session from localStorage\nif (store.getState().user.isAuth) {\n  store.dispatch(refreshSession());\n}\n\n// Create router history\nconst history = createBrowserHistory({\n  basename: __BASENAME__,\n});\n\n// Support initial hash route from the ghpages-spa-webpack-plugin\nif (window.location.hash) {\n  history.replace(`/${window.location.hash.substr(2)}`);\n}\n\n// Disable contextual menus\nwindow.addEventListener('contextmenu', e => (\n  e.preventDefault()\n), false);\n\n// Render the page\nconst mount = document.getElementById('mount');\nrender(\n  <Provider store={store}>\n    <Router history={history}>\n      <Layout />\n    </Router>\n  </Provider>,\n  mount\n);\n\n// Hot reload locales & reducers\nif (!__PRODUCTION__ && module.hot) {\n  module.hot.accept('@/locales', () => reloadLocales(store));\n  module.hot.accept('@/reducers', () => store.replaceReducer(rootReducer));\n}\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"code/mesher.worker.1c22d4f82f07e694ad4e.js\");\n};"],"sourceRoot":""}