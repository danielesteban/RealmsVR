{"version":3,"sources":["webpack:///./src/scenes/lobby.jsx","webpack:///./src/components/discord.jsx","webpack:///./src/components/camera.js","webpack:///./src/components/hands.js","webpack:///./src/components/renderer.jsx","webpack:///./src/locales/index.js","webpack:///./src/locales/en.js","webpack:///./src/locales/es.js","webpack:///./src/reducers/lobby.js","webpack:///./src/reducers/realm.js","webpack:///./src/reducers/user.js","webpack:///./src/reducers/index.js","webpack:///./src/components/github.jsx","webpack:///./src/components/music.jsx","webpack:///./src/components/session.jsx","webpack:///./src/scenes/index.jsx","webpack:///./src/layout/index.jsx","webpack:///./src/index.jsx","webpack:///./src/actions/user.js","webpack:///./src/components/realm/voxels.js","webpack:///./src/scenes/realm.jsx","webpack:///./src/components/realm/metadata.jsx","webpack:///./src/components/lobby/ground.js","webpack:///./src/actions/lobby.js","webpack:///./src/components/realm/picker.js","webpack:///./src/components/lobby/menu.js","webpack:///./src/components/lobby/starfield.js","webpack:///./src/services/api.js","webpack:///./src/components/popup.jsx","webpack:///./src/services/mesher.worker.js","webpack:///./src/components/panel.js","webpack:///./src/textures/noise.js","webpack:///./src/services/mesher.js","webpack:///./src/actions/realm.js","webpack:///./src/actions/types.js","webpack:///./src/services/fonts.js","webpack:///./src/components/lobby/title.js"],"names":["Lobby","PureComponent","_this$props","this","props","filter","hasLoaded","history","isSigningIn","pagination","realms","user","renderer","current","createRealm","fetchRealms","setFilter","setPage","signin","signout","anisotropy","getMaxAnisotropy","scene","resetScene","add","Ground","Starfield","Title","menu","Menu","onBeforeRender","bind","vr","enabled","touches","Touches","window","filtered","target","canvas","on","onPointerDown","previousFilter","_ref","wasSigningIn","previousPagination","previousRealms","previousUser","_this$props2","isScreenshot","filterHasUpdated","page","updateFilter","updateSession","updatePagination","updateRealms","setImmediate","__SCREENSHOT_READY__","disable","_this$renderer","hands","raycaster","children","forEach","hand","i","buttons","pointer","setupRaycaster","hit","intersectObjects","intersects","visible","setHover","distance","object","point","scale","z","onPointer","isDown","triggerDown","e","_ref3","_slicedToArray","_ref2","x","y","_this$renderer2","camera","width","height","setFromCamera","Math","min","max","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","_components_discord__WEBPACK_IMPORTED_MODULE_11__","defaultProps","undefined","propTypes","PropTypes","string","isRequired","bool","shape","number","pages","arrayOf","name","slug","instanceOf","Renderer","_id","func","connect","_ref4","_ref4$lobby","lobby","_ref4$user","isAuth","profile","react__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","react__WEBPACK_IMPORTED_MODULE_0___default","n","Wrapper","styled","iframe","withConfig","displayName","componentId","Discord","allowtransparency","frameBorder","src","title","Camera","_this","_classCallCheck","_getPrototypeOf","call","rotation","order","aux","direction","Vector3","forward","right","up","worldUp","input","keyboard","Vector2","onBlur","_assertThisInitialized","onKeyboardDown","onKeyboardUp","reset","PerspectiveCamera","set","keyCode","repeat","movements","isLocked","addEventListener","onPointerMovement","onPointerLockClose","_this$input","removeEventListener","dx","dy","delta","_ref5","_this$input2","position","PI_2","PI","_this$aux","getWorldDirection","crossVectors","normalize","addScaledVector","updateMatrixWorld","lookAt","canLock","_canLock","value","pointerlock","available","onPointerLockAttain","destroy","Hands","hands_classCallCheck","mesh","pointerMesh","setup","hands_possibleConstructorReturn","hands_getPrototypeOf","_loop","clone","menuDown","menuUp","grip","gripDown","gripUp","pad","padDown","padUp","trigger","triggerUp","matrixAutoUpdate","Object3D","auxMatrix","Matrix4","matrixWorld","identity","extractRotation","ray","origin","setFromMatrixPosition","applyMatrix4","geometry","BoxGeometry","translate","faces","face","color","offsetHSL","BufferGeometry","fromGeometry","material","MeshBasicMaterial","map","Noise","Mesh","pointerGeometry","setFromPoints","pointerMaterial","LineBasicMaterial","Line","gamepads","navigator","getGamepads","length","gamepad","id","startsWith","pose","updateHand","standingMatrix","fromArray","orientation","quaternion","matrix","compose","premultiply","matrixWorldNeedsUpdate","pressed","renderer_classCallCheck","renderer_getPrototypeOf","React","createRef","onAnimationTick","renderer_assertThisInitialized","onResize","Component","__SCREENSHOT__","clock","Clock","fog","FogExp2","Raycaster","WebGLRenderer","antialias","powerPreference","stencil","setPixelRatio","devicePixelRatio","setAnimationLoop","room","setupVR","stats","begin","animation","getDelta","time","oldTime","update","render","end","_canvas$parentNode$ge","parentNode","getBoundingClientRect","isPresenting","setSize","aspect","updateProjectionMatrix","capabilities","setHex","setClearColor","hasWebXR","hasWebVR","enterVR","display","getDevice","requestSession","immersive","exclusive","then","session","setSession","frameOfReferenceType","xr","requestDevice","setDevice","requestPresent","source","domElement","getVRDisplays","displays","getStandingMatrix","child","dispose","setFog","Scene","react_default","ref","ShaderChunk","fog_vertex","replace","locales","en","Realm","editMetadata","save","User","confirmPassword","email","signIn","signInWithGoogle","signOut","password","register","es","availableLocales","Object","keys","translations","locale","merge","lobbyReducer","combineReducers","state","arguments","action","type","types","payload","_objectSpread","realmReducer","isCreator","isEditingMetadata","size","voxels","Uint32Array","storedSession","JSON","parse","localStorage","getItem","API","setAuthorization","token","userReducer","user_objectSpread","firstName","split","setItem","stringify","removeItem","rootReducer","i18n","loadingBar","realm","Link","GitHub","href","rel","xmlns","viewBox","fill","d","className","div","Progress","Controls","MAX_UINT32","pow","getRandomValue","ceiling","floor","crypto","getRandomValues","random","Music","next","toggle","tracks","music_toConsumableArray","index","temp","player","document","ontimeupdate","onTimeUpdate","onended","volume","isPlaying","playhead","track","waitForFirstInteraction","currentTime","sec","setState","duration","concat","_this2","first","play","paused","pause","_this3","clientId","fetch","res","status","Error","json","userOnTitle","username","indexOf","substr","stream_url","_this$state","artwork","artwork_url","link","permalink_url","_track$user","userlink","waveform","waveform_url","alt","style","onClick","ti","Tabs","Content","Form","form","Session","session_classCallCheck","session_getPrototypeOf","onLoginSubmit","session_assertThisInitialized","onRegisterSubmit","tab","preventDefault","login","hide","loginWithGoogle","tabs","react_redux_i18n_build","popup","heading","isShowing","onSubmit","required","Scenes","react_router","path","exact","key","_extends","to","store","storedLocale","browserLocale","loadingBarStyle","backgroundColor","zIndex","Layout","layout_classCallCheck","layout_possibleConstructorReturn","layout_getPrototypeOf","build_default","layout_Wrapper","components_renderer","scenes","music","github","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","productionCompose","createStore","applyMiddleware","thunkMiddleware","promiseMiddleware","loadingBarMiddleware","languages","language","browserLanguage","userLanguage","toLowerCase","syncTranslationWithStore","dispatch","loadTranslations","load","setLocale","getState","refreshSession","createBrowserHistory","basename","__BASENAME__","location","hash","mount","getElementById","react_redux_es","layout","__webpack_exports__","hideSessionPopup","showSessionPopup","_types__WEBPACK_IMPORTED_MODULE_1__","_services_api__WEBPACK_IMPORTED_MODULE_2__","body","endpoint","method","left","screen","w","top","h","win","open","baseURL","watcher","setInterval","postMessage","clearInterval","onMessage","data","Voxels","_ref$instanced","instanced","_possibleConstructorReturn","shader","InstancedBufferGeometry","ShaderMaterial","defines","vertexShader","vertex","fragmentShader","fragment","uniforms","UniformsUtils","vertexColors","VertexColors","frustum","Frustum","remove","instances","distanceTo","round","instance","chunk","updateMatrix","push","sort","_instance$chunk","frustumCulled","offset","Float32Array","attributes","setArray","addAttribute","InstancedBufferAttribute","setDynamic","maxInstancedCount","multiplyMatrices","projectionMatrix","matrixWorldInverse","setFromMatrix","offsets","worldSphere","intersectsSphere","reduce","array","needsUpdate","_ref6","normal","uv","BufferAttribute","setIndex","computeBoundingSphere","boundingSphere","ShaderLib","basic","join","USE_MAP","match","params","updateFog","picker","Picker","extensions","get","head","previousGeometry","previousFog","previousSize","resize","_toConsumableArray","copy","_this$props3","updateVoxels","updateFrustum","_map2","axis","colors","fg","_renderer$animation","sin","rotateY","rotateX","rotateZ","translateZ","_components_realm_metadata__WEBPACK_IMPORTED_MODULE_5__","_ref2$realm","Toggle","Metadata","show","react_icons_ti__WEBPACK_IMPORTED_MODULE_2__","_components_popup__WEBPACK_IMPORTED_MODULE_6__","react_redux_i18n__WEBPACK_IMPORTED_MODULE_4__","defaultValue","_ref$realm","PlaneGeometry","vertices","p","v","b","c","avg","factor","setRGB","_types__WEBPACK_IMPORTED_MODULE_0__","_services_api__WEBPACK_IMPORTED_MODULE_1__","_getState$lobby","block","strip","modeButton","label","setMode","mode","draw","bg","Color","setHSL","Fonts","waitUntilLoaded","Panel","ctx","context","_get","prototype","fillStyle","getHexString","fillRect","grdWhite","createLinearGradient","addColorStop","grdBlack","restore","grd","strokeStyle","beginPath","rect","stroke","font","textAlign","textBaseline","fillText","imageData","getImageData","getHex","Pillar","CylinderGeometry","creator","vignette","createRadialGradient","hasLoadedFont","image","Image","crossOrigin","onload","screenshot","isHover","drawImage","ButtonsPanel","isActive","isDisabled","CreateRealm","_ref7","_this3$renderer","_ref8","Pagination","_ref9","_this4","_this4$renderer","_ref10","_this5","_this6","_ref11","userPhoto","Filter","_ref12","_this7","_this7$renderer","_ref13","findIndex","_ref14","button","_ref15","_this8","hover","addPanel","panel","pillar","_ref16","_ref17","_this9","showCreateRealm","_ref18","_ref19","Points","count","multiplyScalar","PointsMaterial","__API__","_ref$headers","headers","_ref$method","authorization","Authorization","FormData","arrayBuffer","prop_types__WEBPACK_IMPORTED_MODULE_0__","prop_types__WEBPACK_IMPORTED_MODULE_0___default","react__WEBPACK_IMPORTED_MODULE_1__","styled_components__WEBPACK_IMPORTED_MODULE_3__","Overlay","Heading","Popup","node","module","exports","Worker","_ref$width","_ref$height","backplate","texture","CanvasTexture","getContext","splice","side","DoubleSide","PlaneBufferGeometry","worldToLocal","pixels","light","putImageData","magFilter","NearestFilter","minFilter","wrapS","RepeatWrapping","wrapT","mesher","Mesher","promiseId","promises","worker","onmessage","Promise","resolve","_ref2$data","create","generateGeometry","generate","hideMetadataPopup","showMetadataPopup","_getState$realm","updateMetadata","_getState3$realm","randomized","r","g","append","Blob","buffer","LOBBY_FETCH_REALMS","LOBBY_FETCH_REALMS_FULFILLED","LOBBY_SET_FILTER","LOBBY_SET_PAGE","REALM_CREATE","REALM_CREATE_FULFILLED","REALM_FETCH","REALM_FETCH_FULFILLED","REALM_HIDE_METADATA_POPUP","REALM_RESET","REALM_SHOW_METADATA_POPUP","REALM_UPDATE_FOG","REALM_UPDATE_GEOMETRY","REALM_UPDATE_GEOMETRY_FULFILLED","REALM_UPDATE_METADATA","REALM_UPDATE_METADATA_FULFILLED","REALM_UPDATE_VOXELS","USER_HIDE_SESSION_POPUP","USER_REFRESH_SESSION","USER_REFRESH_SESSION_FULFILLED","USER_REFRESH_SESSION_REJECTED","USER_SHOW_SESSION_POPUP","USER_LOGIN","USER_LOGIN_FULFILLED","USER_REGISTER","USER_REGISTER_FULFILLED","USER_SIGNOUT","loaded","fonts","Array","isArray","all","check","setTimeout","transparent","l","arc","subdivision","radius","__VERSION__"],"mappings":"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","file":"code/main.ba7b24187ae51631855b.js","sourcesContent":["import PropTypes from 'prop-types';\nimport React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport Touches from 'touches';\nimport {\n  fetchRealms,\n  setFilter,\n  setPage,\n} from '@/actions/lobby';\nimport {\n  create as createRealm,\n} from '@/actions/realm';\nimport { showSessionPopup as signin, signout } from '@/actions/user';\nimport Ground from '@/components/lobby/ground';\nimport Menu from '@/components/lobby/menu';\nimport Starfield from '@/components/lobby/starfield';\nimport Title from '@/components/lobby/title';\nimport Discord from '@/components/discord';\nimport Renderer from '@/components/renderer';\n\nclass Lobby extends PureComponent {\n  componentDidMount() {\n    const {\n      filter,\n      hasLoaded,\n      history,\n      isSigningIn,\n      pagination,\n      realms,\n      user,\n      renderer: { current: renderer },\n      createRealm,\n      fetchRealms,\n      setFilter,\n      setPage,\n      signin,\n      signout,\n    } = this.props;\n    // Setup scene\n    const anisotropy = renderer.getMaxAnisotropy();\n    const scene = renderer.resetScene();\n    scene.add(new Ground());\n    scene.add(new Starfield());\n    scene.add(new Title({ anisotropy }));\n    this.menu = new Menu({\n      anisotropy,\n      filter,\n      history,\n      isSigningIn,\n      pagination,\n      realms,\n      user,\n      createRealm,\n      setFilter,\n      setPage,\n      signin,\n      signout,\n    });\n    scene.add(this.menu);\n    this.renderer = renderer;\n    this.scene = scene;\n    scene.onBeforeRender = this.onBeforeRender.bind(this);\n    // Input for non-vr browsers\n    if (!renderer.renderer.vr.enabled) {\n      this.touches = Touches(window, {\n        filtered: true,\n        target: renderer.canvas.current,\n      })\n        .on('start', this.onPointerDown.bind(this));\n    }\n    if (!hasLoaded) {\n      // Fetch realms\n      fetchRealms();\n    }\n  }\n\n  componentDidUpdate({\n    filter: previousFilter,\n    isSigningIn: wasSigningIn,\n    pagination: previousPagination,\n    realms: previousRealms,\n    user: previousUser,\n  }) {\n    const {\n      filter,\n      isSigningIn,\n      pagination,\n      realms,\n      user,\n      fetchRealms,\n      setFilter,\n    } = this.props;\n    const {\n      menu,\n      renderer: { isScreenshot },\n    } = this;\n    const filterHasUpdated = filter !== previousFilter;\n    if (\n      filterHasUpdated\n      || pagination.page !== previousPagination.page\n    ) {\n      // Fetch realms\n      fetchRealms();\n    }\n    if (filterHasUpdated) {\n      // Update filter\n      menu.updateFilter(filter);\n    }\n    if (isSigningIn !== wasSigningIn) {\n      // Update Session\n      menu.updateSession({ isSigningIn });\n    }\n    if (pagination !== previousPagination) {\n      // Update pagination\n      menu.updatePagination(pagination);\n    }\n    if (realms !== previousRealms) {\n      // Update realms\n      menu.updateRealms(realms);\n      if (isScreenshot) {\n        setImmediate(() => {\n          window.__SCREENSHOT_READY__ = true;\n        });\n      }\n    }\n    if (user !== previousUser) {\n      // Update Session\n      menu.updateSession({ user });\n      if (!user && filter === 'user') {\n        setFilter('popular');\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    const { scene, touches } = this;\n    delete scene.onBeforeRender;\n    if (touches) {\n      touches.disable();\n    }\n  }\n\n  onBeforeRender() {\n    const {\n      menu,\n      renderer: {\n        hands,\n        raycaster,\n      },\n    } = this;\n\n    // Handle controls\n    hands.children.forEach((hand, i) => {\n      const { buttons, pointer } = hand;\n      hand.setupRaycaster(raycaster);\n      const hit = raycaster.intersectObjects(menu.intersects)[0] || false;\n      if (!hit) {\n        pointer.visible = false;\n        menu.setHover({ hand: i });\n        return;\n      }\n      const {\n        distance,\n        object,\n        point,\n      } = hit;\n      // Pointer feedback\n      pointer.scale.z = distance - 0.175;\n      pointer.visible = true;\n      // Menu\n      object.onPointer({\n        hand: i,\n        isDown: buttons.triggerDown,\n        point,\n      });\n    });\n  }\n\n  onPointerDown(e, [x, y]) {\n    // Handle non-vr browsers input\n    const {\n      menu,\n      props: {\n        isSigningIn,\n      },\n      renderer: {\n        camera,\n        raycaster,\n        width,\n        height,\n      },\n    } = this;\n    if (isSigningIn) {\n      return;\n    }\n    raycaster.setFromCamera({\n      x: Math.min(Math.max(0.5 - (x / width), -0.5), 0.5) * -2,\n      y: Math.min(Math.max(0.5 - (y / height), -0.5), 0.5) * 2,\n    }, camera);\n    const hit = raycaster.intersectObjects(menu.intersects)[0] || false;\n    if (!hit) {\n      return;\n    }\n    hit.object.onPointer({\n      hand: 0,\n      isDown: true,\n      point: hit.point,\n    });\n  }\n\n  render() {\n    return <Discord />;\n  }\n}\n\nLobby.defaultProps = {\n  user: undefined,\n};\n\nLobby.propTypes = {\n  filter: PropTypes.string.isRequired,\n  hasLoaded: PropTypes.bool.isRequired,\n  // eslint-disable-next-line react/forbid-prop-types\n  history: PropTypes.object.isRequired,\n  isSigningIn: PropTypes.bool.isRequired,\n  pagination: PropTypes.shape({\n    page: PropTypes.number.isRequired,\n    pages: PropTypes.number.isRequired,\n  }).isRequired,\n  realms: PropTypes.arrayOf(PropTypes.shape({\n    name: PropTypes.string.isRequired,\n    slug: PropTypes.string.isRequired,\n  })).isRequired,\n  renderer: PropTypes.shape({\n    current: PropTypes.instanceOf(Renderer),\n  }).isRequired,\n  user: PropTypes.shape({\n    _id: PropTypes.string,\n    name: PropTypes.string,\n  }),\n  createRealm: PropTypes.func.isRequired,\n  fetchRealms: PropTypes.func.isRequired,\n  setFilter: PropTypes.func.isRequired,\n  setPage: PropTypes.func.isRequired,\n  signin: PropTypes.func.isRequired,\n  signout: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    lobby: {\n      filter,\n      hasLoaded,\n      pagination,\n      realms,\n    },\n    user: {\n      isAuth,\n      isSigningIn,\n      profile: user,\n    },\n  }) => ({\n    filter,\n    hasLoaded,\n    isSigningIn,\n    pagination,\n    realms,\n    user: isAuth ? user : undefined,\n  }),\n  {\n    createRealm,\n    fetchRealms,\n    setFilter,\n    setPage,\n    signin,\n    signout,\n  }\n)(Lobby);\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst Wrapper = styled.iframe`\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  width: 290px;\n  height: 500px;\n`;\n\nconst Discord = () => (\n  <Wrapper\n    allowtransparency\n    frameBorder=\"0\"\n    src=\"https://discordapp.com/widget?id=567407250428264465&theme=dark\"\n    title=\"Discord\"\n  />\n);\n\nexport default Discord;\n","import pointerlock from 'pointer-lock';\nimport {\n  PerspectiveCamera,\n  Vector2,\n  Vector3,\n} from 'three';\n\nclass Camera extends PerspectiveCamera {\n  constructor({ canvas }) {\n    super(70, 1, 0.1, 1024);\n    this.canvas = canvas;\n    this.rotation.order = 'YXZ';\n    this.aux = {\n      direction: new Vector3(),\n      forward: new Vector3(),\n      right: new Vector3(),\n      up: new Vector3(),\n      worldUp: new Vector3(0, 1, 0),\n    };\n    this.input = {\n      keyboard: new Vector3(0, 0, 0),\n      pointer: new Vector2(0, 0),\n    };\n    this.onBlur = this.onBlur.bind(this);\n    this.onKeyboardDown = this.onKeyboardDown.bind(this);\n    this.onKeyboardUp = this.onKeyboardUp.bind(this);\n    this.reset();\n  }\n\n  get canLock() {\n    return this._canLock;\n  }\n\n  set canLock(value) {\n    if (value && !this.pointerlock && pointerlock.available()) {\n      this.pointerlock = pointerlock(this.canvas);\n      this.pointerlock.on('attain', this.onPointerLockAttain.bind(this));\n    }\n    if (!value && this.pointerlock) {\n      this.pointerlock.destroy();\n      delete this.pointerlock;\n    }\n    this._canLock = value;\n  }\n\n  onBlur() {\n    const { input: { keyboard } } = this;\n    keyboard.set(0, 0, 0);\n  }\n\n  onKeyboardDown({ keyCode, repeat }) {\n    const { input: { keyboard } } = this;\n    if (repeat) return;\n    switch (keyCode) {\n      case 65:\n        keyboard.x = -1;\n        break;\n      case 68:\n        keyboard.x = 1;\n        break;\n      case 16:\n        keyboard.y = -1;\n        break;\n      case 32:\n        keyboard.y = 1;\n        break;\n      case 83:\n        keyboard.z = -1;\n        break;\n      case 87:\n        keyboard.z = 1;\n        break;\n      default:\n        break;\n    }\n  }\n\n  onKeyboardUp({ keyCode, repeat }) {\n    const { input: { keyboard } } = this;\n    if (repeat) return;\n    switch (keyCode) {\n      case 65:\n        if (keyboard.x < 0) keyboard.x = 0;\n        break;\n      case 68:\n        if (keyboard.x > 0) keyboard.x = 0;\n        break;\n      case 16:\n        if (keyboard.y < 0) keyboard.y = 0;\n        break;\n      case 32:\n        if (keyboard.y > 0) keyboard.y = 0;\n        break;\n      case 83:\n        if (keyboard.z < 0) keyboard.z = 0;\n        break;\n      case 87:\n        if (keyboard.z > 0) keyboard.z = 0;\n        break;\n      default:\n        break;\n    }\n  }\n\n  onPointerLockAttain(movements) {\n    this.isLocked = true;\n    this.rotation.z = 0;\n    window.addEventListener('blur', this.onBlur, false);\n    window.addEventListener('keydown', this.onKeyboardDown, false);\n    window.addEventListener('keyup', this.onKeyboardUp, false);\n    movements.on('data', this.onPointerMovement.bind(this));\n    movements.on('close', this.onPointerLockClose.bind(this));\n  }\n\n  onPointerLockClose() {\n    const { input: { keyboard, pointer } } = this;\n    window.removeEventListener('blur', this.onBlur);\n    window.removeEventListener('keydown', this.onKeyboardDown);\n    window.removeEventListener('keyup', this.onKeyboardUp);\n    this.isLocked = false;\n    keyboard.set(0, 0, 0);\n    pointer.set(0, 0);\n  }\n\n  onPointerMovement({ dx, dy }) {\n    const { input: { pointer } } = this;\n    pointer.set(dx, dy);\n  }\n\n  onAnimationTick({ delta }) {\n    const {\n      isLocked,\n      input: { keyboard, pointer },\n      rotation,\n      position,\n    } = this;\n    if (!isLocked) {\n      return;\n    }\n    if (pointer.x !== 0 || pointer.y !== 0) {\n      const sensitivity = 0.003;\n      rotation.y -= pointer.x * sensitivity;\n      rotation.x -= pointer.y * sensitivity;\n      const PI_2 = Math.PI / 2;\n      rotation.x = Math.max(-PI_2, Math.min(PI_2, rotation.x));\n      pointer.set(0, 0);\n    }\n    if (keyboard.x !== 0 || keyboard.y !== 0 || keyboard.z !== 0) {\n      const {\n        direction,\n        forward,\n        right,\n        up,\n        worldUp,\n      } = this.aux;\n      this.getWorldDirection(forward);\n      right.crossVectors(forward, worldUp).normalize();\n      up.crossVectors(right, forward).normalize();\n      direction\n        .set(0, 0, 0)\n        .addScaledVector(right, keyboard.x)\n        .addScaledVector(up, keyboard.y)\n        .addScaledVector(forward, keyboard.z)\n        .normalize();\n      position.addScaledVector(direction, 6 * delta);\n      this.updateMatrixWorld();\n    }\n  }\n\n  reset() {\n    const { position, rotation } = this;\n    position.set(0, 1.5, 0.5);\n    rotation.set(0, 0, 0);\n    this.lookAt(0, 1.5, 0.5);\n    this.canLock = false;\n  }\n}\n\nexport default Camera;\n","import {\n  BoxGeometry,\n  BufferGeometry,\n  Line,\n  LineBasicMaterial,\n  Matrix4,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  Vector3,\n} from 'three';\nimport Noise from '@/textures/noise';\n\nclass Hands extends Object3D {\n  constructor() {\n    if (\n      !Hands.mesh\n      || !Hands.pointerMesh\n    ) Hands.setup();\n\n    super();\n    const { mesh, pointerMesh } = Hands;\n    for (let i = 0; i < 2; i += 1) {\n      const hand = mesh.clone();\n      hand.buttons = {\n        menu: false,\n        menuDown: false,\n        menuUp: false,\n        grip: false,\n        gripDown: false,\n        gripUp: false,\n        pad: false,\n        padDown: false,\n        padUp: false,\n        trigger: false,\n        triggerDown: false,\n        triggerUp: false,\n      };\n      hand.pointer = pointerMesh.clone();\n      hand.pointer.visible = false;\n      hand.add(hand.pointer);\n      hand.matrixAutoUpdate = false;\n      hand.setupRaycaster = raycaster => Hands.setupRaycaster({ hand, raycaster });\n      hand.visible = false;\n      this.add(hand);\n    }\n  }\n\n  update() {\n    const { children } = this;\n    const gamepads = ('getGamepads' in navigator ? navigator.getGamepads() : []);\n    children.forEach((hand) => {\n      hand.visible = false;\n    });\n    let hand = 0;\n    for (let i = 0; i < gamepads.length; i += 1) {\n      const gamepad = gamepads[i];\n      if (\n        gamepad\n        && (\n          gamepad.id === 'OpenVR Gamepad'\n          || gamepad.id.startsWith('Oculus Touch')\n          || gamepad.id.startsWith('Spatial Controller')\n        )\n      ) {\n        if (gamepad.pose) {\n          this.updateHand({\n            hand: children[hand],\n            buttons: gamepad.buttons,\n            pose: gamepad.pose,\n          });\n        }\n        hand += 1;\n        if (hand > 1) break;\n      }\n    }\n  }\n\n  updateHand({\n    hand,\n    buttons,\n    pose,\n  }) {\n    const { standingMatrix } = this;\n    if (pose.position !== null) {\n      hand.position.fromArray(pose.position);\n    }\n    if (pose.orientation !== null) {\n      hand.quaternion.fromArray(pose.orientation);\n    }\n    hand.matrix.compose(hand.position, hand.quaternion, hand.scale);\n    hand.matrix.premultiply(standingMatrix);\n    hand.matrixWorldNeedsUpdate = true;\n    hand.visible = true;\n\n    const menu = buttons[3] && buttons[3].pressed;\n    hand.buttons.menuDown = menu && hand.buttons.menu !== menu;\n    hand.buttons.menuUp = !menu && hand.buttons.menu !== menu;\n    hand.buttons.menu = menu;\n    const grip = buttons[2] && buttons[2].pressed;\n    hand.buttons.gripDown = grip && hand.buttons.grip !== grip;\n    hand.buttons.gripUp = !grip && hand.buttons.grip !== grip;\n    hand.buttons.grip = grip;\n    const pad = buttons[0] && buttons[0].pressed;\n    hand.buttons.padDown = pad && hand.buttons.pad !== pad;\n    hand.buttons.padUp = !pad && hand.buttons.pad !== pad;\n    hand.buttons.pad = pad;\n    const trigger = buttons[1] && buttons[1].pressed;\n    hand.buttons.triggerDown = trigger && hand.buttons.trigger !== trigger;\n    hand.buttons.triggerUp = !trigger && hand.buttons.trigger !== trigger;\n    hand.buttons.trigger = trigger;\n  }\n\n  static setupRaycaster({ hand, raycaster }) {\n    if (!hand.auxMatrix) {\n      hand.auxMatrix = new Matrix4();\n    }\n    const { auxMatrix, matrixWorld } = hand;\n    auxMatrix.identity().extractRotation(matrixWorld);\n    raycaster.ray.origin.setFromMatrixPosition(matrixWorld);\n    raycaster.ray.direction.set(0, 0, -1).applyMatrix4(auxMatrix);\n    raycaster.ray.origin.addScaledVector(raycaster.ray.direction, -0.175);\n  }\n\n  static setup() {\n    if (!Hands.geometry) {\n      const geometry = new BoxGeometry(1, 1, 1);\n      geometry.scale(0.05, 0.03, 0.2);\n      geometry.translate(0, 0, 0.075);\n      geometry.faces.forEach((face, i) => {\n        face.color.set(0x777777);\n        if (i >= 10 && i <= 11) {\n          face.color.offsetHSL(0, 0, -0.1);\n        }\n      });\n      Hands.geometry = (new BufferGeometry()).fromGeometry(geometry);\n    }\n    if (!Hands.material) {\n      Hands.material = new MeshBasicMaterial({\n        color: 0xffe0bd,\n        map: Noise,\n      });\n    }\n    if (!Hands.mesh) {\n      Hands.mesh = new Mesh(\n        Hands.geometry,\n        Hands.material\n      );\n    }\n    if (!Hands.pointerGeometry) {\n      Hands.pointerGeometry = (new BufferGeometry())\n        .setFromPoints([new Vector3(0, 0, 0), new Vector3(0, 0, -1)]);\n    }\n    if (!Hands.pointerMaterial) {\n      Hands.pointerMaterial = new LineBasicMaterial({\n        color: 0xffe0bd,\n      });\n    }\n    if (!Hands.pointerMesh) {\n      Hands.pointerMesh = new Line(\n        Hands.pointerGeometry,\n        Hands.pointerMaterial\n      );\n    }\n  }\n}\n\nexport default Hands;\n","import React, { Component } from 'react';\nimport Stats from 'stats.js';\nimport {\n  Clock,\n  FogExp2,\n  Object3D,\n  Raycaster,\n  Scene,\n  ShaderChunk,\n  WebGLRenderer,\n} from 'three';\nimport Camera from './camera';\nimport Hands from './hands';\n\nclass Renderer extends Component {\n  constructor(props) {\n    super(props);\n    this.canvas = React.createRef();\n    this.onAnimationTick = this.onAnimationTick.bind(this);\n    this.onResize = this.onResize.bind(this);\n  }\n\n  componentDidMount() {\n    const { canvas: { current: canvas } } = this;\n    this.isScreenshot = window.__SCREENSHOT__;\n    this.camera = new Camera({ canvas });\n    this.clock = new Clock();\n    this.fog = new FogExp2(0, 0.0125);\n    this.raycaster = new Raycaster();\n    const renderer = new WebGLRenderer({\n      antialias: true,\n      canvas,\n      powerPreference: 'high-performance',\n      stencil: false,\n    });\n    renderer.setPixelRatio(window.devicePixelRatio || 1);\n    renderer.setAnimationLoop(this.onAnimationTick);\n    window.addEventListener('resize', this.onResize, false);\n    this.renderer = renderer;\n    this.room = new Object3D();\n    this.room.add(this.camera);\n    this.hands = new Hands();\n    this.room.add(this.hands);\n    this.resetScene();\n    this.onResize();\n    this.setupVR();\n    if (!__PRODUCTION__ && !this.isScreenshot) {\n      this.stats = new Stats();\n      document.body.appendChild(this.stats.dom);\n    }\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  onAnimationTick() {\n    const {\n      camera,\n      clock,\n      hands,\n      renderer,\n      scene,\n      stats,\n    } = this;\n    if (stats) stats.begin();\n    renderer.animation = {\n      delta: clock.getDelta(),\n      time: clock.oldTime / 1000,\n    };\n    camera.onAnimationTick(renderer.animation);\n    hands.update();\n    renderer.render(scene, camera);\n    if (stats) stats.end();\n  }\n\n  onResize() {\n    const {\n      canvas: { current: canvas },\n      camera,\n      renderer,\n    } = this;\n    const { width, height } = canvas.parentNode.getBoundingClientRect();\n    this.width = width;\n    this.height = height;\n    if (!renderer.vr.isPresenting()) {\n      renderer.setSize(width, height);\n    }\n    camera.aspect = width / height;\n    camera.updateProjectionMatrix();\n  }\n\n  getMaxAnisotropy() {\n    const { renderer } = this;\n    return renderer.capabilities.getMaxAnisotropy();\n  }\n\n  setFog(color) {\n    const { fog, renderer } = this;\n    fog.color.setHex(color);\n    renderer.setClearColor(fog.color);\n  }\n\n  setupVR() {\n    const { hands, renderer } = this;\n    const hasWebXR = 'xr' in navigator;\n    const hasWebVR = 'getVRDisplays' in navigator;\n    if (hasWebXR) {\n      // TODO:\n      // Verify that this actually works\n      const enterVR = () => {\n        if (renderer.vr.isPresenting()) return;\n        const display = renderer.vr.getDevice();\n        if (!display) {\n          navigator.xr.requestDevice().then((display) => {\n            renderer.vr.enabled = true;\n            renderer.vr.setDevice(display);\n          });\n          return;\n        }\n        display\n          .requestSession({ immersive: true, exclusive: true /* DEPRECATED */ })\n          .then((session) => {\n            renderer.vr.setSession(session, { frameOfReferenceType: 'stage' });\n          });\n      };\n      window.addEventListener('mousedown', enterVR, false);\n      enterVR();\n    } else if (hasWebVR) {\n      const enterVR = () => {\n        if (renderer.vr.isPresenting()) return;\n        const display = renderer.vr.getDevice();\n        if (!display) {\n          navigator.getVRDisplays().then((displays) => {\n            if (!displays.length) return;\n            const [display] = displays;\n            renderer.vr.enabled = true;\n            renderer.vr.setDevice(display);\n          });\n          return;\n        }\n        display.requestPresent([{ source: renderer.domElement }]);\n      };\n      window.addEventListener('mousedown', enterVR, false);\n      window.addEventListener('vrdisplayactivate', enterVR, false);\n      enterVR();\n    }\n    hands.standingMatrix = renderer.vr.getStandingMatrix();\n  }\n\n  resetScene() {\n    if (this.scene) {\n      this.scene.children.forEach((child) => {\n        if (child.dispose) child.dispose();\n      });\n    }\n    this.room.position.set(0, 0, 0);\n    this.camera.reset();\n    this.setFog(0x020214);\n    this.scene = new Scene();\n    this.scene.add(this.room);\n    this.scene.fog = this.fog;\n    return this.scene;\n  }\n\n  render() {\n    const { canvas } = this;\n    return (\n      <canvas ref={canvas} />\n    );\n  }\n}\n\n// Tweak ThreeJS Fog\nShaderChunk.fog_vertex = ShaderChunk.fog_vertex.replace(\n  'fogDepth = -mvPosition.z;',\n  'fogDepth = length(mvPosition);'\n);\n\nexport default Renderer;\n","import diff from 'deep-diff';\nimport { recursive as merge } from 'merge';\nimport { loadTranslations, setLocale, syncTranslationWithStore } from 'react-redux-i18n';\nimport en from './en';\nimport es from './es';\n\nconst locales = {\n  en,\n  es,\n};\nconst availableLocales = Object.keys(locales);\nconst defaultLocale = 'en';\n\n// Populate locales with default literals\nconst translations = {};\navailableLocales.forEach((locale) => {\n  translations[locale] = merge(true, locales[defaultLocale], locales[locale]);\n});\n\n// Translations loader handler (for hot-reloading)\nexport const load = (store) => {\n  store.dispatch(loadTranslations(translations));\n};\n\nexport default (store) => {\n  // Locale Autodetection\n  const storedLocale = localStorage.getItem('REALMSVR::LOCALE');\n  const browserLocale = (\n    (window.navigator.languages ? window.navigator.languages[0] : null)\n    || window.navigator.language\n    || window.navigator.browserLanguage\n    || window.navigator.userLanguage\n    || defaultLocale\n  ).substr(0, 2).toLowerCase();\n\n  let locale = defaultLocale;\n  if (~availableLocales.indexOf(storedLocale)) locale = storedLocale;\n  else if (~availableLocales.indexOf(browserLocale)) locale = browserLocale;\n\n  // Setup react-i18nify\n  syncTranslationWithStore(store);\n  load(store);\n  store.dispatch(setLocale(locale));\n\n  if (!__PRODUCTION__) {\n    // Warn about missing translations\n    const missing = availableLocales\n      .reduce((missing, locale) => {\n        if (locale === defaultLocale) {\n          return missing;\n        }\n        const keys = diff(locales[defaultLocale], locales[locale])\n          .reduce((missing, { kind, path }) => {\n            if (kind === 'E') {\n              return missing;\n            }\n            return [\n              ...missing,\n              path.join('.'),\n            ];\n          }, []);\n        if (!keys.length) {\n          return missing;\n        }\n        return [\n          ...missing,\n          `\\nMissing translations for \"${locale.toUpperCase()}\" locale:`,\n          ...keys,\n        ];\n      }, []);\n    if (missing.length) {\n      console.warn(missing.join('\\n'));\n    }\n  }\n};\n","export default {\n  Realm: {\n    editMetadata: 'Edit metadata',\n    name: 'Name',\n    save: 'Save',\n  },\n  User: {\n    confirmPassword: 'Confirm password',\n    email: 'Email',\n    name: 'Name',\n    signIn: 'Sign-In',\n    signInWithGoogle: 'Sign-In with Google',\n    signOut: 'Sign-Out',\n    password: 'Password',\n    register: 'Create an account',\n  },\n};\n","export default {\n  Realm: {\n    editMetadata: 'Editar metadatos',\n    name: 'Nombre',\n    save: 'Guardar',\n  },\n  User: {\n    confirmPassword: 'Confirmar contrasea',\n    email: 'Email',\n    name: 'Nombre',\n    signIn: 'Iniciar sesin',\n    signInWithGoogle: 'Iniciar sesin con Google',\n    signOut: 'Cerrar sesin',\n    password: 'Contrasea',\n    register: 'Crear una cuenta',\n  },\n};\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\n\nconst filter = (\n  state = 'popular',\n  action\n) => {\n  switch (action.type) {\n    case types.LOBBY_SET_FILTER:\n      return action.payload.value;\n    default:\n      return state;\n  }\n};\n\nconst hasLoaded = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.LOBBY_FETCH_REALMS_FULFILLED:\n      return true;\n    case types.REALM_CREATE_FULFILLED:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst pagination = (\n  state = {\n    page: 0,\n    pages: 0,\n  },\n  action\n) => {\n  switch (action.type) {\n    case types.LOBBY_FETCH_REALMS_FULFILLED:\n      return {\n        ...state,\n        pages: action.payload.pages,\n      };\n    case types.LOBBY_SET_FILTER:\n      return {\n        ...state,\n        page: 0,\n      };\n    case types.LOBBY_SET_PAGE:\n      return {\n        ...state,\n        page: action.payload.value,\n      };\n    default:\n      return state;\n  }\n};\n\nconst realms = (\n  state = [],\n  action\n) => {\n  switch (action.type) {\n    case types.LOBBY_FETCH_REALMS_FULFILLED:\n      return action.payload.realms;\n    default:\n      return state;\n  }\n};\n\nconst lobbyReducer = combineReducers({\n  filter,\n  hasLoaded,\n  pagination,\n  realms,\n});\n\nexport default lobbyReducer;\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\n\nconst geometry = (\n  state = {},\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_UPDATE_GEOMETRY_FULFILLED:\n      return action.payload;\n    case types.REALM_RESET:\n      return {};\n    default:\n      return state;\n  }\n};\n\nconst fog = (\n  state = 0x020214,\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n    case types.REALM_UPDATE_FOG:\n      return action.payload.fog;\n    case types.REALM_RESET:\n      return 0x020214;\n    default:\n      return state;\n  }\n};\n\nconst id = (\n  state = '',\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n      return action.payload._id;\n    case types.REALM_RESET:\n      return '';\n    default:\n      return state;\n  }\n};\n\nconst isCreator = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n      return !!action.payload.isCreator;\n    case types.REALM_RESET:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst isEditingMetadata = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_SHOW_METADATA_POPUP:\n      return true;\n    case types.REALM_HIDE_METADATA_POPUP:\n    case types.REALM_RESET:\n    case types.REALM_UPDATE_METADATA_FULFILLED:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst name = (\n  state = '',\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n      return action.payload.name;\n    case types.REALM_RESET:\n      return '';\n    default:\n      return state;\n  }\n};\n\nconst size = (\n  state = 0,\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n      return action.payload.size;\n    case types.REALM_RESET:\n      return 0;\n    default:\n      return state;\n  }\n};\n\nconst voxels = (\n  state = new Uint32Array(),\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n    case types.REALM_UPDATE_VOXELS:\n      return action.payload.voxels;\n    case types.REALM_RESET:\n      return new Uint32Array();\n    default:\n      return state;\n  }\n};\n\nconst realmReducer = combineReducers({\n  geometry,\n  fog,\n  id,\n  isCreator,\n  isEditingMetadata,\n  name,\n  size,\n  voxels,\n});\n\nexport default realmReducer;\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\nimport API from '@/services/api';\n\nconst sessionKey = 'REALMSVR::SESSION';\nconst storedSession = JSON.parse(\n  localStorage.getItem(sessionKey) || 'false'\n);\nif (storedSession) {\n  API.setAuthorization(storedSession.token);\n}\n\nconst isAuth = (\n  state = !!storedSession,\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n    case types.USER_LOGIN_FULFILLED:\n    case types.USER_REGISTER_FULFILLED:\n      return true;\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst isSigningIn = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.USER_SHOW_SESSION_POPUP:\n      return true;\n    case types.USER_LOGIN_FULFILLED:\n    case types.USER_HIDE_SESSION_POPUP:\n    case types.USER_REGISTER_FULFILLED:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst profile = (\n  state = storedSession ? storedSession.profile : {},\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n    case types.USER_LOGIN_FULFILLED:\n    case types.USER_REGISTER_FULFILLED: {\n      const { profile } = action.payload;\n      const { name } = profile;\n      return {\n        ...profile,\n        firstName: name.split(' ')[0],\n      };\n    }\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      return {};\n    default:\n      return state;\n  }\n};\n\nconst token = (\n  state = storedSession ? storedSession.token : {},\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n    case types.USER_LOGIN_FULFILLED:\n    case types.USER_REGISTER_FULFILLED:\n      API.setAuthorization(action.payload.token);\n      localStorage.setItem(sessionKey, JSON.stringify(action.payload));\n      return action.payload.token;\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      API.setAuthorization(false);\n      localStorage.removeItem(sessionKey);\n      return '';\n    default:\n      return state;\n  }\n};\n\nconst userReducer = combineReducers({\n  isAuth,\n  isSigningIn,\n  profile,\n  token,\n});\n\nexport default userReducer;\n","import { combineReducers } from 'redux';\nimport { i18nReducer as i18n } from 'react-redux-i18n';\nimport { loadingBarReducer as loadingBar } from 'react-redux-loading-bar';\nimport lobby from './lobby';\nimport realm from './realm';\nimport user from './user';\n\nconst rootReducer = combineReducers({\n  i18n,\n  loadingBar,\n  lobby,\n  realm,\n  user,\n});\n\nexport default rootReducer;\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst Link = styled.a`\n  position: absolute;\n  top: 0;\n  right: 0;\n  .octo-arm {\n    transform-origin: 130px 106px;\n  }\n  &:hover .octo-arm {\n    animation: octocat-wave 560ms ease-in-out;\n  }\n  @keyframes octocat-wave {\n    0% {\n      transform: rotate(0deg);\n    }\n    20% {\n      transform: rotate(-25deg);\n    }\n    40% {\n      transform: rotate(10deg);\n    }\n    60% {\n      transform: rotate(-25deg);\n    }\n    80% {\n      transform: rotate(10deg);\n    }\n    100% {\n      transform: rotate(0deg);\n    }\n  }\n`;\n\nconst GitHub = () => (\n  <Link\n    href=\"https://github.com/danielesteban/RealmsVR#readme\"\n    rel=\"noopener noreferrer\"\n    target=\"_blank\"\n  >\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"80\"\n      height=\"80\"\n      viewBox=\"0 0 250 250\"\n      fill=\"#fff\"\n    >\n      <path\n        d=\"M0 0l115 115h15l12 27 108 108V0z\"\n        fill=\"#000\"\n      />\n      <path\n        className=\"octo-arm\"\n        d=\"M128 109c-15-9-9-19-9-19 3-7 2-11 2-11-1-7 3-2 3-2 4 5 2 11 2 11-3 10 5 15 9 16\"\n      />\n      <path\n        className=\"octo-body\"\n        d=\"M115 115s4 2 5 0l14-14c3-2 6-3 8-3-8-11-15-24 2-41 5-5 10-7 16-7 1-2 3-7 12-11 0 0 5 3 7 16 4 2 8 5 12 9s7 8 9 12c14 3 17 7 17 7-4 8-9 11-11 11 0 6-2 11-7 16-16 16-30 10-41 2 0 3-1 7-5 11l-12 11c-1 1 1 5 1 5z\"\n      />\n    </svg>\n  </Link>\n);\n\nexport default GitHub;\n","import React, { PureComponent } from 'react';\nimport {\n  TiMediaFastForward,\n  TiMediaPause,\n  TiMediaPlay,\n} from 'react-icons/ti';\nimport styled from 'styled-components';\n\nconst Wrapper = styled.div`\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  display: flex;\n  align-items: flex-end;\n  box-shadow: 0 0 8px rgba(0, 0, 0, .4);\n  > a > img {\n    width: 100px;\n    height: 100px;\n    background: #000;\n    border: 0;\n    outline: none;\n    vertical-align: middle;\n  }\n  > div {\n    box-sizing: border-box;\n    width: 220px;\n    height: 100px;\n    background: rgba(0, 0, 0, .5);\n    padding: 0.5rem 1rem;\n    border-radius: 0 4px 0 0;\n    > a {\n      display: block;\n      text-decoration: none;\n      outline: none;\n      font-size: 1.25em;\n      line-height: 1.5em;\n      white-space: nowrap;\n      text-overflow: ellipsis;\n      overflow: hidden;\n      &:hover {\n        text-decoration: underline;\n      }\n    }\n    > a:nth-child(1) {\n      color: #eee;\n    }\n    > a:nth-child(2) {\n      color: #aaa;\n    }\n  }\n`;\n\nconst Progress = styled.div`\n  height: 3px;\n  margin: 0.5rem 0;\n  background-color: #333;\n  border-radius: 2px;\n  overflow: hidden;\n  > div {\n    height: 100%;\n    background-color: #393;\n  }\n`;\n\nconst Controls = styled.div`\n  display: flex;\n  align-items: center;\n  > button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: #333;\n    border: 1px solid #111;\n    color: #fff;\n    font-family: inherit;\n    font-size: inherit;\n    font-weight: inherit;\n    padding: 0.25rem 0;\n    width: 2.5rem;\n    border-radius: 2px;\n    margin-right: 0.125rem;\n    cursor: pointer;\n    outline: none;\n  }\n  > span {\n    margin-left: auto;\n  }\n`;\n\nconst MAX_UINT32 = (2 ** 32) - 1;\nconst aux = new Uint32Array(1);\nconst getRandomValue = ceiling => Math.floor(\n  (\n    window.crypto && window.crypto.getRandomValues ? (\n      window.crypto.getRandomValues(aux)[0] / MAX_UINT32\n    ) : (\n      Math.random()\n    )\n  )\n  * ceiling\n);\n\nclass Music extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.next = this.next.bind(this);\n    this.toggle = this.toggle.bind(this);\n    // Shuffle tracks\n    const tracks = [...Music.tracks];\n    for (let index = tracks.length - 1; index >= 0; index -= 1) {\n      const random = getRandomValue(index + 1);\n      const temp = tracks[index];\n      tracks[index] = tracks[random];\n      tracks[random] = temp;\n    }\n    // Initialize state\n    this.player = document.createElement('audio');\n    this.player.ontimeupdate = this.onTimeUpdate.bind(this);\n    this.player.onended = this.next;\n    this.player.volume = 0.5;\n    this.state = {\n      isPlaying: false,\n      playhead: 0,\n      time: '0:00',\n      track: undefined,\n    };\n    this.track = 0;\n    this.tracks = tracks;\n  }\n\n  componentDidMount() {\n    this.waitForFirstInteraction();\n  }\n\n  onTimeUpdate() {\n    const { player } = this;\n    const min = Math.floor(player.currentTime / 60);\n    const sec = Math.floor(player.currentTime % 60);\n    this.setState({\n      playhead: player.currentTime / player.duration,\n      time: `${min}:${sec < 10 ? '0' : ''}${sec}`,\n    });\n  }\n\n  waitForFirstInteraction() {\n    const first = () => {\n      window.removeEventListener('mousedown', first);\n      window.removeEventListener('touchstart', first);\n      window.removeEventListener('vrdisplayactivate', first);\n      this.play();\n    };\n    window.addEventListener('mousedown', first, false);\n    window.addEventListener('touchstart', first, false);\n    window.addEventListener('vrdisplayactivate', first, false);\n  }\n\n  next() {\n    const { player, tracks } = this;\n    // Stop current player\n    if (!player.paused) {\n      player.pause();\n    }\n    player.src = '';\n    // Loop through the track list\n    this.track = (this.track + 1) % tracks.length;\n    this.play();\n  }\n\n  play() {\n    const {\n      player,\n      track,\n      tracks,\n    } = this;\n    // Fetch the current track\n    const clientId = 'client_id=eb5fcff9e107aab508431b4c3c416415';\n    const id = tracks[track];\n    if (!__PRODUCTION__) {\n      console.log(`playing: ${id}`);\n    }\n    fetch(`https://api.soundcloud.com/tracks/${id}?format=json&${clientId}`)\n      .then((res) => {\n        if (res.status !== 200) {\n          throw new Error(`Couldn't fetch track: ${id}`);\n        }\n        return res.json();\n      })\n      .then((track) => {\n        // Cleanup track title\n        const userOnTitle = `${track.user.username} - `;\n        if (track.title.indexOf(userOnTitle) === 0) {\n          track.title = track.title.substr(userOnTitle.length);\n        }\n        // Play the track\n        player.src = `${track.stream_url}?${clientId}`;\n        player.play();\n        this.setState({\n          isPlaying: true,\n          playhead: 0,\n          time: '0:00',\n          track,\n        });\n      })\n      .catch(() => (\n        this.next()\n      ));\n  }\n\n  toggle() {\n    const { player } = this;\n    if (player.paused) {\n      player.play();\n    } else {\n      player.pause();\n    }\n    this.setState({ isPlaying: !player.paused });\n  }\n\n  render() {\n    const {\n      isPlaying,\n      playhead,\n      time,\n      track,\n    } = this.state;\n    if (!track) {\n      return null;\n    }\n    const {\n      title,\n      artwork_url: artwork,\n      permalink_url: link,\n      user: { username, permalink_url: userlink },\n      waveform_url: waveform,\n    } = track;\n    return (\n      <Wrapper>\n        <a\n          href={link}\n          rel=\"noopener noreferrer\"\n          target=\"_blank\"\n        >\n          <img alt={title} src={artwork || waveform} />\n        </a>\n        <div>\n          <a\n            href={link}\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            {title}\n          </a>\n          <a\n            href={userlink}\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            {username}\n          </a>\n          <Progress>\n            <div style={{ width: `${playhead * 100}%` }} />\n          </Progress>\n          <Controls>\n            <button\n              type=\"button\"\n              onClick={this.toggle}\n            >\n              {isPlaying ? <TiMediaPause /> : <TiMediaPlay />}\n            </button>\n            <button\n              type=\"button\"\n              onClick={this.next}\n            >\n              <TiMediaFastForward />\n            </button>\n            <span>\n              { time }\n            </span>\n          </Controls>\n        </div>\n      </Wrapper>\n    );\n  }\n}\n\n/* eslint-disable */\nMusic.tracks = [\n  334831124,3654595,3654647,62965282,55529274,40801532,28921242,58102473,44049414,584470,348172961,348172759,118227213,58103033,58102746,29062473,73664676,217254339,26016069,143994169,34751566,22899851,19645145,14604316,14604145,9747273,290203217,290202627,290203029,290203125,230280393,230280565,230280839,290202890,230280665,230280740,174033188,238809205,219872323,85441920,85442027,85442324,85442658,295429557,31232642,118720768,66345578,64979755,9747680,3654444,354826097,174209343,374346584,374346578,374346566,374346536,374346518,374346506,374346440,272272960,82537981,272272962,331110005,253646536,69972925,297108748,95089740,264157290,3654394,51204969,28460870,270165801,93513660,107137565,200476847,241036508,345846433,13728685,3193491,235796705,74366070,293115267,65027631,226460783,132730188,267647225,331743020,348075711,328602395,232135696,13385987,303726380,\n  319470292,312179497,300022056,212600702,336206149,319100206,299965683,308768675,202903037,220992150,221433894,223843476,155626389,155626391,306589305,304501298,305600086,300328640,283863336,283863306,260674048,117308221,78683752,340317786,277352612,226847547,220656015,224154466,240254433,249957904,260419888,250754945,235013168,336784751,277029337,229288316,343272434,343194325,334599482,343032721,343661072,343552665,344563095,285122161,1687603,286269026,340681124,265119655,345756307,351035779,350060806,352308515,353896778,353896991,353896595,355550264,360321368,337715872,272189608,43751468,65190792,200959753,347608134,133531982,183519916,185401372,42227482,376984973,372830927,376671563,376317227,342538038,338288083,338266624,265353084,159115092,122088683,85356706,69351024,18159187,28667337,169274681,221402560,402032439,401604759,416088969,424864200,424881921,426294102,430158741,441378576,440982825,438854664,451627668,285022424,416942091,289481139,236661381,289727425,302903905,284737661,275642447,291943120,284052253,228088399,209533328,90164812,43727131,175757015,\n];\n/* eslint-enable */\n\nexport default Music;\n","import PropTypes from 'prop-types';\nimport React, { PureComponent } from 'react';\nimport {\n  TiKey,\n  TiSocialGooglePlusCircular,\n} from 'react-icons/ti';\nimport { connect } from 'react-redux';\nimport { Translate } from 'react-redux-i18n';\nimport styled from 'styled-components';\nimport Popup from '@/components/popup';\nimport {\n  hideSessionPopup as hide,\n  login,\n  loginWithGoogle,\n  register,\n} from '@/actions/user';\n\nconst Tabs = styled.div`\n  display: flex;\n  height: 100%;\n  > a {\n    display: flex;\n    align-items: center;\n    background: #222;\n    padding: 0 1rem;\n    border-left: 1px solid #333;\n    cursor: pointer;\n    &:first-child {\n      border-left: none;\n    }\n    &.active {\n      background: #444;\n      cursor: default;\n    }\n  }\n`;\n\nconst Content = styled.div`\n  .google {\n    display: flex;\n    justify-content: center;\n  }\n  .or {\n    position: relative;\n    width: 100%;\n    border-top: 1px solid #222;\n    margin: 2rem 0;\n    > span {\n      position: absolute;\n      display: block;\n      left: 50%;\n      transform: translate(-50%, -50%);\n    }\n  }\n  button {\n    display: flex;\n    align-items: center;\n    border: 1px solid #555;\n    background: #222;\n    padding: 0.5rem 1rem;\n    margin: 0;\n    font-family: inherit;\n    font-weight: 700;\n    font-size: 1.2rem;\n    color: inherit;\n    cursor: pointer;\n    outline: 0;\n    > svg {\n      font-size: 1.5em;\n      margin-right: 0.5rem;\n    }\n  }\n`;\n\nconst Form = styled.form`\n  display: none;\n  flex-direction: column;\n  align-items: center;\n  width: 80%;\n  &.active {\n    display: flex;\n  }\n  > label {\n    width: 100%;\n    padding: 0;\n  }\n  > input {\n    box-sizing: border-box;\n    border: 1px solid #333;\n    width: 100%;\n    background: #222;\n    color: inherit;\n    font-family: inherit;\n    font-weight: 400;\n    font-size: 2em;\n    padding: 0.5rem;\n    margin: 0 0 1rem;\n  }\n`;\n\nclass Session extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.onLoginSubmit = this.onLoginSubmit.bind(this);\n    this.onRegisterSubmit = this.onRegisterSubmit.bind(this);\n    this.state = { tab: 'login' };\n  }\n\n  componentWillReceiveProps({ isSigningIn }) {\n    const { isSigningIn: wasSigningIn } = this.props;\n    if (isSigningIn && !wasSigningIn) {\n      this.setState({ tab: 'login' });\n    }\n  }\n\n  onLoginSubmit(e) {\n    e.preventDefault();\n    const { target: form } = e;\n    const { login } = this.props;\n    login({\n      email: form.email.value,\n      password: form.password.value,\n    });\n  }\n\n  onRegisterSubmit(e) {\n    e.preventDefault();\n    const { target: form } = e;\n    const { register } = this.props;\n    if (form.password.value !== form.confirmPassword.value) {\n      return;\n    }\n    register({\n      email: form.email.value,\n      name: form.name.value,\n      password: form.password.value,\n    });\n  }\n\n  render() {\n    const {\n      isSigningIn,\n      hide,\n      loginWithGoogle,\n    } = this.props;\n    const { tab } = this.state;\n    const tabs = (\n      <Tabs>\n        <a\n          className={tab === 'login' ? 'active' : null}\n          onClick={() => this.setState({ tab: 'login' })}\n        >\n          <Translate value=\"User.signIn\" />\n        </a>\n        <a\n          className={tab === 'register' ? 'active' : null}\n          onClick={() => this.setState({ tab: 'register' })}\n        >\n          <Translate value=\"User.register\" />\n        </a>\n      </Tabs>\n    );\n    return (\n      <Popup\n        heading={tabs}\n        isShowing={isSigningIn}\n        hide={hide}\n      >\n        <Content>\n          <Form\n            className={tab === 'login' ? 'active' : null}\n            onSubmit={this.onLoginSubmit}\n          >\n            <label><Translate value=\"User.email\" /></label>\n            <input type=\"email\" name=\"email\" required />\n            <label><Translate value=\"User.password\" /></label>\n            <input type=\"password\" name=\"password\" required />\n            <button\n              type=\"submit\"\n            >\n              <TiKey />\n              <Translate value=\"User.signIn\" />\n            </button>\n          </Form>\n          <Form\n            className={tab === 'register' ? 'active' : null}\n            onSubmit={this.onRegisterSubmit}\n          >\n            <label><Translate value=\"User.name\" /></label>\n            <input type=\"text\" name=\"name\" required />\n            <label><Translate value=\"User.email\" /></label>\n            <input type=\"email\" name=\"email\" required />\n            <label><Translate value=\"User.password\" /></label>\n            <input type=\"password\" name=\"password\" required />\n            <label><Translate value=\"User.confirmPassword\" /></label>\n            <input type=\"password\" name=\"confirmPassword\" required />\n            <button\n              type=\"submit\"\n            >\n              <TiKey />\n              <Translate value=\"User.register\" />\n            </button>\n          </Form>\n          <div className=\"or\">\n            <Translate value=\"User.or\" />\n          </div>\n          <div className=\"google\">\n            <button\n              onClick={loginWithGoogle}\n              type=\"button\"\n            >\n              <TiSocialGooglePlusCircular />\n              <Translate value=\"User.signInWithGoogle\" />\n            </button>\n          </div>\n        </Content>\n      </Popup>\n    );\n  }\n}\n\nSession.propTypes = {\n  isSigningIn: PropTypes.bool.isRequired,\n  hide: PropTypes.func.isRequired,\n  login: PropTypes.func.isRequired,\n  loginWithGoogle: PropTypes.func.isRequired,\n  register: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    user: {\n      isSigningIn,\n    },\n  }) => ({\n    isSigningIn,\n  }),\n  {\n    hide,\n    login,\n    loginWithGoogle,\n    register,\n  }\n)(Session);\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { Route, Redirect, Switch } from 'react-router-dom';\nimport Renderer from '@/components/renderer';\nimport Lobby from './lobby';\nimport Realm from './realm';\n\nconst Scenes = ({ renderer }) => (\n  <Switch>\n    {[\n      { path: '/', Component: Lobby },\n      { path: '/:slug', Component: Realm },\n    ].map(({ path, Component }) => (\n      <Route\n        exact\n        key={path}\n        path={path}\n        render={props => (\n          <Component {...props} renderer={renderer} />\n        )}\n      />\n    ))}\n    <Redirect to=\"/\" />\n  </Switch>\n);\n\nScenes.propTypes = {\n  renderer: PropTypes.shape({\n    current: PropTypes.instanceOf(Renderer),\n  }).isRequired,\n};\n\nexport default Scenes;\n","import React, { PureComponent } from 'react';\nimport { hot } from 'react-hot-loader';\nimport LoadingBar from 'react-redux-loading-bar';\nimport styled from 'styled-components';\nimport Github from '@/components/github';\nimport Music from '@/components/music';\nimport Renderer from '@/components/renderer';\nimport Session from '@/components/session';\nimport Scenes from '@/scenes';\n\nconst Wrapper = styled.div`\n  width: 100vw;\n  height: 100vh;\n`;\n\nconst loadingBarStyle = {\n  backgroundColor: '#393',\n  zIndex: 1,\n};\n\nclass Layout extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.renderer = React.createRef();\n  }\n\n  render() {\n    const { renderer } = this;\n    const isScreenshot = window.__SCREENSHOT__;\n    return (\n      <div>\n        <LoadingBar style={loadingBarStyle} />\n        <Wrapper>\n          <Renderer ref={renderer} />\n        </Wrapper>\n        <Scenes renderer={renderer} />\n        <Music />\n        {!isScreenshot ? <Github /> : null}\n        <Session />\n      </div>\n    );\n  }\n}\n\nexport default hot(module)(Layout);\n","import { createBrowserHistory } from 'history';\nimport React from 'react';\nimport { render } from 'react-dom';\nimport { applyMiddleware, createStore, compose as productionCompose } from 'redux';\nimport promiseMiddleware from 'redux-promise-middleware';\nimport { Provider } from 'react-redux';\nimport { loadingBarMiddleware } from 'react-redux-loading-bar';\nimport { Router } from 'react-router-dom';\nimport thunkMiddleware from 'redux-thunk';\nimport { refreshSession } from '@/actions/user';\nimport syncTranslationWithStore, { load as reloadLocales } from '@/locales';\nimport rootReducer from '@/reducers';\nimport Layout from '@/layout';\n\n// Create Redux Store\nconst devCompose = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__;\nconst compose = !__PRODUCTION__ && devCompose ? devCompose : productionCompose;\nconst store = createStore(\n  rootReducer,\n  {},\n  compose(\n    applyMiddleware(thunkMiddleware, promiseMiddleware, loadingBarMiddleware())\n  )\n);\nsyncTranslationWithStore(store);\n\n// Revive session from localStorage\nif (store.getState().user.isAuth) {\n  store.dispatch(refreshSession());\n}\n\n// Create router history\nconst history = createBrowserHistory({\n  basename: __BASENAME__,\n});\n\n// Support initial hash route from the ghpages-spa-webpack-plugin\nif (window.location.hash) {\n  history.replace(`/${window.location.hash.substr(2)}`);\n}\n\n// Disable contextual menus\nwindow.addEventListener('contextmenu', e => (\n  e.preventDefault()\n), false);\n\n// Render the page\nconst mount = document.getElementById('mount');\nrender(\n  <Provider store={store}>\n    <Router history={history}>\n      <Layout />\n    </Router>\n  </Provider>,\n  mount\n);\n\n// Hot reload locales & reducers\nif (!__PRODUCTION__ && module.hot) {\n  module.hot.accept('@/locales', () => reloadLocales(store));\n  module.hot.accept('@/reducers', () => store.replaceReducer(rootReducer));\n}\n","import { setLocale as reduxSetLocale } from 'react-redux-i18n';\nimport * as types from './types';\nimport API from '@/services/api';\n\nexport function hideSessionPopup() {\n  return {\n    type: types.USER_HIDE_SESSION_POPUP,\n  };\n}\n\nexport function register({ email, name, password }) {\n  return dispatch => dispatch({\n    type: types.USER_REGISTER,\n    payload: API.fetch({\n      body: {\n        email,\n        name,\n        password,\n      },\n      endpoint: 'user',\n      method: 'PUT',\n    }),\n  }).catch(() => {});\n}\n\nexport function refreshSession() {\n  return dispatch => dispatch({\n    type: types.USER_REFRESH_SESSION,\n    payload: API.fetch({\n      endpoint: 'user',\n    }),\n  }).catch(() => {});\n}\n\nexport function setLocale(locale) {\n  return (dispatch) => {\n    localStorage.setItem('REALMSVR::LOCALE', locale);\n    dispatch(reduxSetLocale(locale));\n  };\n}\n\nexport function showSessionPopup() {\n  return {\n    type: types.USER_SHOW_SESSION_POPUP,\n  };\n}\n\nexport function login({ email, password }) {\n  return dispatch => dispatch({\n    type: types.USER_LOGIN,\n    payload: API.fetch({\n      body: {\n        email,\n        password,\n      },\n      endpoint: 'user',\n      method: 'POST',\n    }),\n  }).catch(() => {});\n}\n\nexport function loginWithGoogle() {\n  return (dispatch) => {\n    const w = 512;\n    const h = 512;\n    const left = (window.screen.width / 2) - w / 2;\n    const top = (window.screen.height / 2) - h / 2;\n    const win = window.open(\n      `${API.baseURL}user/google`,\n      'loginWithGoogle',\n      `width=${w},height=${h},top=${top},left=${left}`\n    );\n    const watcher = setInterval(() => {\n      if (!win.window) {\n        clearInterval(watcher);\n        return;\n      }\n      win.postMessage(true, API.baseURL);\n    }, 100);\n    const onMessage = ({ origin, data: { session } }) => {\n      if (API.baseURL.indexOf(origin) === 0) {\n        window.removeEventListener('message', onMessage);\n        clearInterval(watcher);\n        if (!session) {\n          return;\n        }\n        dispatch({\n          type: types.USER_LOGIN_FULFILLED,\n          payload: session,\n        });\n      }\n    };\n    window.addEventListener('message', onMessage, false);\n  };\n}\n\nexport function signout() {\n  return {\n    type: types.USER_SIGNOUT,\n  };\n}\n","import {\n  BufferAttribute,\n  BufferGeometry,\n  Frustum,\n  InstancedBufferAttribute,\n  InstancedBufferGeometry,\n  Matrix4,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  ShaderMaterial,\n  UniformsUtils,\n  ShaderLib,\n  VertexColors,\n  Vector3,\n} from 'three';\nimport Noise from '@/textures/noise';\n\nclass Voxels extends Object3D {\n  constructor({ instanced = false }) {\n    super();\n    if (instanced) {\n      const { shader } = Voxels;\n      this.geometry = new InstancedBufferGeometry();\n      this.material = new ShaderMaterial({\n        defines: shader.defines,\n        vertexShader: shader.vertex,\n        fragmentShader: shader.fragment,\n        uniforms: UniformsUtils.merge([\n          shader.uniforms,\n          { map: { value: Noise } },\n        ]),\n        fog: true,\n        vertexColors: VertexColors,\n      });\n    } else {\n      this.geometry = new BufferGeometry();\n      this.material = new MeshBasicMaterial({\n        map: Noise,\n        vertexColors: VertexColors,\n      });\n    }\n    this.instanced = instanced;\n    this.visible = false;\n\n    this.aux = {\n      frustum: new Frustum(),\n      matrix: new Matrix4(),\n    };\n  }\n\n  dispose() {\n    const { geometry, material } = this;\n    geometry.dispose();\n    material.dispose();\n  }\n\n  resize(size) {\n    const {\n      children,\n      geometry,\n      instanced,\n      material,\n    } = this;\n    while (children.length) {\n      this.remove(children[0]);\n    }\n\n    const radius = 8;\n    this.instances = [];\n    const aux = new Vector3();\n    const origin = new Vector3();\n    for (let z = -radius; z <= radius; z += 1) {\n      for (let y = -radius; y <= radius; y += 1) {\n        for (let x = -radius; x <= radius; x += 1) {\n          const distance = aux.set(x, y, z).distanceTo(origin);\n          if (Math.round(distance) <= radius) {\n            const instance = new Mesh(\n              geometry,\n              material\n            );\n            instance.chunk = { x, y, z };\n            instance.distance = distance;\n            instance.matrixAutoUpdate = false;\n            instance.position.set(x * size, y * size, z * size);\n            instance.updateMatrix();\n            instance.updateMatrixWorld();\n            this.instances.push(instance);\n          }\n        }\n      }\n    }\n    this.instances.sort(({ distance: a }, { distance: b }) => (\n      a - b\n    ));\n    this.intersects = this.instances.filter((instance) => {\n      const { chunk: { x, y, z } } = instance;\n      return (\n        x >= -2 && x <= 2\n        && y >= -2 && y <= 2\n        && z >= -2 && z <= 2\n      );\n    });\n\n    if (instanced) {\n      const mesh = new Mesh(\n        geometry,\n        material\n      );\n      mesh.frustumCulled = false;\n      this.add(mesh);\n      const offset = new Float32Array(this.instances.length * 3);\n      if (geometry.attributes.offset) {\n        geometry.attributes.offset.setArray(offset);\n      } else {\n        geometry.addAttribute('offset', new InstancedBufferAttribute(offset, 3));\n        geometry.attributes.offset.setDynamic(true);\n      }\n      geometry.maxInstancedCount = 0;\n    } else {\n      this.instances.forEach(instance => this.add(instance));\n    }\n  }\n\n  updateFrustum(camera) {\n    const {\n      aux: { frustum, matrix },\n      geometry,\n      instanced,\n      instances,\n    } = this;\n    if (!instanced || !instances) return;\n    matrix.multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse);\n    frustum.setFromMatrix(matrix);\n    const offsets = instances\n      .filter(({ worldSphere }) => worldSphere && frustum.intersectsSphere(worldSphere))\n      .reduce((offsets, { position }) => {\n        offsets.push(\n          position.x,\n          position.y,\n          position.z\n        );\n        return offsets;\n      }, []);\n    geometry.attributes.offset.array.set(offsets);\n    geometry.attributes.offset.needsUpdate = true;\n    geometry.maxInstancedCount = offsets.length / 3;\n  }\n\n  update({\n    index,\n    position,\n    color,\n    normal,\n    uv,\n  }) {\n    const { geometry, instances } = this;\n    if (geometry.attributes.position) {\n      geometry.attributes.position.setArray(position);\n      geometry.attributes.position.needsUpdate = true;\n    } else {\n      geometry.addAttribute('position', new BufferAttribute(position, 3));\n    }\n    if (geometry.attributes.color) {\n      geometry.attributes.color.setArray(color);\n      geometry.attributes.color.needsUpdate = true;\n    } else {\n      geometry.addAttribute('color', new BufferAttribute(color, 3));\n    }\n    if (geometry.attributes.normal) {\n      geometry.attributes.normal.setArray(normal);\n      geometry.attributes.normal.needsUpdate = true;\n    } else {\n      geometry.addAttribute('normal', new BufferAttribute(normal, 3));\n    }\n    if (geometry.attributes.uv) {\n      geometry.attributes.uv.setArray(uv);\n      geometry.attributes.uv.needsUpdate = true;\n    } else {\n      geometry.addAttribute('uv', new BufferAttribute(uv, 2));\n    }\n    if (geometry.index) {\n      geometry.index.setArray(index);\n      geometry.index.needsUpdate = true;\n    } else {\n      geometry.setIndex(new BufferAttribute(index, 1));\n    }\n    geometry.computeBoundingSphere();\n    instances.forEach((instance) => {\n      instance.worldSphere = geometry.boundingSphere\n        .clone()\n        .applyMatrix4(instance.matrixWorld);\n    });\n    this.visible = true;\n  }\n}\n\nVoxels.shader = {\n  vertex: (\n    ShaderLib.basic.vertexShader\n      .replace(\n        '#include <clipping_planes_pars_vertex>',\n        [\n          '#include <clipping_planes_pars_vertex>',\n          'attribute vec3 offset;',\n        ].join('\\n')\n      )\n      .replace(\n        '#include <begin_vertex>',\n        [\n          'vec3 transformed = vec3( offset + position );',\n        ].join('\\n')\n      )\n  ),\n  fragment: ShaderLib.basic.fragmentShader,\n  uniforms: UniformsUtils.clone(ShaderLib.basic.uniforms),\n  defines: { USE_MAP: true },\n};\n\nexport default Voxels;\n","import PropTypes from 'prop-types';\nimport React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { Vector3 } from 'three';\nimport {\n  fetch,\n  reset,\n  updateFog,\n  updateVoxels,\n} from '@/actions/realm';\nimport Metadata from '@/components/realm/metadata';\nimport Picker from '@/components/realm/picker';\nimport Voxels from '@/components/realm/voxels';\nimport Renderer from '@/components/renderer';\n\nclass Realm extends PureComponent {\n  componentDidMount() {\n    const {\n      fog,\n      history,\n      match: { params: { slug } },\n      renderer: { current: renderer },\n      fetch,\n      updateFog,\n    } = this.props;\n    // Setup scene\n    const scene = renderer.resetScene();\n    renderer.camera.canLock = !renderer.renderer.vr.enabled;\n    this.picker = new Picker({\n      anisotropy: renderer.getMaxAnisotropy(),\n      fog,\n      history,\n      updateFog,\n    });\n    renderer.hands.children[1].add(this.picker);\n    this.voxels = new Voxels({\n      instanced: !!renderer.renderer.extensions.get('ANGLE_instanced_arrays'),\n    });\n    scene.add(this.voxels);\n    this.head = new Vector3();\n    this.intersects = [this.picker];\n    this.renderer = renderer;\n    this.scene = scene;\n    scene.onBeforeRender = this.onBeforeRender.bind(this);\n    // Fetch realm\n    fetch(slug);\n  }\n\n  componentDidUpdate({\n    geometry: previousGeometry,\n    fog: previousFog,\n    size: previousSize,\n  }) {\n    const { geometry, fog, size } = this.props;\n    const { picker, renderer, voxels } = this;\n    const {\n      isScreenshot,\n      raycaster,\n      room,\n      renderer: { vr },\n    } = renderer;\n    if (fog !== previousFog) {\n      // Update fog\n      renderer.setFog(fog);\n    }\n    if (size !== previousSize) {\n      // Resize voxels\n      room.position.set(\n        size * 0.5 + 0.5,\n        size * 0.5,\n        size * 0.5 + 0.5\n      );\n      voxels.resize(size);\n      this.intersects = [\n        picker,\n        ...voxels.intersects,\n      ];\n    }\n    if (geometry !== previousGeometry) {\n      // Update voxels\n      voxels.update(geometry);\n      if (!previousGeometry.index && vr.enabled) {\n        // Pull the player down to the nearest voxel\n        raycaster.ray.origin.copy(room.position);\n        raycaster.ray.direction.set(0, -1, 0);\n        const hit = raycaster.intersectObjects(voxels.intersects)[0];\n        if (hit) {\n          room.position.y = hit.point.y;\n        }\n      }\n      if (isScreenshot) {\n        setImmediate(() => {\n          window.__SCREENSHOT_READY__ = true;\n        });\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    const { picker, renderer, scene } = this;\n    const { reset } = this.props;\n    renderer.hands.children[1].remove(picker);\n    picker.dispose();\n    delete scene.onBeforeRender;\n    reset();\n  }\n\n  onBeforeRender(renderer, scene, camera) {\n    const {\n      head,\n      intersects,\n      picker,\n      props: {\n        size,\n        updateVoxels,\n      },\n      renderer: {\n        hands,\n        isScreenshot,\n        raycaster,\n        room,\n      },\n      voxels,\n    } = this;\n\n    voxels.updateFrustum(camera);\n\n    // Handle controls\n    hands.children.forEach((hand) => {\n      const { buttons, pointer } = hand;\n      hand.setupRaycaster(raycaster);\n      const hit = raycaster.intersectObjects(intersects)[0] || false;\n      if (!hit) {\n        pointer.visible = false;\n        return;\n      }\n      const {\n        distance,\n        face: { normal },\n        object,\n        point,\n      } = hit;\n      // Pointer feedback\n      pointer.scale.z = distance - 0.175;\n      pointer.visible = true;\n      // Color picker\n      if (object === picker) {\n        if (buttons.triggerDown) {\n          picker.onPointer(point);\n        }\n        return;\n      }\n      // Translocation\n      if (\n        buttons.padDown\n        && normal.x === 0\n        && normal.y === 1\n        && normal.z === 0\n      ) {\n        head.setFromMatrixPosition(camera.matrixWorld);\n        const offset = {\n          x: head.x - room.position.x,\n          y: 0,\n          z: head.z - room.position.z,\n        };\n        const [x, y, z] = ['x', 'y', 'z'].map((axis) => {\n          let position = point[axis] - offset[axis];\n          while (position < 0) position += size;\n          while (position >= size) position -= size;\n          return position;\n        });\n        room.position.set(x, y, z);\n      }\n      // Voxel update\n      if (\n        buttons.triggerDown\n        || buttons.gripDown\n      ) {\n        updateVoxels({\n          color: picker.colors.fg,\n          point,\n          normal,\n          remove: buttons.gripDown,\n        });\n      }\n    });\n\n    // Animation for non-vr browsers\n    if (!isScreenshot && size && camera.canLock) {\n      if (!camera.isLocked) {\n        const { animation: { delta, time } } = renderer;\n        const rotation = Math.sin(time * 0.1) * 0.0005;\n        camera.rotateY(rotation);\n        camera.rotateX(rotation);\n        camera.rotateZ(rotation);\n        camera.translateZ(delta * 0.5);\n        camera.updateMatrixWorld();\n      }\n      ['x', 'y', 'z'].forEach((axis) => {\n        while (camera.position[axis] < 0) {\n          camera.position[axis] += size;\n        }\n        while (camera.position[axis] >= size) {\n          camera.position[axis] -= size;\n        }\n      });\n    }\n  }\n\n  render() {\n    const { isCreator } = this.props;\n    return isCreator ? (\n      <Metadata />\n    ) : null;\n  }\n}\n\nRealm.propTypes = {\n  geometry: PropTypes.shape({\n    index: PropTypes.instanceOf(Uint32Array),\n    position: PropTypes.instanceOf(Float32Array),\n    color: PropTypes.instanceOf(Float32Array),\n    normal: PropTypes.instanceOf(Float32Array),\n    uv: PropTypes.instanceOf(Float32Array),\n  }).isRequired,\n  fog: PropTypes.number.isRequired,\n  // eslint-disable-next-line react/forbid-prop-types\n  history: PropTypes.object.isRequired,\n  isCreator: PropTypes.bool.isRequired,\n  match: PropTypes.shape({\n    params: PropTypes.shape({\n      slug: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n  size: PropTypes.number.isRequired,\n  renderer: PropTypes.shape({\n    current: PropTypes.instanceOf(Renderer),\n  }).isRequired,\n  fetch: PropTypes.func.isRequired,\n  reset: PropTypes.func.isRequired,\n  updateFog: PropTypes.func.isRequired,\n  updateVoxels: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    realm: {\n      geometry,\n      fog,\n      isCreator,\n      size,\n    },\n  }) => ({\n    geometry,\n    fog,\n    isCreator,\n    size,\n  }),\n  {\n    fetch,\n    reset,\n    updateFog,\n    updateVoxels,\n  }\n)(Realm);\n","import PropTypes from 'prop-types';\nimport React, { PureComponent } from 'react';\nimport { TiEdit } from 'react-icons/ti';\nimport { connect } from 'react-redux';\nimport { Translate } from 'react-redux-i18n';\nimport styled from 'styled-components';\nimport Popup from '@/components/popup';\nimport {\n  hideMetadataPopup as hide,\n  showMetadataPopup as show,\n  updateMetadata as update,\n} from '@/actions/realm';\n\nconst Toggle = styled.form`\n  position: absolute;\n  top: 0;\n  left: 0;\n  cursor: pointer;\n  .icon {\n    position: absolute;\n    font-size: 2.5rem;\n    top: ${100 / 3}%;\n    left: ${100 / 3}%;\n    transform: translate(-50%, -50%);\n  }\n`;\n\nconst Content = styled.div`\n  button {\n    display: flex;\n    align-items: center;\n    border: 1px solid #555;\n    background: #222;\n    padding: 0.5rem 1rem;\n    margin: 0;\n    font-family: inherit;\n    font-weight: 700;\n    font-size: 1.2rem;\n    color: inherit;\n    cursor: pointer;\n    outline: 0;\n    > svg {\n      font-size: 1.5em;\n      margin-right: 0.5rem;\n    }\n  }\n`;\n\nconst Form = styled.form`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 80%;\n  > label {\n    width: 100%;\n    padding: 0;\n  }\n  > input {\n    box-sizing: border-box;\n    border: 1px solid #333;\n    width: 100%;\n    background: #222;\n    color: inherit;\n    font-family: inherit;\n    font-weight: 400;\n    font-size: 2em;\n    padding: 0.5rem;\n    margin: 0 0 1rem;\n  }\n`;\n\nclass Metadata extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.onSubmit = this.onSubmit.bind(this);\n  }\n\n  onSubmit(e) {\n    e.preventDefault();\n    const { target: form } = e;\n    const { update } = this.props;\n    update({\n      name: form.name.value,\n    });\n  }\n\n  render() {\n    const {\n      isEditingMetadata,\n      name,\n      hide,\n      show,\n    } = this.props;\n    return (\n      <div>\n        <Toggle\n          onClick={show}\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width=\"80\"\n            height=\"80\"\n            viewBox=\"0 0 250 250\"\n            fill=\"#fff\"\n          >\n            <path\n              d=\"M0,250 L250,0 L0,0 Z\"\n              fill=\"#000\"\n            />\n          </svg>\n          <TiEdit className=\"icon\" />\n        </Toggle>\n        <Popup\n          heading={<Translate value=\"Realm.editMetadata\" />}\n          isShowing={isEditingMetadata}\n          hide={hide}\n        >\n          <Content>\n            <Form\n              onSubmit={this.onSubmit}\n            >\n              <label><Translate value=\"Realm.name\" /></label>\n              <input\n                type=\"text\"\n                name=\"name\"\n                defaultValue={name}\n                required\n              />\n              <button\n                type=\"submit\"\n              >\n                <TiEdit />\n                <Translate value=\"Realm.save\" />\n              </button>\n            </Form>\n          </Content>\n        </Popup>\n      </div>\n    );\n  }\n}\n\nMetadata.propTypes = {\n  isEditingMetadata: PropTypes.bool.isRequired,\n  name: PropTypes.string.isRequired,\n  hide: PropTypes.func.isRequired,\n  show: PropTypes.func.isRequired,\n  update: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    realm: {\n      isEditingMetadata,\n      name,\n    },\n  }) => ({\n    isEditingMetadata,\n    name,\n  }),\n  {\n    hide,\n    show,\n    update,\n  }\n)(Metadata);\n","import {\n  BufferGeometry,\n  Mesh,\n  MeshBasicMaterial,\n  PlaneGeometry,\n  Vector3,\n  VertexColors,\n} from 'three';\nimport Noise from '@/textures/noise';\n\nclass Ground extends Mesh {\n  constructor() {\n    if (\n      !Ground.geometry\n      || !Ground.material\n    ) {\n      Ground.setup();\n    }\n    super(\n      Ground.geometry,\n      Ground.material\n    );\n  }\n\n  static setup() {\n    if (!Ground.geometry) {\n      const size = 256;\n      const geometry = new PlaneGeometry(size, size, size, size);\n      geometry.rotateX(Math.PI * -0.5);\n      const origin = new Vector3();\n      geometry.vertices.forEach((vertex) => {\n        const distance = Math.floor(vertex.distanceTo(origin)) / 4;\n        const height = Math.floor(distance * distance / 3) / 6;\n        vertex.y = (\n          height * (Math.random() * 0.4 + 0.6)\n          + Math.max(Math.min(-(distance - 1.25), 0), -2)\n        );\n      });\n      geometry.faces.forEach((face, i) => {\n        if (i % 2 === 1) {\n          const p = geometry.faces[i - 1];\n          const v = [\n            face.a, face.b, face.c,\n            p.a, p.b, p.c,\n          ].map(v => geometry.vertices[v]);\n          const height = v.reduce((avg, v) => (\n            avg + v.y\n          ), 0) / v.length;\n          v.forEach((v) => { v.y = height; });\n          const factor = Math.min(height / 40 + 0.25, 1);\n          face.color.setRGB(factor * 0.5, factor, factor * 0.75);\n          face.color.offsetHSL(\n            Math.random() * 0.03 - 0.01,\n            Math.random() * 0.2,\n            Math.random() * -0.05\n          );\n          p.color.copy(face.color);\n        }\n      });\n      Ground.geometry = (new BufferGeometry()).fromGeometry(geometry);\n      const uv = Ground.geometry.attributes.uv.array;\n      for (let i = 0; i < uv.length / 2; i += 6) {\n        uv.set([\n          0, 1,\n        ], i * 2);\n        uv.set([\n          0, 0,\n        ], (i + 1) * 2);\n        uv.set([\n          1, 1,\n        ], (i + 2) * 2);\n        uv.set([\n          0, 0,\n        ], (i + 3) * 2);\n        uv.set([\n          1, 0,\n        ], (i + 4) * 2);\n        uv.set([\n          1, 1,\n        ], (i + 5) * 2);\n      }\n    }\n    if (!Ground.material) {\n      Ground.material = new MeshBasicMaterial({\n        map: Noise,\n        vertexColors: VertexColors,\n      });\n    }\n  }\n}\n\nexport default Ground;\n","import * as types from './types';\nimport API from '@/services/api';\n\nexport function fetchRealms() {\n  return (dispatch, getState) => {\n    const { lobby: { filter, pagination: { page } } } = getState();\n    return dispatch({\n      type: types.LOBBY_FETCH_REALMS,\n      payload: API.fetch({\n        endpoint: `realms/${filter}/${page}`,\n      }),\n    });\n  };\n}\n\nexport function setFilter(value) {\n  return {\n    type: types.LOBBY_SET_FILTER,\n    payload: { value },\n  };\n}\n\nexport function setPage(value) {\n  return {\n    type: types.LOBBY_SET_PAGE,\n    payload: { value },\n  };\n}\n","import { Color } from 'three';\nimport Panel from '@/components/panel';\nimport Fonts from '@/services/fonts';\n\nclass Picker extends Panel {\n  constructor({\n    anisotropy,\n    fog,\n    history,\n    updateFog,\n  }) {\n    super({ anisotropy });\n    const { renderer } = this;\n    this.position.set(-0.15, 0.15, 0.075);\n    this.rotation.set(0, Math.PI * 0.5, Math.PI * 0.1, 'ZYX');\n    this.scale.set(0.3, 0.3, 1);\n    this.block = {\n      x: renderer.width * 0.05,\n      y: renderer.height * 0.05,\n      width: renderer.width * 0.75,\n      height: renderer.height * 0.75,\n    };\n    this.strip = {\n      x: renderer.width * 0.85,\n      y: renderer.height * 0.05,\n      width: renderer.width * 0.1,\n      height: renderer.height * 0.75,\n    };\n    this.modeButton = {\n      label: 'MODE',\n      x: renderer.width * 0.7,\n      y: renderer.height * 0.85,\n      width: renderer.width * 0.25,\n      height: renderer.height * 0.1,\n      onPointer: () => {\n        this.setMode(\n          this.mode === 'fg' ? 'bg' : 'fg'\n        );\n        this.draw();\n      },\n    };\n    this.buttons = [\n      {\n        label: ' REALMS',\n        x: renderer.width * 0.05,\n        y: renderer.height * 0.85,\n        width: renderer.width * 0.25,\n        height: renderer.height * 0.1,\n        onPointer: () => history.push('/'),\n      },\n      this.modeButton,\n    ];\n    this.colors = {\n      bg: (new Color()).setHex(fog),\n      fg: (new Color()).setHSL(Math.random(), 0.6, 0.8),\n      block: new Color(),\n    };\n    this.setMode('fg');\n    this.updateFog = updateFog;\n    Fonts\n      .waitUntilLoaded('Roboto')\n      .then(() => (\n        this.draw()\n      ));\n  }\n\n  draw() {\n    const {\n      block,\n      buttons,\n      colors,\n      context: ctx,\n      mode,\n      renderer,\n      strip,\n    } = this;\n\n    super.draw();\n\n    {\n      const {\n        x,\n        y,\n        width,\n        height,\n      } = block;\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.fillStyle = `#${colors.block.getHexString()}`;\n      ctx.fillRect(0, 0, width, height);\n\n      const grdWhite = ctx.createLinearGradient(0, 0, width, 0);\n      grdWhite.addColorStop(0, 'rgba(255,255,255,1)');\n      grdWhite.addColorStop(1, 'rgba(255,255,255,0)');\n      ctx.fillStyle = grdWhite;\n      ctx.fillRect(0, 0, width, height);\n\n      const grdBlack = ctx.createLinearGradient(0, 0, 0, height);\n      grdBlack.addColorStop(0, 'rgba(0,0,0,0)');\n      grdBlack.addColorStop(1, 'rgba(0,0,0,1)');\n      ctx.fillStyle = grdBlack;\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n    }\n\n    {\n      const {\n        x,\n        y,\n        width,\n        height,\n      } = strip;\n      ctx.save();\n      ctx.translate(x, y);\n      const grd = ctx.createLinearGradient(0, 0, 0, height);\n      grd.addColorStop(0, 'rgba(255, 0, 0, 1)');\n      grd.addColorStop(0.17, 'rgba(255, 255, 0, 1)');\n      grd.addColorStop(0.34, 'rgba(0, 255, 0, 1)');\n      grd.addColorStop(0.51, 'rgba(0, 255, 255, 1)');\n      grd.addColorStop(0.68, 'rgba(0, 0, 255, 1)');\n      grd.addColorStop(0.85, 'rgba(255, 0, 255, 1)');\n      grd.addColorStop(1, 'rgba(255, 0, 0, 1)');\n      ctx.fillStyle = grd;\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n    }\n\n    {\n      ctx.save();\n      const width = renderer.width * 0.25;\n      const height = renderer.width * 0.1;\n      ctx.translate(renderer.width * 0.375, renderer.height * 0.85);\n      ctx.fillStyle = `#${colors[mode].getHexString()}`;\n      ctx.strokeStyle = '#333';\n      ctx.beginPath();\n      ctx.rect(0, 0, width, height);\n      ctx.fill();\n      ctx.stroke();\n      ctx.restore();\n    }\n\n    buttons.forEach(({\n      label,\n      x,\n      y,\n      width,\n      height,\n    }) => {\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.fillStyle = '#222';\n      ctx.strokeStyle = '#333';\n      ctx.beginPath();\n      ctx.rect(0, 0, width, height);\n      ctx.fill();\n      ctx.stroke();\n      ctx.fillStyle = '#fff';\n      ctx.font = '700 24px Roboto';\n      ctx.textAlign = 'center';\n      ctx.textBaseline = 'middle';\n      ctx.fillText(label, width * 0.5, height * 0.5);\n      ctx.restore();\n    });\n  }\n\n  setMode(mode) {\n    const { colors, modeButton } = this;\n    colors.block.copy(colors[mode]);\n    modeButton.label = mode === 'fg' ? 'FG color' : 'BG color';\n    this.mode = mode;\n  }\n\n  onPointer(point) {\n    const {\n      block,\n      buttons,\n      colors,\n      context: ctx,\n      mode,\n      pointer,\n      strip,\n      updateFog,\n    } = this;\n    super.onPointer(point);\n    [block, strip, ...buttons].forEach((object) => {\n      const {\n        x,\n        y,\n        width,\n        height,\n        onPointer,\n      } = object;\n      if (\n        pointer.x < x\n        || pointer.x > x + width\n        || pointer.y < y\n        || pointer.y > y + height\n      ) {\n        return;\n      }\n      if (onPointer) {\n        onPointer();\n        return;\n      }\n      const imageData = ctx.getImageData(pointer.x, pointer.y, 1, 1).data;\n      if (object === strip) {\n        colors.block.setRGB(\n          imageData[0] / 0xFF,\n          imageData[1] / 0xFF,\n          imageData[2] / 0xFF\n        );\n      }\n      colors[mode].setRGB(\n        imageData[0] / 0xFF,\n        imageData[1] / 0xFF,\n        imageData[2] / 0xFF\n      );\n      if (mode === 'bg') {\n        updateFog(colors[mode].getHex());\n      }\n      this.draw();\n    });\n  }\n}\n\nexport default Picker;\n","import {\n  BufferGeometry,\n  Color,\n  CylinderGeometry,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  VertexColors,\n} from 'three';\nimport Panel from '@/components/panel';\nimport API from '@/services/api';\nimport Fonts from '@/services/fonts';\n\nclass Pillar extends Mesh {\n  constructor() {\n    if (!Pillar.geometry || !Pillar.material) {\n      Pillar.setup();\n    }\n    super(\n      Pillar.geometry,\n      Pillar.material\n    );\n  }\n\n  static setup() {\n    if (!Pillar.geometry) {\n      const geometry = new CylinderGeometry(0.025, 0.025, 1.5, 8, 32);\n      geometry.translate(0, -0.83, 0);\n      const color = new Color();\n      geometry.faces.forEach((face, i) => {\n        if (i % 2 === 1) {\n          face.color.copy(color);\n        } else {\n          face.color.setHex(0x445544);\n          face.color.offsetHSL(0, 0, Math.random() * -0.1);\n          color.copy(face.color);\n        }\n      });\n      Pillar.geometry = (new BufferGeometry()).fromGeometry(geometry);\n    }\n    if (!Pillar.material) {\n      Pillar.material = new MeshBasicMaterial({\n        vertexColors: VertexColors,\n      });\n    }\n  }\n}\n\nclass Realm extends Panel {\n  constructor({\n    anisotropy,\n    _id: id,\n    name,\n    creator,\n    onPointer,\n  }) {\n    super({\n      anisotropy,\n    });\n    this.name = name.length > 16 ? (\n      `${name.substr(0, 16)}...`\n    ) : (\n      name\n    );\n    this.onPointer = onPointer;\n    this.scale.set(0.3, 0.3, 1);\n    {\n      const { width, height } = this.renderer;\n      const vignette = this.context.createRadialGradient(\n        width * 0.5, height * 0.5, width * 0.2,\n        width * 0.5, height * 0.5, width * 0.5\n      );\n      vignette.addColorStop(0, 'rgba(0, 0, 0, 0)');\n      vignette.addColorStop(1, 'rgba(0, 0, 0, .5)');\n      this.vignette = vignette;\n    }\n    let hasLoadedFont = false;\n    Fonts\n      .waitUntilLoaded('Roboto')\n      .then(() => {\n        hasLoadedFont = true;\n        this.draw();\n      });\n    if (creator) {\n      const image = new Image();\n      image.crossOrigin = 'anonymous';\n      image.src = `${API.baseURL}user/${creator._id}/photo`;\n      image.onload = () => {\n        this.creator = image;\n        if (hasLoadedFont) {\n          this.draw();\n        }\n      };\n    }\n    {\n      const image = new Image();\n      image.crossOrigin = 'anonymous';\n      image.src = `${API.baseURL}realm/${id}/screenshot`;\n      image.onload = () => {\n        this.screenshot = image;\n        if (hasLoadedFont) {\n          this.draw();\n        }\n      };\n    }\n  }\n\n  draw() {\n    const {\n      context: ctx,\n      creator,\n      isHover,\n      name,\n      renderer,\n      screenshot,\n      vignette,\n    } = this;\n    super.draw();\n    if (screenshot) {\n      ctx.drawImage(screenshot, 0, 0);\n    }\n    ctx.fillStyle = vignette;\n    ctx.fillRect(0, 0, renderer.width, renderer.height);\n    ctx.fillStyle = `rgba(${isHover ? '255, 255, 255' : '0, 0, 0'}, .5)`;\n    ctx.fillRect(0, renderer.height * 0.75, renderer.width, renderer.height * 0.25);\n    ctx.font = '40px Roboto';\n    ctx.textAlign = 'left';\n    ctx.textBaseline = 'middle';\n    ctx.fillStyle = isHover ? '#333' : '#fff';\n    if (creator) {\n      ctx.drawImage(\n        creator,\n        0, renderer.height * 0.75,\n        renderer.width * 0.25, renderer.height * 0.25\n      );\n    }\n    ctx.fillText(\n      name,\n      renderer.width * 0.05 + (renderer.width * (creator ? 0.25 : 0.05)),\n      renderer.height * 0.875\n    );\n  }\n}\n\nclass ButtonsPanel extends Panel {\n  constructor({\n    anisotropy,\n  }) {\n    super({\n      anisotropy,\n      width: 256,\n      height: 256,\n    });\n    this.scale.set(0.25, 0.25, 1);\n    this.hasLoadedFont = false;\n    Fonts\n      .waitUntilLoaded('Roboto')\n      .then(() => {\n        this.hasLoadedFont = true;\n        this.draw();\n      });\n  }\n\n  draw() {\n    const {\n      buttons,\n      context: ctx,\n    } = this;\n    super.draw();\n    ctx.font = '700 30px Roboto';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    buttons.forEach(({\n      label,\n      x,\n      y,\n      width,\n      height,\n      isActive,\n      isDisabled,\n    }) => {\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.beginPath();\n      ctx.rect(0, 0, width, height);\n      if (isDisabled) {\n        ctx.fillStyle = '#555';\n      } else if (isActive) {\n        ctx.fillStyle = '#fff';\n      } else {\n        ctx.fillStyle = '#222';\n      }\n      ctx.strokeStyle = '#333';\n      ctx.fill();\n      ctx.stroke();\n      if (isDisabled) {\n        ctx.fillStyle = '#777';\n      } else if (isActive) {\n        ctx.fillStyle = '#222';\n      } else {\n        ctx.fillStyle = '#fff';\n      }\n      ctx.fillText(\n        label,\n        width * 0.5,\n        height * 0.5\n      );\n      ctx.restore();\n    });\n  }\n\n  onPointer({ isDown, point }) {\n    const { buttons, pointer } = this;\n    if (!isDown) return;\n    super.onPointer(point);\n    buttons\n      .filter(({ isDisabled }) => (!isDisabled))\n      .forEach(({\n        x,\n        y,\n        width,\n        height,\n        onPointer,\n      }) => {\n        if (\n          pointer.x < x\n          || pointer.x > x + width\n          || pointer.y < y\n          || pointer.y > y + height\n        ) {\n          return;\n        }\n        onPointer();\n      });\n  }\n}\n\nclass CreateRealm extends ButtonsPanel {\n  constructor({\n    anisotropy,\n    history,\n    createRealm,\n  }) {\n    super({ anisotropy });\n    this.scale.set(0.3, 0.3, 1);\n    const { width, height } = this.renderer;\n    this.buttons = [\n      {\n        label: 'Create Realm',\n        x: width * 0.1,\n        y: height * 0.3,\n        width: width * 0.8,\n        height: height * 0.4,\n        onPointer: () => (\n          createRealm()\n            .then(({ value: slug }) => history.push(`/${slug}`))\n        ),\n      },\n    ];\n  }\n}\n\nclass Pagination extends ButtonsPanel {\n  constructor({\n    anisotropy,\n    page,\n    pages,\n    update,\n  }) {\n    super({ anisotropy });\n    const { width, height } = this.renderer;\n    this.buttons = [\n      {\n        label: '<',\n        x: width * 0.1,\n        y: height * 0.3,\n        width: width * 0.3,\n        height: height * 0.4,\n        onPointer: () => {\n          if (this.page > 0) update(this.page - 1);\n        },\n      },\n      {\n        label: '>',\n        x: width * 0.6,\n        y: height * 0.3,\n        width: width * 0.3,\n        height: height * 0.4,\n        onPointer: () => {\n          if (this.page < this.pages - 1) update(this.page + 1);\n        },\n      },\n    ];\n    this.page = page;\n    this.pages = pages;\n  }\n\n  draw() {\n    const {\n      context: ctx,\n      page,\n      pages,\n      renderer,\n    } = this;\n    super.draw();\n    ctx.fillStyle = '#fff';\n    ctx.fillText(\n      `${page + 1} / ${pages}`,\n      renderer.width * 0.5,\n      renderer.height * 0.85\n    );\n  }\n}\n\nclass Session extends ButtonsPanel {\n  constructor({\n    anisotropy,\n    isSigningIn,\n    user,\n    signin,\n    signout,\n  }) {\n    super({ anisotropy });\n    this.signin = signin;\n    this.signout = signout;\n    this.updateSession({\n      isSigningIn,\n      user,\n    });\n  }\n\n  updateSession({ isSigningIn, user }) {\n    const { renderer, signin, signout } = this;\n    const { width, height } = renderer;\n    if (isSigningIn) {\n      this.buttons = [];\n    } else if (!user) {\n      this.buttons = [{\n        label: 'Sign-In',\n        x: width * 0.1,\n        y: height * 0.4,\n        width: width * 0.8,\n        height: height * 0.4,\n        onPointer: signin,\n      }];\n    } else {\n      this.buttons = [{\n        label: 'Sign-Out',\n        x: width * 0.1,\n        y: height * 0.7,\n        width: width * 0.8,\n        height: height * 0.2,\n        onPointer: signout,\n      }];\n    }\n    this.isSigningIn = isSigningIn;\n    this.user = user;\n    delete this.userPhoto;\n    if (user) {\n      const image = new Image();\n      image.crossOrigin = 'anonymous';\n      image.src = `${API.baseURL}user/${user._id}/photo`;\n      image.onload = () => {\n        this.userPhoto = image;\n        if (this.hasLoadedFont) {\n          this.draw();\n        }\n      };\n    }\n  }\n\n  draw() {\n    const {\n      context: ctx,\n      isSigningIn,\n      renderer,\n      user,\n      userPhoto,\n    } = this;\n    super.draw();\n    ctx.fillStyle = '#fff';\n    if (isSigningIn) {\n      ctx.fillText(\n        'Remove your',\n        renderer.width * 0.5,\n        renderer.height * 0.25\n      );\n      ctx.fillText(\n        'headset',\n        renderer.width * 0.5,\n        renderer.height * 0.4\n      );\n      ctx.fillText(\n        'And Sign-In',\n        renderer.width * 0.5,\n        renderer.height * 0.6\n      );\n      ctx.fillText(\n        'in your browser',\n        renderer.width * 0.5,\n        renderer.height * 0.75\n      );\n    } else {\n      ctx.fillText(\n        user ? user.firstName : 'Guest',\n        renderer.width * 0.5,\n        renderer.height * 0.2\n      );\n    }\n    if (user && userPhoto) {\n      ctx.drawImage(\n        userPhoto,\n        renderer.width * 0.5 - 40, renderer.height * 0.5 - 50,\n        80, 80\n      );\n    }\n  }\n}\n\nclass Filter extends ButtonsPanel {\n  constructor({\n    anisotropy,\n    isAuth,\n    filter,\n    update,\n  }) {\n    super({ anisotropy });\n    const { width, height } = this.renderer;\n    this.buttons = [\n      {\n        id: 'popular',\n        label: 'Most Popular',\n        x: width * 0.1,\n        y: height * 0.1,\n        width: width * 0.8,\n        height: height * 0.2,\n        onPointer: () => update('popular'),\n      },\n      {\n        id: 'latest',\n        label: 'Latest Realms',\n        x: width * 0.1,\n        y: height * 0.4,\n        width: width * 0.8,\n        height: height * 0.2,\n        onPointer: () => update('latest'),\n      },\n      {\n        id: 'user',\n        label: 'Your Realms',\n        x: width * 0.1,\n        y: height * 0.7,\n        width: width * 0.8,\n        height: height * 0.2,\n        isDisabled: !isAuth,\n        onPointer: () => update('user'),\n      },\n    ];\n    this.filter = filter;\n    this.update = update;\n  }\n\n  updateSession({ isAuth }) {\n    const { buttons } = this;\n    buttons[\n      buttons.findIndex(({ id }) => (id === 'user'))\n    ].isDisabled = !isAuth;\n  }\n\n  draw() {\n    const { buttons, filter } = this;\n    buttons.forEach((button) => {\n      button.isActive = button.id === filter;\n    });\n    super.draw();\n  }\n}\n\nclass Menu extends Object3D {\n  constructor({\n    anisotropy,\n    filter,\n    history,\n    isSigningIn,\n    pagination,\n    realms,\n    user,\n    createRealm,\n    setFilter,\n    setPage,\n    signin,\n    signout,\n  }) {\n    super();\n    this.anisotropy = anisotropy;\n    this.history = history;\n    this.hover = {};\n    this.intersects = [];\n    this.position.set(0, 1.25, -1);\n    this.pagination = this.addPanel(\n      Pagination,\n      {\n        ...pagination,\n        update: setPage,\n      },\n      0, -0.3, 0.13\n    );\n    this.session = this.addPanel(\n      Session,\n      {\n        isSigningIn,\n        user,\n        signin,\n        signout,\n      },\n      -0.3, -0.3, 0.13\n    );\n    this.filter = this.addPanel(\n      Filter,\n      {\n        filter,\n        isAuth: !!user,\n        update: setFilter,\n      },\n      0.3, -0.3, 0.13\n    );\n    this.createRealm = createRealm;\n    this.updateRealms(realms);\n  }\n\n  addPanel(Panel, props, x, y, z) {\n    const { anisotropy, intersects } = this;\n    const panel = new Panel({ ...props, anisotropy });\n    panel.position.set(x, y, z);\n    panel.lookAt(0, 0.5, 1);\n    this.add(panel);\n    const pillar = new Pillar();\n    pillar.position.copy(panel.position);\n    this.add(pillar);\n    intersects.push(panel);\n    return panel;\n  }\n\n  dispose() {\n    const { children } = this;\n    children.forEach(child => child.dispose && child.dispose());\n  }\n\n  setHover({ hand, realm }) {\n    const { hover } = this;\n    if (hover[hand] === realm) {\n      return;\n    }\n    if (hover[hand]) {\n      hover[hand].isHover = false;\n      hover[hand].draw();\n    }\n    if (realm) {\n      realm.isHover = true;\n      realm.draw();\n    }\n    this.hover[hand] = realm;\n  }\n\n  updateFilter(value) {\n    const { filter } = this;\n    filter.filter = value;\n    filter.draw();\n  }\n\n  updatePagination({ page, pages }) {\n    const { pagination } = this;\n    pagination.page = page;\n    pagination.pages = pages;\n    pagination.draw();\n  }\n\n  updateRealms(realms) {\n    const {\n      anisotropy,\n      children,\n      createRealm,\n      filter: { filter },\n      history,\n      pagination,\n    } = this;\n    while (children.length > 6) {\n      const child = children[children.length - 1];\n      if (child.dispose) child.dispose();\n      this.remove(child);\n    }\n    this.intersects.length = 3;\n    const showCreateRealm = filter === 'user' && pagination.page === 0;\n    const count = realms.length + (showCreateRealm ? 1 : 0);\n    let offset = 0.25 + count * -0.25;\n    if (showCreateRealm) {\n      this.addPanel(\n        CreateRealm,\n        {\n          history,\n          createRealm,\n        },\n        offset, 0, 0\n      );\n      offset += 0.5;\n    }\n    realms.forEach((realm, i) => {\n      const panel = this.addPanel(\n        Realm,\n        {\n          ...realm,\n          anisotropy,\n          onPointer: ({ hand, isDown }) => {\n            this.setHover({ hand, realm: panel });\n            if (isDown) {\n              history.push(`/${realm.slug}`);\n            }\n          },\n        },\n        offset + (i * 0.5), 0, 0\n      );\n    });\n  }\n\n  updateSession({ isSigningIn, user }) {\n    const { filter, session } = this;\n    filter.updateSession({ isAuth: !!user });\n    filter.draw();\n    session.updateSession({ isSigningIn, user });\n    session.draw();\n  }\n}\n\nexport default Menu;\n","import {\n  BufferGeometry,\n  Points,\n  PointsMaterial,\n  VertexColors,\n  BufferAttribute,\n  Vector3,\n} from 'three';\n\nclass Starfield extends Points {\n  constructor() {\n    if (\n      !Starfield.geometry\n      || !Starfield.material\n    ) {\n      Starfield.setup();\n    }\n    super(\n      Starfield.geometry,\n      Starfield.material\n    );\n  }\n\n  onBeforeRender({ animation: { time } }) {\n    this.rotation.x = Math.sin(time * 0.01) * 1 / 3;\n  }\n\n  static setup() {\n    if (!Starfield.geometry) {\n      const count = 2048;\n      const radius = 512;\n      const position = new Float32Array(count * 3);\n      const color = new Float32Array(count * 3);\n      const aux = new Vector3();\n      for (let i = 0; i < count * 3; i += 3) {\n        aux\n          .set(\n            Math.random() * 2 - 1,\n            Math.random(),\n            Math.random() * 2 - 1\n          )\n          .normalize()\n          .multiplyScalar(radius);\n        position[i] = aux.x;\n        position[i + 1] = aux.y;\n        position[i + 2] = aux.z;\n        const c = 0.2 + Math.random() * 0.5;\n        color[i] = c - Math.random() * 0.1;\n        color[i + 1] = c - Math.random() * 0.1;\n        color[i + 2] = c - Math.random() * 0.1;\n      }\n      Starfield.geometry = new BufferGeometry();\n      Starfield.geometry.addAttribute('position', new BufferAttribute(position, 3));\n      Starfield.geometry.addAttribute('color', new BufferAttribute(color, 3));\n    }\n    if (!Starfield.material) {\n      Starfield.material = new PointsMaterial({\n        fog: false,\n        vertexColors: VertexColors,\n      });\n    }\n  }\n}\n\nexport default Starfield;\n","class API {\n  constructor() {\n    this.baseURL = __API__;\n  }\n\n  fetch({\n    body,\n    endpoint,\n    headers = {},\n    method = 'GET',\n  }) {\n    const {\n      authorization,\n      baseURL,\n    } = this;\n    if (authorization) {\n      headers.Authorization = authorization;\n    }\n    if (body && !(body instanceof FormData)) {\n      body = JSON.stringify(body);\n      headers['Content-Type'] = 'application/json';\n    }\n    return fetch(\n      `${baseURL}${endpoint}`,\n      {\n        body,\n        headers,\n        method,\n      }\n    )\n      .then((res) => {\n        const { headers, status } = res;\n        if (status < 200 || status >= 400) {\n          throw new Error(status);\n        }\n        const type = (headers.get('Content-Type') || '').split(';')[0];\n        switch (type) {\n          case 'text/plain':\n            return res.arrayBuffer();\n          case 'application/json':\n            return res.json();\n          default:\n            return res;\n        }\n      });\n  }\n\n  setAuthorization(token) {\n    if (token) {\n      this.authorization = `Bearer ${token}`;\n    } else {\n      delete this.authorization;\n    }\n    this.token = token;\n  }\n}\n\nexport default new API();\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { TiTimes } from 'react-icons/ti';\nimport styled from 'styled-components';\n\nconst Overlay = styled.div`\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  background: rgba(0, 0, 0, .5);\n`;\n\nconst Wrapper = styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 512px;\n  background: #444;\n  box-shadow: 0 0 32px rgba(0, 0, 0, .5);\n`;\n\nconst Heading = styled.div`\n  background: #111;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 56px;\n  > span {\n    padding: 0 1.5em;\n  }\n  > a {\n    padding: 1rem;\n    cursor: pointer;\n    > svg {\n      font-size: 1.5em;\n    }\n  }\n`;\n\nconst Content = styled.div`\n  > div {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 2rem 0;\n  }\n`;\n\nconst Popup = ({\n  children,\n  heading,\n  isShowing,\n  hide,\n}) => {\n  if (!isShowing) {\n    return null;\n  }\n  return (\n    <Overlay>\n      <Wrapper>\n        <Heading>\n          {heading}\n          <a\n            onClick={hide}\n          >\n            <TiTimes />\n          </a>\n        </Heading>\n        <Content>\n          {children}\n        </Content>\n      </Wrapper>\n    </Overlay>\n  );\n};\n\nPopup.propTypes = {\n  children: PropTypes.node.isRequired,\n  heading: PropTypes.node.isRequired,\n  isShowing: PropTypes.bool.isRequired,\n  hide: PropTypes.func.isRequired,\n};\n\nexport default Popup;\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"code/mesher.worker.360be4fe5c7a7121f34a.js\");\n};","import {\n  BoxGeometry,\n  BufferGeometry,\n  CanvasTexture,\n  DoubleSide,\n  Mesh,\n  MeshBasicMaterial,\n  PlaneBufferGeometry,\n  VertexColors,\n  Vector3,\n} from 'three';\n\nclass Panel extends Mesh {\n  constructor({\n    anisotropy,\n    width = 512,\n    height = 512,\n  }) {\n    if (\n      !Panel.backplate\n      || !Panel.geometry\n    ) {\n      Panel.setup();\n    }\n    const renderer = document.createElement('canvas');\n    renderer.width = width;\n    renderer.height = height;\n    const texture = new CanvasTexture(renderer);\n    texture.anisotropy = anisotropy;\n    super(\n      Panel.geometry,\n      new MeshBasicMaterial({\n        map: texture,\n      })\n    );\n    this.add(Panel.backplate.clone());\n    this.context = renderer.getContext('2d');\n    this.pointer = new Vector3();\n    this.renderer = renderer;\n    this.texture = texture;\n  }\n\n  dispose() {\n    const { material, texture } = this;\n    material.dispose();\n    texture.dispose();\n  }\n\n  draw() {\n    const {\n      context: ctx,\n      renderer,\n      texture,\n    } = this;\n    ctx.fillStyle = '#111';\n    ctx.fillRect(0, 0, renderer.width, renderer.height);\n    texture.needsUpdate = true;\n  }\n\n  onPointer(point) {\n    const { pointer, renderer } = this;\n    this.worldToLocal(pointer.copy(point));\n    pointer.set(\n      (pointer.x + 0.5) * renderer.width,\n      (1 - (pointer.y + 0.5)) * renderer.height,\n      0\n    );\n  }\n\n  static setup() {\n    if (!Panel.backplate) {\n      const geometry = new BoxGeometry(1, 1, 0.06);\n      geometry.faces.splice(8, 2);\n      geometry.faces.forEach((face, i) => (\n        face.color.setHex(\n          Math.floor(i / 2) === 4 ? 0x111111 : 0x222222\n        )\n      ));\n      geometry.translate(0, 0, -0.01);\n      const backplate = new Mesh(\n        (new BufferGeometry()).fromGeometry(geometry),\n        new MeshBasicMaterial({\n          side: DoubleSide,\n          vertexColors: VertexColors,\n        })\n      );\n      Panel.backplate = backplate;\n    }\n\n    if (!Panel.geometry) {\n      Panel.geometry = new PlaneBufferGeometry(1, 1);\n    }\n  }\n}\n\nexport default Panel;\n","import {\n  CanvasTexture,\n  NearestFilter,\n  RepeatWrapping,\n} from 'three';\n\nclass Noise extends CanvasTexture {\n  constructor() {\n    const renderer = document.createElement('canvas');\n    const ctx = renderer.getContext('2d');\n    renderer.width = 16;\n    renderer.height = 16;\n    const pixels = ctx.getImageData(0, 0, renderer.width, renderer.height);\n    for (let y = 0; y < renderer.height; y += 1) {\n      for (let x = 0; x < renderer.width; x += 1) {\n        let light = 0.9 + Math.random() * 0.05;\n        if (\n          x === 0\n          || x === renderer.width - 1\n          || y === 0\n          || y === renderer.height - 1\n        ) {\n          light *= 0.9;\n        } else if (\n          x === 1\n          || x === renderer.width - 2\n          || y === 1\n          || y === renderer.height - 2\n        ) {\n          light *= 1.2;\n        }\n        light = Math.floor(Math.min(Math.max(light, 0), 1) * 0xFF);\n        const i = (y * renderer.height + x) * 4;\n        pixels.data[i] = light;\n        pixels.data[i + 1] = light;\n        pixels.data[i + 2] = light;\n        pixels.data[i + 3] = 0xFF;\n      }\n    }\n    ctx.putImageData(pixels, 0, 0);\n    super(renderer);\n    this.magFilter = NearestFilter;\n    this.minFilter = NearestFilter;\n    this.wrapS = RepeatWrapping;\n    this.wrapT = RepeatWrapping;\n    this.needsUpdate = true;\n  }\n}\n\nexport default new Noise();\n","import Worker from '@/services/mesher.worker';\n\nclass Mesher {\n  constructor() {\n    this.promiseId = 0;\n    this.promises = {};\n    this.worker = new Worker();\n    this.worker.onmessage = this.onMessage.bind(this);\n  }\n\n  generate({ size, voxels }) {\n    const { promiseId, promises, worker } = this;\n    return new Promise((resolve) => {\n      promises[promiseId] = resolve;\n      this.promiseId += 1;\n      worker.postMessage({\n        promiseId,\n        size,\n        voxels,\n      });\n    });\n  }\n\n  onMessage({ data: { geometry, promiseId } }) {\n    const { promises } = this;\n    promises[promiseId](geometry);\n    delete promises[promiseId];\n  }\n}\n\nexport default new Mesher();\n","import * as types from './types';\nimport API from '@/services/api';\nimport Mesher from '@/services/mesher';\n\nexport function create() {\n  return {\n    type: types.REALM_CREATE,\n    payload: API.fetch({\n      endpoint: 'realm',\n      method: 'PUT',\n    }),\n  };\n}\n\nexport function generateGeometry({ size, voxels }) {\n  return {\n    type: types.REALM_UPDATE_GEOMETRY,\n    payload: Mesher.generate({ size, voxels }),\n  };\n}\n\nexport function fetch(slug) {\n  return dispatch => dispatch({\n    type: types.REALM_FETCH,\n    payload: API.fetch({\n      endpoint: `realm/${slug}`,\n    })\n      .then(realm => (\n        API.fetch({\n          endpoint: `realm/${realm._id}/voxels`,\n        })\n          .then((voxels) => {\n            voxels = new Uint32Array(voxels);\n            dispatch(generateGeometry({ size: realm.size, voxels }));\n            return {\n              ...realm,\n              voxels,\n            };\n          })\n      )),\n  });\n}\n\nexport function hideMetadataPopup() {\n  return {\n    type: types.REALM_HIDE_METADATA_POPUP,\n  };\n}\n\nexport function reset() {\n  return {\n    type: types.REALM_RESET,\n  };\n}\n\nexport function showMetadataPopup() {\n  return {\n    type: types.REALM_SHOW_METADATA_POPUP,\n  };\n}\n\nexport function updateFog(fog) {\n  return (dispatch, getState) => {\n    const {\n      realm: {\n        id,\n        isCreator,\n      },\n    } = getState();\n    if (isCreator) {\n      // Send update to server\n      API.fetch({\n        body: { fog },\n        endpoint: `realm/${id}/metadata`,\n        method: 'PUT',\n      });\n    }\n    return dispatch({\n      type: types.REALM_UPDATE_FOG,\n      payload: { fog },\n    });\n  };\n}\n\nexport function updateMetadata({ name }) {\n  return (dispatch, getState) => {\n    const { realm: { id } } = getState();\n    return dispatch({\n      type: types.REALM_UPDATE_METADATA,\n      payload: API.fetch({\n        body: { name },\n        endpoint: `realm/${id}/metadata`,\n        method: 'PUT',\n      }),\n    });\n  };\n}\n\nexport function updateVoxels({\n  color,\n  normal,\n  point,\n  remove,\n}) {\n  return (dispatch, getState) => {\n    const {\n      realm: {\n        id,\n        isCreator,\n        size,\n        voxels: current,\n      },\n    } = getState();\n    // Normalize & 3D wrap voxel position\n    const [x, y, z] = ['x', 'y', 'z'].map((axis) => {\n      let position = Math.floor(point[axis] + (normal[axis] * 0.5 * (remove ? -1 : 1)));\n      while (position < 0) position += size;\n      while (position >= size) position -= size;\n      return position;\n    });\n    // Randomize the color just a bit\n    const randomized = {\n      r: Math.min(Math.max(Math.round((color.r * 0xFF) + (Math.random() * 8) - 4), 0), 255),\n      g: Math.min(Math.max(Math.round((color.g * 0xFF) + (Math.random() * 8) - 4), 0), 255),\n      b: Math.min(Math.max(Math.round((color.b * 0xFF) + (Math.random() * 8) - 4), 0), 255),\n    };\n    const value = remove ? (\n      0x00\n    ) : (\n      (0x01 << 24) | (randomized.r << 16) | (randomized.g << 8) | randomized.b\n    );\n    // Update the voxels data\n    const voxels = new Uint32Array(current);\n    voxels[z * size * size + y * size + x] = value;\n    // Request a geometry generation\n    dispatch(generateGeometry({ size, voxels }));\n    if (isCreator) {\n      // Send update to server\n      const body = new FormData();\n      body.append('voxels', new Blob([voxels.buffer], { type: 'text/plain' }));\n      API.fetch({\n        body,\n        endpoint: `realm/${id}/voxels`,\n        method: 'PUT',\n      });\n    }\n    return dispatch({\n      type: types.REALM_UPDATE_VOXELS,\n      payload: { voxels },\n    });\n  };\n}\n","// LOBBY\nexport const LOBBY_FETCH_REALMS = 'LOBBY/FETCH_REALMS';\nexport const LOBBY_FETCH_REALMS_FULFILLED = 'LOBBY/FETCH_REALMS_FULFILLED';\nexport const LOBBY_SET_FILTER = 'LOBBY/SET_FILTER';\nexport const LOBBY_SET_PAGE = 'LOBBY/SET_PAGE';\n\n// REALM\nexport const REALM_CREATE = 'REALM/CREATE';\nexport const REALM_CREATE_FULFILLED = 'REALM/CREATE_FULFILLED';\nexport const REALM_FETCH = 'REALM/FETCH';\nexport const REALM_FETCH_FULFILLED = 'REALM/FETCH_FULFILLED';\nexport const REALM_HIDE_METADATA_POPUP = 'REALM/HIDE_METADATA_POPUP';\nexport const REALM_RESET = 'REALM/RESET';\nexport const REALM_SHOW_METADATA_POPUP = 'REALM/SHOW_METADATA_POPUP';\nexport const REALM_UPDATE_FOG = 'REALM/UPDATE_FOG';\nexport const REALM_UPDATE_GEOMETRY = 'REALM/UPDATE_GEOMETRY';\nexport const REALM_UPDATE_GEOMETRY_FULFILLED = 'REALM/UPDATE_GEOMETRY_FULFILLED';\nexport const REALM_UPDATE_METADATA = 'REALM/UPDATE_METADATA';\nexport const REALM_UPDATE_METADATA_FULFILLED = 'REALM/UPDATE_METADATA_FULFILLED';\nexport const REALM_UPDATE_VOXELS = 'REALM/UPDATE_VOXELS';\n\n// USER\nexport const USER_HIDE_SESSION_POPUP = 'USER/HIDE_SESSION_POPUP';\nexport const USER_REFRESH_SESSION = 'USER/REFRESH_SESSION';\nexport const USER_REFRESH_SESSION_FULFILLED = 'USER/REFRESH_SESSION_FULFILLED';\nexport const USER_REFRESH_SESSION_REJECTED = 'USER/REFRESH_SESSION_REJECTED';\nexport const USER_SHOW_SESSION_POPUP = 'USER/SHOW_SESSION_POPUP';\nexport const USER_LOGIN = 'USER/LOGIN';\nexport const USER_LOGIN_FULFILLED = 'USER/LOGIN_FULFILLED';\nexport const USER_LOGIN_REJECTED = 'USER/LOGIN_REJECTED';\nexport const USER_REGISTER = 'USER/REGISTER';\nexport const USER_REGISTER_FULFILLED = 'USER/REGISTER_FULFILLED';\nexport const USER_REGISTER_REJECTED = 'USER/REGISTER_REJECTED';\nexport const USER_SIGNOUT = 'USER/SIGNOUT';\n","class Fonts {\n  constructor() {\n    this.loaded = {};\n  }\n\n  waitUntilLoaded(fonts) {\n    const { loaded } = this;\n    if (!Array.isArray(fonts)) {\n      fonts = [fonts];\n    }\n    return Promise.all(\n      fonts\n        .map(font => (\n          new Promise((resolve) => {\n            if (loaded[font]) {\n              resolve();\n              return;\n            }\n            const check = () => {\n              if (document.fonts.check(`1rem ${font}`)) {\n                loaded[font] = true;\n                resolve();\n                return;\n              }\n              setTimeout(check, 10);\n            };\n            check();\n          })\n        ))\n    );\n  }\n}\n\nexport default new Fonts();\n","import {\n  CanvasTexture,\n  Mesh,\n  MeshBasicMaterial,\n  PlaneBufferGeometry,\n} from 'three';\nimport Fonts from '@/services/fonts';\n\nclass Title extends Mesh {\n  constructor({ anisotropy }) {\n    const renderer = document.createElement('canvas');\n    renderer.width = 1024;\n    renderer.height = 1024;\n    const texture = new CanvasTexture(renderer);\n    texture.anisotropy = anisotropy;\n    super(\n      new PlaneBufferGeometry(2, 2),\n      new MeshBasicMaterial({\n        map: texture,\n        transparent: true,\n      })\n    );\n    this.lookAt(0, -0.5, 1);\n    this.position.set(0, 2.5, -3);\n    this.renderer = renderer;\n    this.texture = texture;\n    Fonts\n      .waitUntilLoaded('Roboto')\n      .then(() => (\n        this.draw()\n      ));\n  }\n\n  dispose() {\n    const { geometry, material, texture } = this;\n    geometry.dispose();\n    material.dispose();\n    texture.dispose();\n  }\n\n  draw() {\n    const { renderer, texture } = this;\n    const ctx = renderer.getContext('2d');\n    const subdivision = 8;\n    const radius = subdivision * 0.5;\n    const color = { r: 0x33, g: 0x99, b: 0x33 };\n    for (let y = 0; y < renderer.height; y += subdivision) {\n      for (let x = 0; x < renderer.width; x += subdivision) {\n        const a = (1 - (y / (renderer.height - subdivision)) + 0.1) / 3;\n        const l = Math.random() * 0.6 + 0.3;\n        ctx.fillStyle = `rgba(${Math.floor(color.r * l)}, ${Math.floor(color.g * l)}, ${Math.floor(color.b * l)}, ${a})`;\n        ctx.beginPath();\n        ctx.arc(x + radius, y + radius, radius * 0.75, 0, Math.PI * 2);\n        ctx.fill();\n      }\n    }\n    ctx.font = '700 200px Roboto';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';\n    ctx.fillText(\n      'REALMS',\n      renderer.width * 0.5,\n      renderer.height * 0.21\n    );\n    ctx.font = '70px Roboto';\n    ctx.fillStyle = '#999';\n    ctx.fillText(\n      'A recursive VR experience',\n      renderer.width * 0.5,\n      renderer.height * 0.5\n    );\n    ctx.font = '50px Roboto';\n    ctx.fillStyle = '#696';\n    ctx.fillText(\n      `v${__VERSION__} - dani@gatunes  2019`,\n      renderer.width * 0.5,\n      renderer.height * 0.815\n    );\n    texture.needsUpdate = true;\n  }\n}\n\nexport default Title;\n"],"sourceRoot":""}